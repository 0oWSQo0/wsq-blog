import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,o as a,f as n}from"./app-Bi5VLzj8.js";const l="/my-blog/assets/network-BT9gcZQP.png",e="/my-blog/assets/docker-y-4-GeBhUQtH.png",h="/my-blog/assets/1-Di7NoTpr.png",t="/my-blog/assets/2-DQOnMQ8m.png",k="/my-blog/assets/3-IjmEi3gj.png",p="/my-blog/assets/docker-y-6-BYziYhtp.png",d={},r=n('<h2 id="使用网络" tabindex="-1"><a class="header-anchor" href="#使用网络"><span>使用网络</span></a></h2><p>Docker 允许通过外部访问容器或容器互联的方式来提供网络服务。</p><h3 id="外部访问容器" tabindex="-1"><a class="header-anchor" href="#外部访问容器"><span>外部访问容器</span></a></h3><p>容器中可以运行一些网络应用，要让外部也可以访问这些应用，可以通过<code>-P</code>或<code>-p</code>参数来指定端口映射。</p><ul><li>当使用<code>-P</code>标记时，Docker 会随机映射一个端口到内部容器开放的网络端口。</li><li><code>-p</code>则可以指定要映射的端口，并且，在一个指定端口上只可以绑定一个容器。支持的格式有<code>ip:hostPort:containerPort | ip::containerPort | hostPort:containerPort</code>。</li></ul><p><strong>映射所有接口地址</strong></p><p>本地的 80 端口映射到容器的 80 端口，可以执行</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#e1e4e8;--shiki-dark:#24292e;--shiki-light-bg:#24292e;--shiki-dark-bg:#fff;"><pre class="shiki shiki-themes github-dark github-light vp-code"><code><span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">docker</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> run</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> -d</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> -p</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 80:80</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> nginx:alpine</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>映射到指定地址的指定端口</strong></p><p>可以使用<code>ip:hostPort:containerPort</code>格式指定映射使用一个特定地址，比如<code>localhost</code>地址<code>127.0.0.1</code></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#e1e4e8;--shiki-dark:#24292e;--shiki-light-bg:#24292e;--shiki-dark-bg:#fff;"><pre class="shiki shiki-themes github-dark github-light vp-code"><code><span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">docker</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> run</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> -d</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> -p</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 127.0.0.1:80:80</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> nginx:alpine</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>映射到指定地址的任意端口</strong></p><p>使用<code>ip::containerPort</code>绑定<code>localhost</code>的任意端口到容器的 80 端口，本地主机会自动分配一个端口。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#e1e4e8;--shiki-dark:#24292e;--shiki-light-bg:#24292e;--shiki-dark-bg:#fff;"><pre class="shiki shiki-themes github-dark github-light vp-code"><code><span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">docker</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> run</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> -d</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> -p</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 127.0.0.1::80</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> nginx:alpine</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>还可以使用<code>udp</code>标记来指定<code>udp</code>端口</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#e1e4e8;--shiki-dark:#24292e;--shiki-light-bg:#24292e;--shiki-dark-bg:#fff;"><pre class="shiki shiki-themes github-dark github-light vp-code"><code><span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">docker</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> run</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> -d</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> -p</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 127.0.0.1:80:80/udp</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> nginx:alpine</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong><code>-p</code>标记可以多次使用来绑定多个端口</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#e1e4e8;--shiki-dark:#24292e;--shiki-light-bg:#24292e;--shiki-dark-bg:#fff;"><pre class="shiki shiki-themes github-dark github-light vp-code"><code><span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">docker</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> run</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> -d</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> -p</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 80:80</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">  -p</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 443:443</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> nginx:alpine</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="docker网络原理" tabindex="-1"><a class="header-anchor" href="#docker网络原理"><span>Docker网络原理</span></a></h2><p>当 Docker 启动时，会自动在主机上创建一个<code>docker0</code>虚拟网桥，实际上是 Linux 的一个<code>bridge</code>，可以理解为一个虚拟交换机。它会在挂载到它的网口之间进行转发。</p><p>同时，Docker 随机分配一个本地未占用的私有网段中的一个地址给<code>docker0</code>接口。比如<code>172.17.0.1</code>，掩码为<code>255.255.0.0</code>。此后启动的容器内的网口也会自动分配一个同一网段（<code>172.17.0.0/16</code>）的地址。</p><p>当创建一个 Docker 容器的时候，同时会创建了一对<code>veth pair</code>接口（当数据包发送到一个接口时，另外一个接口也可以收到相同的数据包）。这对接口一端在容器内，即<code>eth0</code>；另一端在本地并被挂载到<code>docker0</code>网桥，名称以<code>veth</code>开头（例如<code>vethAQI2QT</code>）。通过这种方式，主机可以跟容器通信，容器之间也可以相互通信。Docker 就创建了在主机和所有容器之间一个虚拟共享网络。</p><figure><img src="'+l+`" alt="Docker 网络原理" tabindex="0" loading="lazy"><figcaption>Docker 网络原理</figcaption></figure><h3 id="理解-docker-默认网桥" tabindex="-1"><a class="header-anchor" href="#理解-docker-默认网桥"><span>理解 Docker 默认网桥</span></a></h3><p>在安装 Docker 服务后默认会创建一个<code>docker0</code>网桥（其上有一个<code>docker0</code>内部接口），它在内核层连通了其他的物理或虚拟网卡，这就将所有容器和本地主机都放到同一个物理网络。</p><p>我们可用<code>docker network ls</code>命令查看：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#e1e4e8;--shiki-dark:#24292e;--shiki-light-bg:#24292e;--shiki-dark-bg:#fff;"><pre class="shiki shiki-themes github-dark github-light vp-code"><code><span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# docker network ls</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">NETWORK</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ID</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">     NAME</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">      DRIVER</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">    SCOPE</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">1b5de2e1b9cd</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">   bridge</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">    bridge</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">    local</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">04840f8a5cc6</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">   host</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">      host</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">      local</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">15db1739ccef</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">   none</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">      null</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">      local</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Docker 安装时会自动在<code>host</code>上创建三个网络：<code>none、host</code>和<code>bridge</code>。我们看下<code>docker0</code>网桥：(<code>brctl</code>可以通过<code>yum install bridge-utils</code>安装)</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#e1e4e8;--shiki-dark:#24292e;--shiki-light-bg:#24292e;--shiki-dark-bg:#fff;"><pre class="shiki shiki-themes github-dark github-light vp-code"><code><span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# brctl show</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">bridge</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> name</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">     bridge</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> id</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">               STP</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> enabled</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">     interfaces</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">docker0</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">         8000.024236f275b4</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">       no</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# ip a</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">1:</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> lo:</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;"> &lt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">LOOPBACK,UP,LOWER_U</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">P</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">&gt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> mtu</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 65536</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> qdisc</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> noqueue</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> state</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> UNKNOWN</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> group</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> default</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> qlen</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    link/loopback</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 00:00:00:00:00:00</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> brd</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    inet</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 127.0.0.1/8</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> host</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> lo</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">       valid_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> preferred_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    inet6</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ::1/128</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> host</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;"> </span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">       valid_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> preferred_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">2:</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> eth0:</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;"> &lt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">P</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">&gt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> mtu</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 1500</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> qdisc</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> mq</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> state</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> UP</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> group</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> default</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> qlen</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    link/ether</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 52:54:00:d3:d4:65</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> brd</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    inet</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 10.2.20.4/22</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> brd</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 10.2.23.255</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> global</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> eth0</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">       valid_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> preferred_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    inet6</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> fe80::5054:ff:fed3:d465/64</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> link</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;"> </span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">       valid_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> preferred_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">3:</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> docker0:</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;"> &lt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">NO-CARRIER,BROADCAST,MULTICAST,U</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">P</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">&gt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> mtu</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 1500</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> qdisc</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> noqueue</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> state</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> DOWN</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> group</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> default</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;"> </span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    link/ether</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 02:42:36:f2:75:b4</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> brd</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    inet</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 172.17.0.1/16</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> brd</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 172.17.255.255</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> global</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> docker0</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">       valid_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> preferred_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    inet6</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> fe80::42:36ff:fef2:75b4/64</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> link</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;"> </span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">       valid_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> preferred_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# ip route</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">default</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> via</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 10.2.20.1</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> dev</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> eth0</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;"> </span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">10.2.20.0/22</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> dev</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> eth0</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> proto</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> kernel</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> link</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> src</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 10.2.20.4</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;"> </span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">169.254.0.0/16</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> dev</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> eth0</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> link</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> metric</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 1002</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;"> </span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">172.17.0.0/16</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> dev</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> docker0</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> proto</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> kernel</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> link</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> src</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 172.17.0.1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>再用<code>docker network inspect</code>指令查看<code>bridge</code>网络：其<code>Gateway</code>就是网卡/接口<code>docker0</code>的 IP 地址：<code>172.17.0.1</code>。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#e1e4e8;--shiki-dark:#24292e;--shiki-light-bg:#24292e;--shiki-dark-bg:#fff;"><pre class="shiki shiki-themes github-dark github-light vp-code"><code><span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# docker network inspect bridge</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">    {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Name&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;bridge&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Id&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;1b5de2e1b9cde4609f7272df118ea890d827e3fee5cbfc7a299defb0623cb434&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Created&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;2024-08-01T10:35:07.355894408+08:00&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Scope&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;local&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Driver&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;bridge&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;EnableIPv6&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">false</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;IPAM&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;Driver&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;default&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;Options&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: null,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;Config&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: [</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">                {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">                    &quot;Subnet&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;172.17.0.0/16&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">                    &quot;Gateway&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;172.17.0.1&quot;</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">                }</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">            ]</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">        },</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Internal&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">false</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Attachable&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">false</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Ingress&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">false</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;ConfigFrom&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;Network&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">        },</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;ConfigOnly&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">false</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Containers&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: {},</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Options&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.bridge.default_bridge&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;true&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.bridge.enable_icc&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;true&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.bridge.enable_ip_masquerade&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;true&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.bridge.host_binding_ipv4&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;0.0.0.0&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.bridge.name&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;docker0&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.driver.mtu&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;1500&quot;</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">        },</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Labels&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: {}</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">    }</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>从上面你可以看到<code>bridge</code>的配置信息和容器信息。</p><h3 id="理解容器创建时的ip分配" tabindex="-1"><a class="header-anchor" href="#理解容器创建时的ip分配"><span>理解容器创建时的IP分配</span></a></h3><p>为了理解容器创建时的 IP 分配，这里需要清理所有已经启动的环境，然后再启动容器，看前后对比我们清理所有容器实例，下面展示的就是 docker 安装之后的, 注意和上面的对比下：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#e1e4e8;--shiki-dark:#24292e;--shiki-light-bg:#24292e;--shiki-dark-bg:#fff;"><pre class="shiki shiki-themes github-dark github-light vp-code"><code><span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# docker ps -a</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">CONTAINER</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ID</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">   IMAGE</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">     COMMAND</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">   CREATED</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">   STATUS</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">    PORTS</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">     NAMES</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# docker network ls</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">NETWORK</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ID</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">     NAME</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">      DRIVER</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">    SCOPE</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">1b5de2e1b9cd</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">   bridge</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">    bridge</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">    local</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">04840f8a5cc6</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">   host</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">      host</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">      local</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">15db1739ccef</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">   none</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">      null</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">      local</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# docker network inspect bridge</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">    {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Name&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;bridge&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Id&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;1b5de2e1b9cde4609f7272df118ea890d827e3fee5cbfc7a299defb0623cb434&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Created&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;2024-08-01T10:35:07.355894408+08:00&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Scope&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;local&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Driver&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;bridge&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;EnableIPv6&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">false</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;IPAM&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;Driver&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;default&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;Options&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: null,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;Config&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: [</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">                {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">                    &quot;Subnet&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;172.17.0.0/16&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">                    &quot;Gateway&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;172.17.0.1&quot;</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">                }</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">            ]</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">        },</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Internal&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">false</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Attachable&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">false</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Ingress&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">false</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;ConfigFrom&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;Network&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">        },</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;ConfigOnly&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">false</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Containers&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: {},</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Options&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.bridge.default_bridge&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;true&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.bridge.enable_icc&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;true&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.bridge.enable_ip_masquerade&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;true&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.bridge.host_binding_ipv4&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;0.0.0.0&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.bridge.name&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;docker0&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.driver.mtu&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;1500&quot;</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">        },</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Labels&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: {}</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">    }</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# ip a</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">1:</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> lo:</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;"> &lt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">LOOPBACK,UP,LOWER_U</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">P</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">&gt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> mtu</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 65536</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> qdisc</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> noqueue</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> state</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> UNKNOWN</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> group</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> default</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> qlen</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    link/loopback</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 00:00:00:00:00:00</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> brd</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    inet</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 127.0.0.1/8</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> host</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> lo</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">       valid_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> preferred_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    inet6</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ::1/128</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> host</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;"> </span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">       valid_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> preferred_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">2:</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> eth0:</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;"> &lt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">P</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">&gt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> mtu</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 1500</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> qdisc</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> mq</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> state</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> UP</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> group</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> default</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> qlen</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    link/ether</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 52:54:00:d3:d4:65</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> brd</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    inet</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 10.2.20.4/22</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> brd</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 10.2.23.255</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> global</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> eth0</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">       valid_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> preferred_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    inet6</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> fe80::5054:ff:fed3:d465/64</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> link</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;"> </span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">       valid_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> preferred_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">3:</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> docker0:</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;"> &lt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">NO-CARRIER,BROADCAST,MULTICAST,U</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">P</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">&gt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> mtu</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 1500</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> qdisc</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> noqueue</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> state</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> DOWN</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> group</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> default</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;"> </span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    link/ether</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 02:42:36:f2:75:b4</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> brd</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    inet</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 172.17.0.1/16</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> brd</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 172.17.255.255</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> global</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> docker0</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">       valid_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> preferred_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    inet6</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> fe80::42:36ff:fef2:75b4/64</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> link</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;"> </span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">       valid_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> preferred_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# brctl show</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">bridge</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> name</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">     bridge</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> id</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">               STP</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> enabled</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">     interfaces</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">docker0</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">         8000.024236f275b4</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">       no</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Docker 在创建一个容器的时候，会执行如下操作：</p><ul><li>创建一对虚拟接口/网卡，也就是<code>veth pair</code>，分别放到本地主机和新容器中；</li><li>本地主机一端桥接到默认的<code>docker0</code>或指定网桥上，并具有一个唯一的名字，如<code>vethxxxxx</code>；</li><li>容器一端放到新容器中，并修改名字作为<code>eth0</code>，这个网卡/接口只在容器的名字空间可见；</li><li>从网桥可用地址段中（也就是与该<code>bridge</code>对应的<code>network</code>）获取一个空闲地址分配给容器的<code>eth0</code>，并配置默认路由到桥接网卡<code>vethxxxx</code>。</li></ul><p>让我们启动一个容器，看下变化：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#e1e4e8;--shiki-dark:#24292e;--shiki-light-bg:#24292e;--shiki-dark-bg:#fff;"><pre class="shiki shiki-themes github-dark github-light vp-code"><code><span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# docker run -d --name nginx nginx</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">4c5ea34f51285140bf6bd4f270f693ef2cdbd679506f53120193df66dbde1fbb</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# brctl show</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">bridge</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> name</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">     bridge</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> id</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">               STP</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> enabled</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">     interfaces</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">docker0</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">         8000.024236f275b4</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">       no</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">              vethd9746c7</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# ip a </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">|</span><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;"> grep</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> vethd9746c7</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">27:</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> vethd9746c7@if26:</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;"> &lt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">P</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">&gt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> mtu</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 1500</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> qdisc</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> noqueue</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> master</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> docker0</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> state</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> UP</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> group</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> default</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# docker network inspect bridge</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">    {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Name&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;bridge&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Id&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;1b5de2e1b9cde4609f7272df118ea890d827e3fee5cbfc7a299defb0623cb434&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Created&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;2024-08-01T10:35:07.355894408+08:00&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Scope&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;local&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Driver&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;bridge&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;EnableIPv6&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">false</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;IPAM&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;Driver&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;default&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;Options&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: null,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;Config&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: [</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">                {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">                    &quot;Subnet&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;172.17.0.0/16&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">                    &quot;Gateway&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;172.17.0.1&quot;</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">                }</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">            ]</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">        },</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Internal&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">false</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Attachable&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">false</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Ingress&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">false</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;ConfigFrom&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;Network&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">        },</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;ConfigOnly&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">false</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Containers&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;4c5ea34f51285140bf6bd4f270f693ef2cdbd679506f53120193df66dbde1fbb&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">                &quot;Name&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;nginx&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">                &quot;EndpointID&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;a4ee4c931d0702872a0a90279de3e2d12e159b35b9e3004d68e255168e84819f&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">                &quot;MacAddress&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;02:42:ac:11:00:02&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">                &quot;IPv4Address&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;172.17.0.2/16&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">                &quot;IPv6Address&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">            }</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">        },</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Options&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: {</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.bridge.default_bridge&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;true&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.bridge.enable_icc&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;true&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.bridge.enable_ip_masquerade&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;true&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.bridge.host_binding_ipv4&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;0.0.0.0&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.bridge.name&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;docker0&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">            &quot;com.docker.network.driver.mtu&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: </span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">&quot;1500&quot;</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">        },</span></span>
<span class="line"><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        &quot;Labels&quot;</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">: {}</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">    }</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果不指定<code>--network</code>，创建的容器默认都会挂到<code>docker0</code>上，使用本地主机上<code>docker0</code>接口的 IP 作为所有容器的默认网关当有多个容器创建后，容器网络拓扑结构如下：</p><figure><img src="`+e+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="理解容器和docker0的虚拟网卡的配对" tabindex="-1"><a class="header-anchor" href="#理解容器和docker0的虚拟网卡的配对"><span>理解容器和docker0的虚拟网卡的配对</span></a></h3><p>在上图中容器中<code>eth0</code>是怎么和<code>host</code>中虚拟网卡配对上的呢？</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#e1e4e8;--shiki-dark:#24292e;--shiki-light-bg:#24292e;--shiki-dark-bg:#fff;"><pre class="shiki shiki-themes github-dark github-light vp-code"><code><span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# docker ps -a</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">CONTAINER</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ID</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">   IMAGE</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">     COMMAND</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">                  CREATED</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">         STATUS</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">         PORTS</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">     NAMES</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">4c5ea34f5128</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">   nginx</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">     &quot;/docker-entrypoint.…&quot;</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">   7</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> minutes</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ago</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">   Up</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 7</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> minutes</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">   80/tcp</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">    nginx</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# docker exec -it 4c5ea34f5128 /bin/bash</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# apt-get update &amp;&amp; </span><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">apt-get</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> install</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> -y</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> iproute2</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">root@4c5ea34f5128:/#</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ip</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> a</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">1:</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> lo:</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;"> &lt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">LOOPBACK,UP,LOWER_U</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">P</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">&gt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> mtu</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 65536</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> qdisc</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> noqueue</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> state</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> UNKNOWN</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> group</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> default</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> qlen</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    link/loopback</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 00:00:00:00:00:00</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> brd</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 00:00:00:00:00:00</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    inet</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 127.0.0.1/8</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> host</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> lo</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">       valid_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> preferred_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    inet6</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ::1/128</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> host</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;"> </span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">       valid_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> preferred_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">26:</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> eth0@if27:</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;"> &lt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">P</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">&gt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> mtu</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 1500</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> qdisc</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> noqueue</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> state</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> UP</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> group</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> default</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;"> </span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    link/ether</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 02:42:ac:11:00:02</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> brd</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ff:ff:ff:ff:ff:ff</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> link-netnsid</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 0</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">    inet</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 172.17.0.2/16</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> brd</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 172.17.255.255</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> scope</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> global</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> eth0</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">       valid_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> preferred_lft</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> forever</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们可以看到<code>host</code>上<code>27: vethd9746c7@if26</code>对应着容器中<code>26: eth0@if27</code>；即<code>host</code>中<code>index=27</code>的接口/网卡<code>vethd9746c7</code>的<code>peer inferface index</code>是 26，<code>container</code>中<code>index=26</code>的网卡<code>eth0</code>的<code>peer interface index</code>是 27。可以利用<code>ethtool</code>来确认这种对应关系：分别在<code>host</code>和<code>container</code>中运行指令<code>ethtool -S &lt;interface&gt;</code>：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#e1e4e8;--shiki-dark:#24292e;--shiki-light-bg:#24292e;--shiki-dark-bg:#fff;"><pre class="shiki shiki-themes github-dark github-light vp-code"><code><span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# ethtool -S vethd9746c7</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">NIC</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> statistics:</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">     peer_ifindex:</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 27</span></span>
<span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# docker exec -it 4c5ea34f5128 /bin/bash</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">root@4c5ea34f5128:/#</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ip</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> a</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;"> |</span><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;"> grep</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 26</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">26:</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> eth0@if27:</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;"> &lt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">BROADCAST,MULTICAST,UP,LOWER_U</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">P</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">&gt;</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> mtu</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 1500</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> qdisc</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> noqueue</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> state</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> UP</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> group</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> default</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;"> </span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">root@4c5ea34f5128:/#</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="四类网络模式" tabindex="-1"><a class="header-anchor" href="#四类网络模式"><span>四类网络模式</span></a></h2><p>安装 Docker 时，它会自动创建三个网络，<code>bridge</code>（创建容器默认连接到此网络）、<code>none</code>、<code>host</code>。</p><table><thead><tr><th style="text-align:center;">网络模式</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:center;">Host</td><td style="text-align:left;">容器将不会虚拟出自己的网卡，配置自己的 IP 等，而是使用宿主机的 IP 和端口。</td></tr><tr><td style="text-align:center;">Bridge</td><td style="text-align:left;">此模式会为每一个容器分配、设置 IP 等，并将容器连接到一个 docker0 虚拟网桥，通过 docker0 网桥以及 Iptables nat 表配置与宿主机通信。</td></tr><tr><td style="text-align:center;">None</td><td style="text-align:left;">该模式关闭了容器的网络功能。</td></tr><tr><td style="text-align:center;">Container</td><td style="text-align:left;">创建的容器不会创建自己的网卡，配置自己的 IP，而是和一个指定的容器共享 IP、端口范围。</td></tr></tbody></table><p>我们在使用<code>docker run</code>创建 Docker 容器时，可以用<code>--net</code>选项指定容器的网络模式，Docker 可以有以下 4 种网络模式：</p><ul><li><code>host</code>模式：使用<code>--net=host</code>指定</li><li><code>none</code>模式：使用<code>--net=none</code>指定</li><li><code>bridge</code>模式：使用<code>--net=bridge</code>指定，默认设置。</li><li><code>container</code>模式：使用<code>--net=container:NAME_or_ID</code>指定。</li></ul><h3 id="host模式" tabindex="-1"><a class="header-anchor" href="#host模式"><span>host模式</span></a></h3><p>相当于 Vmware 中的桥接模式，与宿主机在同一个网络中，但没有独立 IP 地址。</p><p>Docker 使用了 Linux 的<code>Namespaces</code>技术来进行资源隔离，如<code>PID Namespace</code>隔离进程，<code>Mount Namespace</code>隔离文件系统，<code>Network Namespace</code>隔离网络等。</p><p>一个<code>Network Namespace</code>提供了一份独立的网络环境，包括网卡、路由、<code>Iptable</code>规则等都与其他的<code>Network Namespace</code>隔离。一个 Docker 容器一般会分配一个独立的<code>Network Namespace</code>。但如果启动容器的时候使用<code>host</code>模式，那么这个容器将不会获得一个独立的<code>Network Namespace</code>，而是和宿主机共用一个<code>Network Namespace</code>。容器将不会虚拟出自己的网卡，配置自己的 IP 等，而是使用宿主机的 IP 和端口。</p><p>使用<code>host</code>模式的容器可以直接使用宿主机的 IP 地址与外界通信，容器内部的服务端口也可以使用宿主机的端口，不需要进行 NAT，<code>host</code>最大的优势就是网络性能比较好，但是<code>docker host</code>上已经使用的端口就不能再用了，网络的隔离性不好。</p><p>例如，我们在<code>172.25.6.1/24</code>的机器上用<code>host</code>模式启动一个<code>ubuntu</code>容器</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#e1e4e8;--shiki-dark:#24292e;--shiki-light-bg:#24292e;--shiki-dark-bg:#fff;"><pre class="shiki shiki-themes github-dark github-light vp-code"><code><span class="line"><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">[root@localhost </span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">~</span><span style="--shiki-light:#E1E4E8;--shiki-dark:#24292E;">]# docker run -it --network</span><span style="--shiki-light:#F97583;--shiki-dark:#D73A49;">=</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">host</span><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;"> ubuntu</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><code>Host</code>模式如下图所示：</p><figure><img src="`+h+'" alt="Host 模式" tabindex="0" loading="lazy"><figcaption>Host 模式</figcaption></figure><h3 id="container模式" tabindex="-1"><a class="header-anchor" href="#container模式"><span>container模式</span></a></h3><p>这个模式指定新创建的容器和已经存在的一个容器共享一个<code>Network Namespace</code>，而不是和宿主机共享。新创建的容器不会创建自己的网卡，配置自己的 IP，而是和一个指定的容器共享 IP、端口范围等。同样，两个容器除了网络方面，其他的如文件系统、进程列表等还是隔离的。两个容器的进程可以通过<code>lo</code>网卡设备通信。</p><p><code>Container</code>模式示意图：</p><figure><img src="'+t+'" alt="Host 模式" tabindex="0" loading="lazy"><figcaption>Host 模式</figcaption></figure><h3 id="none模式" tabindex="-1"><a class="header-anchor" href="#none模式"><span>none模式</span></a></h3><p>该模式将容器放置在它自己的网络栈中，但是并不进行任何配置。实际上，该模式关闭了容器的网络功能在以下两种情况下是有用的：</p><ul><li>容器并不需要网络（例如只需要写磁盘卷的批处理任务）。</li><li><code>overlay</code>：在 docker1.8 新加入的一个<code>overlay</code>网络模式。Docker 对于网络访问的控制也是在逐渐完善的。</li></ul><p><code>None</code>模式示意图:</p><figure><img src="'+k+'" alt="Host 模式" tabindex="0" loading="lazy"><figcaption>Host 模式</figcaption></figure><h3 id="bridge模式" tabindex="-1"><a class="header-anchor" href="#bridge模式"><span>bridge模式</span></a></h3><p>相当于 Vmware 中的 NAT 模式，容器使用独立<code>network Namespace</code>，并连接到<code>docker0</code>虚拟网卡（默认模式）。通过<code>docker0</code>网桥以及<code>Iptables nat</code>表配置与宿主机通信；<code>bridge</code>模式是 Docker 默认的网络设置，此模式会为每一个容器分配<code>Network Namespace</code>、设置 IP 等，并将一个主机上的 Docker 容器连接到一个虚拟网桥上。</p><p>当 Docker 进程启动时，会在主机上创建一个名为<code>docker0</code>的虚拟网桥，此主机上启动的 Docker 容器会连接到这个虚拟网桥上。虚拟网桥的工作方式和物理交换机类似，这样主机上的所有容器就通过交换机连在了一个二层网络中。</p><p>从<code>docker0</code>子网中分配一个 IP 给容器使用，并设置<code>docker0</code>的 IP 地址为容器的默认网关。在主机上创建一对虚拟网卡<code>veth pair</code>设备，Docker 将<code>veth pair</code>设备的一端放在新创建的容器中，并命名为<code>eth0</code>（容器的网卡），另一端放在主机中，以<code>vethxxx</code>这样类似的名字命名，并将这个网络设备加入到<code>docker0</code>网桥中。可以通过<code>brctl show</code>命令查看。</p><p><code>bridge</code>模式是 Docker 的默认网络模式，不写<code>--net</code>参数，就是<code>bridge</code>模式。使用<code>docker run -p</code>时，Docker 实际是在<code>iptables</code>做了 DNAT 规则，实现端口转发功能。可以使用<code>iptables -t nat -vnL</code>查看。</p><p><code>bridge</code>模式如下图所示：</p><p><a href="Docker%E7%9A%84%E7%BD%91%E7%BB%9C/4.png">Host 模式</a></p><h2 id="多物理机之间互联" tabindex="-1"><a class="header-anchor" href="#多物理机之间互联"><span>多物理机之间互联</span></a></h2><p>如果在企业内部应用，或者做多个物理主机的集群，可能需要将多个物理主机的容器组到一个物理网络中来，那么就需要将这个网桥桥接到我们指定的网卡上。</p><h3 id="拓扑图" tabindex="-1"><a class="header-anchor" href="#拓扑图"><span>拓扑图</span></a></h3><p>主机 A 和主机 B 的网卡一都连着物理交换机的同一个<code>vlan 101</code>，这样网桥一和网桥三就相当于在同一个物理网络中了，而容器一、容器三、容器四也在同一物理网络中了，他们之间可以相互通信，而且可以跟同一<code>vlan</code>中的其他物理机器互联。</p><figure><img src="'+p+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="ubuntu-示例" tabindex="-1"><a class="header-anchor" href="#ubuntu-示例"><span>ubuntu 示例</span></a></h3><p>下面以 ubuntu 为例创建多个主机的容器联网: 创建自己的网桥，编辑<code>/etc/network/interface</code>文件</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#e1e4e8;--shiki-dark:#24292e;--shiki-light-bg:#24292e;--shiki-dark-bg:#fff;"><pre class="shiki shiki-themes github-dark github-light vp-code"><code><span class="line"><span>auto br0</span></span>
<span class="line"><span>iface br0 inet static</span></span>
<span class="line"><span>address 192.168.7.31</span></span>
<span class="line"><span>netmask 255.255.240.0</span></span>
<span class="line"><span>gateway 192.168.7.254</span></span>
<span class="line"><span>bridge_ports em1</span></span>
<span class="line"><span>bridge_stp off</span></span>
<span class="line"><span>dns-nameservers 8.8.8.8 192.168.6.1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>将 Docker 的默认网桥绑定到这个新建的<code>br0</code>上面，这样就将这台机器上容器绑定到<code>em1</code>这个网卡所对应的物理网络上了。ubuntu 修改<code>/etc/default/docker</code>文件，添加最后一行内容</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#e1e4e8;--shiki-dark:#24292e;--shiki-light-bg:#24292e;--shiki-dark-bg:#fff;"><pre class="shiki shiki-themes github-dark github-light vp-code"><code><span class="line"><span># Docker Upstart and SysVinit configuration file</span></span>
<span class="line"><span># Customize location of Docker binary (especially for development testing).</span></span>
<span class="line"><span>#DOCKER=&quot;/usr/local/bin/docker&quot;</span></span>
<span class="line"><span># Use DOCKER_OPTS to modify the daemon startup options.</span></span>
<span class="line"><span>#DOCKER_OPTS=&quot;--dns 8.8.8.8 --dns 8.8.4.4&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># If you need Docker to use an HTTP proxy, it can also be specified here.</span></span>
<span class="line"><span>#export http_proxy=&quot;http://127.0.0.1:3128/&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span># This is also a handy place to tweak where Docker&#39;s temporary files go.</span></span>
<span class="line"><span>#export TMPDIR=&quot;/mnt/bigdrive/docker-tmp&quot;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>DOCKER_OPTS=&quot;-b=br0&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在启动 Docker 的时候 使用<code>-b</code>参数将容器绑定到物理网络上。重启 Docker 服务后，再进入容器可以看到它已经绑定到你的物理网络上了。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#e1e4e8;--shiki-dark:#24292e;--shiki-light-bg:#24292e;--shiki-dark-bg:#fff;"><pre class="shiki shiki-themes github-dark github-light vp-code"><code><span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">root@localhost:~#</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> docker</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ps</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">CONTAINER</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ID</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        IMAGE</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">               COMMAND</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">             CREATED</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">             STATUS</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">              PORTS</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">                        NAMES</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">58b043aa05eb</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        desk_hz:v1</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">          &quot;/startup.sh&quot;</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;">       5</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> days</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> ago</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">          Up</span><span style="--shiki-light:#79B8FF;--shiki-dark:#005CC5;"> 2</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> seconds</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">        5900/tcp,</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 6080/tcp,</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> 22/tcp</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">   yanlx</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">root@localhost:~#</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> brctl</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> show</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">bridge</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> name</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">     bridge</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> id</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">               STP</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;"> enabled</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">     interfaces</span></span>
<span class="line"><span style="--shiki-light:#B392F0;--shiki-dark:#6F42C1;">br0</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">             8000.7e6e617c8d53</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">       no</span><span style="--shiki-light:#9ECBFF;--shiki-dark:#032F62;">              em1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这样就直接把容器暴露到物理网络上了，多台物理主机的容器也可以相互联网了。需要注意的是，这样就需要自己来保证容器的网络安全了。</p>`,89),F=[r];function E(c,g){return a(),i("div",null,F)}const u=s(d,[["render",E],["__file","Docker的网络.html.vue"]]),C=JSON.parse('{"path":"/linux/docker/Docker%E7%9A%84%E7%BD%91%E7%BB%9C.html","title":"Docker的网络","lang":"zh-CN","frontmatter":{"title":"Docker的网络","date":"2024-01-10T00:00:00.000Z","tags":["Docker"],"categories":"linux","order":2,"description":"使用网络 Docker 允许通过外部访问容器或容器互联的方式来提供网络服务。 外部访问容器 容器中可以运行一些网络应用，要让外部也可以访问这些应用，可以通过-P或-p参数来指定端口映射。 当使用-P标记时，Docker 会随机映射一个端口到内部容器开放的网络端口。 -p则可以指定要映射的端口，并且，在一个指定端口上只可以绑定一个容器。支持的格式有ip:...","head":[["meta",{"property":"og:url","content":"https://wsq01.github.io/my-blog/linux/docker/Docker%E7%9A%84%E7%BD%91%E7%BB%9C.html"}],["meta",{"property":"og:title","content":"Docker的网络"}],["meta",{"property":"og:description","content":"使用网络 Docker 允许通过外部访问容器或容器互联的方式来提供网络服务。 外部访问容器 容器中可以运行一些网络应用，要让外部也可以访问这些应用，可以通过-P或-p参数来指定端口映射。 当使用-P标记时，Docker 会随机映射一个端口到内部容器开放的网络端口。 -p则可以指定要映射的端口，并且，在一个指定端口上只可以绑定一个容器。支持的格式有ip:..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-08-14T07:08:17.000Z"}],["meta",{"property":"article:author","content":"WSQ"}],["meta",{"property":"article:tag","content":"Docker"}],["meta",{"property":"article:published_time","content":"2024-01-10T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-08-14T07:08:17.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Docker的网络\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-01-10T00:00:00.000Z\\",\\"dateModified\\":\\"2024-08-14T07:08:17.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"WSQ\\",\\"url\\":\\"https://wsq01.github.com\\"}]}"]]},"headers":[{"level":2,"title":"使用网络","slug":"使用网络","link":"#使用网络","children":[{"level":3,"title":"外部访问容器","slug":"外部访问容器","link":"#外部访问容器","children":[]}]},{"level":2,"title":"Docker网络原理","slug":"docker网络原理","link":"#docker网络原理","children":[{"level":3,"title":"理解 Docker 默认网桥","slug":"理解-docker-默认网桥","link":"#理解-docker-默认网桥","children":[]},{"level":3,"title":"理解容器创建时的IP分配","slug":"理解容器创建时的ip分配","link":"#理解容器创建时的ip分配","children":[]},{"level":3,"title":"理解容器和docker0的虚拟网卡的配对","slug":"理解容器和docker0的虚拟网卡的配对","link":"#理解容器和docker0的虚拟网卡的配对","children":[]}]},{"level":2,"title":"四类网络模式","slug":"四类网络模式","link":"#四类网络模式","children":[{"level":3,"title":"host模式","slug":"host模式","link":"#host模式","children":[]},{"level":3,"title":"container模式","slug":"container模式","link":"#container模式","children":[]},{"level":3,"title":"none模式","slug":"none模式","link":"#none模式","children":[]},{"level":3,"title":"bridge模式","slug":"bridge模式","link":"#bridge模式","children":[]}]},{"level":2,"title":"多物理机之间互联","slug":"多物理机之间互联","link":"#多物理机之间互联","children":[{"level":3,"title":"拓扑图","slug":"拓扑图","link":"#拓扑图","children":[]},{"level":3,"title":"ubuntu 示例","slug":"ubuntu-示例","link":"#ubuntu-示例","children":[]}]}],"git":{"createdTime":1722925047000,"updatedTime":1723619297000,"contributors":[{"name":"WSQ","email":"592786982@qq.com","commits":2}]},"readingTime":{"minutes":12.74,"words":3822},"filePathRelative":"linux/docker/Docker的网络.md","localizedDate":"2024年1月10日","autoDesc":true}');export{u as comp,C as data};
