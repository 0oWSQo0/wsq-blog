import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,d as l,o as p}from"./app-BAoNGAQX.js";const o={};function e(F,s){return p(),a("div",null,s[0]||(s[0]=[l(`<h2 id="什么是poi" tabindex="-1"><a class="header-anchor" href="#什么是poi"><span>什么是POI</span></a></h2><p>Apache POI 是用 Java 编写的免费开源的跨平台的 Java API，Apache POI 提供 API 给 Java 程序对 Microsoft Office 格式档案读和写的功能。POI 为<code>Poor Obfuscation Implementation</code>的首字母缩写，意为“简洁版的模糊实现”。</p><p>Apache POI 是创建和维护操作各种符合 Office Open XML（OOXML）标准和微软的 OLE 2 复合文档格式（OLE2）的 Java API。用它可以使用 Java 读取和创建，修改 MS Excel 文件。而且，还可以使用 Java 读取和创建 MS Word 和 MSPowerPoint 文件。更多请参考<a href="https://poi.apache.org/index.html" target="_blank" rel="noopener noreferrer">官方文档</a>。</p><h2 id="poi中基础概念" tabindex="-1"><a class="header-anchor" href="#poi中基础概念"><span>POI中基础概念</span></a></h2><p>生成<code>xls</code>和<code>xlsx</code>有什么区别呢？</p><table><thead><tr><th style="text-align:center;">XLS</th><th style="text-align:left;">XLSX</th></tr></thead><tbody><tr><td style="text-align:center;">只能打开xls格式，无法直接打开xlsx格式</td><td style="text-align:left;">可以直接打开xls、xlsx格式</td></tr><tr><td style="text-align:center;">只有65536行、256列</td><td style="text-align:left;">可以有1048576行、16384列</td></tr><tr><td style="text-align:center;">占用空间大</td><td style="text-align:left;">占用空间小，运算速度也会快一点</td></tr></tbody></table><p>POI 对 Excel 中的对象的封装对应关系如下：</p><table><thead><tr><th style="text-align:center;">Excel</th><th style="text-align:center;">POI XLS</th><th style="text-align:center;">POI XLSX(Excel 2007+)</th></tr></thead><tbody><tr><td style="text-align:center;">Excel 文件</td><td style="text-align:center;">HSSFWorkbook（xls）</td><td style="text-align:center;">XSSFWorkbook（xlsx）</td></tr><tr><td style="text-align:center;">Excel 工作表</td><td style="text-align:center;">HSSFSheet</td><td style="text-align:center;">XSSFSheet</td></tr><tr><td style="text-align:center;">Excel 行</td><td style="text-align:center;">HSSFRow</td><td style="text-align:center;">XSSFRow</td></tr><tr><td style="text-align:center;">Excel 单元格</td><td style="text-align:center;">HSSFCell</td><td style="text-align:center;">XSSFCell</td></tr><tr><td style="text-align:center;">Excel 单元格样式</td><td style="text-align:center;">HSSFCellStyle</td><td style="text-align:center;">HSSFCellStyle</td></tr><tr><td style="text-align:center;">Excel 颜色</td><td style="text-align:center;">HSSFColor</td><td style="text-align:center;">XSSFColor</td></tr><tr><td style="text-align:center;">Excel 字体</td><td style="text-align:center;">HSSFFont</td><td style="text-align:center;">XSSFFont</td></tr></tbody></table><h2 id="实现案例" tabindex="-1"><a class="header-anchor" href="#实现案例"><span>实现案例</span></a></h2><p>这里展示 SpringBoot 集成 POI 导出用户列表的和导入用户列表的例子。</p><h3 id="pom依赖" tabindex="-1"><a class="header-anchor" href="#pom依赖"><span>Pom依赖</span></a></h3><div class="language-xml" data-highlighter="shiki" data-ext="xml" data-title="xml" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">&lt;</span><span style="color:#72F088;">dependency</span><span style="color:#F0F3F6;">&gt;</span></span>
<span class="line"><span style="color:#F0F3F6;">    &lt;</span><span style="color:#72F088;">groupId</span><span style="color:#F0F3F6;">&gt;org.apache.poi&lt;/</span><span style="color:#72F088;">groupId</span><span style="color:#F0F3F6;">&gt;</span></span>
<span class="line"><span style="color:#F0F3F6;">    &lt;</span><span style="color:#72F088;">artifactId</span><span style="color:#F0F3F6;">&gt;poi&lt;/</span><span style="color:#72F088;">artifactId</span><span style="color:#F0F3F6;">&gt;</span></span>
<span class="line"><span style="color:#F0F3F6;">    &lt;</span><span style="color:#72F088;">version</span><span style="color:#F0F3F6;">&gt;5.2.2&lt;/</span><span style="color:#72F088;">version</span><span style="color:#F0F3F6;">&gt;</span></span>
<span class="line"><span style="color:#F0F3F6;">&lt;/</span><span style="color:#72F088;">dependency</span><span style="color:#F0F3F6;">&gt;</span></span>
<span class="line"><span style="color:#F0F3F6;">&lt;</span><span style="color:#72F088;">dependency</span><span style="color:#F0F3F6;">&gt;</span></span>
<span class="line"><span style="color:#F0F3F6;">    &lt;</span><span style="color:#72F088;">groupId</span><span style="color:#F0F3F6;">&gt;org.apache.poi&lt;/</span><span style="color:#72F088;">groupId</span><span style="color:#F0F3F6;">&gt;</span></span>
<span class="line"><span style="color:#F0F3F6;">    &lt;</span><span style="color:#72F088;">artifactId</span><span style="color:#F0F3F6;">&gt;poi-ooxml&lt;/</span><span style="color:#72F088;">artifactId</span><span style="color:#F0F3F6;">&gt;</span></span>
<span class="line"><span style="color:#F0F3F6;">    &lt;</span><span style="color:#72F088;">version</span><span style="color:#F0F3F6;">&gt;5.2.2&lt;/</span><span style="color:#72F088;">version</span><span style="color:#F0F3F6;">&gt;</span></span>
<span class="line"><span style="color:#F0F3F6;">&lt;/</span><span style="color:#72F088;">dependency</span><span style="color:#F0F3F6;">&gt;</span></span></code></pre></div><h3 id="导出excel" tabindex="-1"><a class="header-anchor" href="#导出excel"><span>导出Excel</span></a></h3><p><code>UserController</code>中导出的方法</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">@</span><span style="color:#FF9492;">ApiOperation</span><span style="color:#F0F3F6;">(</span><span style="color:#ADDCFF;">&quot;Download Excel&quot;</span><span style="color:#F0F3F6;">)</span></span>
<span class="line"><span style="color:#F0F3F6;">@</span><span style="color:#FF9492;">GetMapping</span><span style="color:#F0F3F6;">(</span><span style="color:#ADDCFF;">&quot;/excel/download&quot;</span><span style="color:#F0F3F6;">)</span></span>
<span class="line"><span style="color:#FF9492;">public</span><span style="color:#FF9492;"> void</span><span style="color:#DBB7FF;"> download</span><span style="color:#F0F3F6;">(HttpServletResponse response) {</span></span>
<span class="line"><span style="color:#FF9492;">    try</span><span style="color:#F0F3F6;"> {</span></span>
<span class="line"><span style="color:#F0F3F6;">        SXSSFWorkbook</span><span style="color:#F0F3F6;"> workbook</span><span style="color:#FF9492;"> =</span><span style="color:#F0F3F6;"> userService.</span><span style="color:#DBB7FF;">generateExcelWorkbook</span><span style="color:#F0F3F6;">();</span></span>
<span class="line"><span style="color:#F0F3F6;">        response.</span><span style="color:#DBB7FF;">reset</span><span style="color:#F0F3F6;">();</span></span>
<span class="line"><span style="color:#F0F3F6;">        response.</span><span style="color:#DBB7FF;">setContentType</span><span style="color:#F0F3F6;">(</span><span style="color:#ADDCFF;">&quot;application/vnd.ms-excel&quot;</span><span style="color:#F0F3F6;">);</span></span>
<span class="line"><span style="color:#F0F3F6;">        response.</span><span style="color:#DBB7FF;">setHeader</span><span style="color:#F0F3F6;">(</span><span style="color:#ADDCFF;">&quot;Content-disposition&quot;</span><span style="color:#F0F3F6;">,</span></span>
<span class="line"><span style="color:#ADDCFF;">                &quot;attachment;filename=user_excel_&quot;</span><span style="color:#FF9492;"> +</span><span style="color:#F0F3F6;"> System.</span><span style="color:#DBB7FF;">currentTimeMillis</span><span style="color:#F0F3F6;">() </span><span style="color:#FF9492;">+</span><span style="color:#ADDCFF;"> &quot;.xlsx&quot;</span><span style="color:#F0F3F6;">);</span></span>
<span class="line"><span style="color:#F0F3F6;">        OutputStream</span><span style="color:#F0F3F6;"> os</span><span style="color:#FF9492;"> =</span><span style="color:#F0F3F6;"> response.</span><span style="color:#DBB7FF;">getOutputStream</span><span style="color:#F0F3F6;">();</span></span>
<span class="line"><span style="color:#F0F3F6;">        workbook.</span><span style="color:#DBB7FF;">write</span><span style="color:#F0F3F6;">(os);</span></span>
<span class="line"><span style="color:#F0F3F6;">        workbook.</span><span style="color:#DBB7FF;">dispose</span><span style="color:#F0F3F6;">();</span></span>
<span class="line"><span style="color:#F0F3F6;">    } </span><span style="color:#FF9492;">catch</span><span style="color:#F0F3F6;"> (Exception </span><span style="color:#FFB757;">e</span><span style="color:#F0F3F6;">) {</span></span>
<span class="line"><span style="color:#F0F3F6;">        e.</span><span style="color:#DBB7FF;">printStackTrace</span><span style="color:#F0F3F6;">();</span></span>
<span class="line"><span style="color:#F0F3F6;">    }</span></span>
<span class="line"><span style="color:#F0F3F6;">}</span></span></code></pre></div><p><code>UserServiceImpl</code>中导出<code>Excel</code>的主方法</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#FF9492;">private</span><span style="color:#FF9492;"> static</span><span style="color:#FF9492;"> final</span><span style="color:#FF9492;"> int</span><span style="color:#F0F3F6;"> POSITION_ROW</span><span style="color:#FF9492;"> =</span><span style="color:#91CBFF;"> 1</span><span style="color:#F0F3F6;">;</span></span>
<span class="line"><span style="color:#FF9492;">private</span><span style="color:#FF9492;"> static</span><span style="color:#FF9492;"> final</span><span style="color:#FF9492;"> int</span><span style="color:#F0F3F6;"> POSITION_COL</span><span style="color:#FF9492;"> =</span><span style="color:#91CBFF;"> 1</span><span style="color:#F0F3F6;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BDC4CC;">/**</span></span>
<span class="line"><span style="color:#BDC4CC;">  * </span><span style="color:#FF9492;">@return</span><span style="color:#BDC4CC;"> SXSSFWorkbook</span></span>
<span class="line"><span style="color:#BDC4CC;">  */</span></span>
<span class="line"><span style="color:#F0F3F6;">@</span><span style="color:#FF9492;">Override</span></span>
<span class="line"><span style="color:#FF9492;">public</span><span style="color:#F0F3F6;"> SXSSFWorkbook </span><span style="color:#DBB7FF;">generateExcelWorkbook</span><span style="color:#F0F3F6;">() {</span></span>
<span class="line"><span style="color:#F0F3F6;">    SXSSFWorkbook</span><span style="color:#F0F3F6;"> workbook</span><span style="color:#FF9492;"> =</span><span style="color:#FF9492;"> new</span><span style="color:#DBB7FF;"> SXSSFWorkbook</span><span style="color:#F0F3F6;">();</span></span>
<span class="line"><span style="color:#F0F3F6;">    Sheet</span><span style="color:#F0F3F6;"> sheet</span><span style="color:#FF9492;"> =</span><span style="color:#F0F3F6;"> workbook.</span><span style="color:#DBB7FF;">createSheet</span><span style="color:#F0F3F6;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF9492;">    int</span><span style="color:#F0F3F6;"> rows</span><span style="color:#FF9492;"> =</span><span style="color:#F0F3F6;"> POSITION_ROW;</span></span>
<span class="line"><span style="color:#FF9492;">    int</span><span style="color:#F0F3F6;"> cols</span><span style="color:#FF9492;"> =</span><span style="color:#F0F3F6;"> POSITION_COL;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BDC4CC;">    // 表头</span></span>
<span class="line"><span style="color:#F0F3F6;">    Row</span><span style="color:#F0F3F6;"> head</span><span style="color:#FF9492;"> =</span><span style="color:#F0F3F6;"> sheet.</span><span style="color:#DBB7FF;">createRow</span><span style="color:#F0F3F6;">(rows</span><span style="color:#FF9492;">++</span><span style="color:#F0F3F6;">);</span></span>
<span class="line"><span style="color:#FF9492;">    String</span><span style="color:#FFB757;">[] </span><span style="color:#F0F3F6;">columns</span><span style="color:#FF9492;"> =</span><span style="color:#FF9492;"> new</span><span style="color:#FF9492;"> String</span><span style="color:#F0F3F6;">[]{</span><span style="color:#ADDCFF;">&quot;ID&quot;</span><span style="color:#F0F3F6;">, </span><span style="color:#ADDCFF;">&quot;Name&quot;</span><span style="color:#F0F3F6;">, </span><span style="color:#ADDCFF;">&quot;Email&quot;</span><span style="color:#F0F3F6;">, </span><span style="color:#ADDCFF;">&quot;Phone&quot;</span><span style="color:#F0F3F6;">, </span><span style="color:#ADDCFF;">&quot;Description&quot;</span><span style="color:#F0F3F6;">};</span></span>
<span class="line"><span style="color:#FF9492;">    int</span><span style="color:#FFB757;">[] </span><span style="color:#F0F3F6;">colWidths</span><span style="color:#FF9492;"> =</span><span style="color:#FF9492;"> new</span><span style="color:#FF9492;"> int</span><span style="color:#F0F3F6;">[]{</span><span style="color:#91CBFF;">2000</span><span style="color:#F0F3F6;">, </span><span style="color:#91CBFF;">3000</span><span style="color:#F0F3F6;">, </span><span style="color:#91CBFF;">5000</span><span style="color:#F0F3F6;">, </span><span style="color:#91CBFF;">5000</span><span style="color:#F0F3F6;">, </span><span style="color:#91CBFF;">8000</span><span style="color:#F0F3F6;">};</span></span>
<span class="line"><span style="color:#F0F3F6;">    CellStyle</span><span style="color:#F0F3F6;"> headStyle</span><span style="color:#FF9492;"> =</span><span style="color:#DBB7FF;"> getHeadCellStyle</span><span style="color:#F0F3F6;">(workbook);</span></span>
<span class="line"><span style="color:#FF9492;">    for</span><span style="color:#F0F3F6;"> (</span><span style="color:#FF9492;">int</span><span style="color:#F0F3F6;"> i</span><span style="color:#FF9492;"> =</span><span style="color:#91CBFF;"> 0</span><span style="color:#F0F3F6;">; i </span><span style="color:#FF9492;">&lt;</span><span style="color:#F0F3F6;"> columns.length; </span><span style="color:#FF9492;">++</span><span style="color:#F0F3F6;">i) {</span></span>
<span class="line"><span style="color:#F0F3F6;">        sheet.</span><span style="color:#DBB7FF;">setColumnWidth</span><span style="color:#F0F3F6;">(cols, colWidths[i]);</span></span>
<span class="line"><span style="color:#DBB7FF;">        addCellWithStyle</span><span style="color:#F0F3F6;">(head, cols</span><span style="color:#FF9492;">++</span><span style="color:#F0F3F6;">, headStyle).</span><span style="color:#DBB7FF;">setCellValue</span><span style="color:#F0F3F6;">(columns[i]);</span></span>
<span class="line"><span style="color:#F0F3F6;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BDC4CC;">    // 表内容</span></span>
<span class="line"><span style="color:#F0F3F6;">    CellStyle</span><span style="color:#F0F3F6;"> bodyStyle</span><span style="color:#FF9492;"> =</span><span style="color:#DBB7FF;"> getBodyCellStyle</span><span style="color:#F0F3F6;">(workbook);</span></span>
<span class="line"><span style="color:#FF9492;">    for</span><span style="color:#F0F3F6;"> (User</span><span style="color:#F0F3F6;"> user</span><span style="color:#FF9492;"> :</span><span style="color:#DBB7FF;"> getUserList</span><span style="color:#F0F3F6;">()) {</span></span>
<span class="line"><span style="color:#F0F3F6;">        cols </span><span style="color:#FF9492;">=</span><span style="color:#F0F3F6;"> POSITION_COL;</span></span>
<span class="line"><span style="color:#F0F3F6;">        Row</span><span style="color:#F0F3F6;"> row</span><span style="color:#FF9492;"> =</span><span style="color:#F0F3F6;"> sheet.</span><span style="color:#DBB7FF;">createRow</span><span style="color:#F0F3F6;">(rows</span><span style="color:#FF9492;">++</span><span style="color:#F0F3F6;">);</span></span>
<span class="line"><span style="color:#DBB7FF;">        addCellWithStyle</span><span style="color:#F0F3F6;">(row, cols</span><span style="color:#FF9492;">++</span><span style="color:#F0F3F6;">, bodyStyle).</span><span style="color:#DBB7FF;">setCellValue</span><span style="color:#F0F3F6;">(user.</span><span style="color:#DBB7FF;">getId</span><span style="color:#F0F3F6;">());</span></span>
<span class="line"><span style="color:#DBB7FF;">        addCellWithStyle</span><span style="color:#F0F3F6;">(row, cols</span><span style="color:#FF9492;">++</span><span style="color:#F0F3F6;">, bodyStyle).</span><span style="color:#DBB7FF;">setCellValue</span><span style="color:#F0F3F6;">(user.</span><span style="color:#DBB7FF;">getUserName</span><span style="color:#F0F3F6;">());</span></span>
<span class="line"><span style="color:#DBB7FF;">        addCellWithStyle</span><span style="color:#F0F3F6;">(row, cols</span><span style="color:#FF9492;">++</span><span style="color:#F0F3F6;">, bodyStyle).</span><span style="color:#DBB7FF;">setCellValue</span><span style="color:#F0F3F6;">(user.</span><span style="color:#DBB7FF;">getEmail</span><span style="color:#F0F3F6;">());</span></span>
<span class="line"><span style="color:#DBB7FF;">        addCellWithStyle</span><span style="color:#F0F3F6;">(row, cols</span><span style="color:#FF9492;">++</span><span style="color:#F0F3F6;">, bodyStyle).</span><span style="color:#DBB7FF;">setCellValue</span><span style="color:#F0F3F6;">(String.</span><span style="color:#DBB7FF;">valueOf</span><span style="color:#F0F3F6;">(user.</span><span style="color:#DBB7FF;">getPhoneNumber</span><span style="color:#F0F3F6;">()));</span></span>
<span class="line"><span style="color:#DBB7FF;">        addCellWithStyle</span><span style="color:#F0F3F6;">(row, cols</span><span style="color:#FF9492;">++</span><span style="color:#F0F3F6;">, bodyStyle).</span><span style="color:#DBB7FF;">setCellValue</span><span style="color:#F0F3F6;">(user.</span><span style="color:#DBB7FF;">getDescription</span><span style="color:#F0F3F6;">());</span></span>
<span class="line"><span style="color:#F0F3F6;">    }</span></span>
<span class="line"><span style="color:#FF9492;">    return</span><span style="color:#F0F3F6;"> workbook;</span></span>
<span class="line"><span style="color:#F0F3F6;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF9492;">private</span><span style="color:#F0F3F6;"> Cell </span><span style="color:#DBB7FF;">addCellWithStyle</span><span style="color:#F0F3F6;">(Row row, </span><span style="color:#FF9492;">int</span><span style="color:#F0F3F6;"> colPosition, CellStyle cellStyle) {</span></span>
<span class="line"><span style="color:#F0F3F6;">    Cell</span><span style="color:#F0F3F6;"> cell</span><span style="color:#FF9492;"> =</span><span style="color:#F0F3F6;"> row.</span><span style="color:#DBB7FF;">createCell</span><span style="color:#F0F3F6;">(colPosition);</span></span>
<span class="line"><span style="color:#F0F3F6;">    cell.</span><span style="color:#DBB7FF;">setCellStyle</span><span style="color:#F0F3F6;">(cellStyle);</span></span>
<span class="line"><span style="color:#FF9492;">    return</span><span style="color:#F0F3F6;"> cell;</span></span>
<span class="line"><span style="color:#F0F3F6;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF9492;">private</span><span style="color:#F0F3F6;"> List</span><span style="color:#FF9492;">&lt;</span><span style="color:#F0F3F6;">User</span><span style="color:#FF9492;">&gt;</span><span style="color:#DBB7FF;"> getUserList</span><span style="color:#F0F3F6;">() {</span></span>
<span class="line"><span style="color:#FF9492;">    return</span><span style="color:#F0F3F6;"> Collections.</span><span style="color:#DBB7FF;">singletonList</span><span style="color:#F0F3F6;">(User.</span><span style="color:#DBB7FF;">builder</span><span style="color:#F0F3F6;">()</span></span>
<span class="line"><span style="color:#F0F3F6;">            .</span><span style="color:#DBB7FF;">id</span><span style="color:#F0F3F6;">(</span><span style="color:#91CBFF;">1L</span><span style="color:#F0F3F6;">).</span><span style="color:#DBB7FF;">userName</span><span style="color:#F0F3F6;">(</span><span style="color:#ADDCFF;">&quot;pdai&quot;</span><span style="color:#F0F3F6;">).</span><span style="color:#DBB7FF;">email</span><span style="color:#F0F3F6;">(</span><span style="color:#ADDCFF;">&quot;pdai@pdai.tech&quot;</span><span style="color:#F0F3F6;">).</span><span style="color:#DBB7FF;">phoneNumber</span><span style="color:#F0F3F6;">(</span><span style="color:#91CBFF;">121231231231L</span><span style="color:#F0F3F6;">)</span></span>
<span class="line"><span style="color:#F0F3F6;">            .</span><span style="color:#DBB7FF;">description</span><span style="color:#F0F3F6;">(</span><span style="color:#ADDCFF;">&quot;hello world&quot;</span><span style="color:#F0F3F6;">)</span></span>
<span class="line"><span style="color:#F0F3F6;">            .</span><span style="color:#DBB7FF;">build</span><span style="color:#F0F3F6;">());</span></span>
<span class="line"><span style="color:#F0F3F6;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF9492;">private</span><span style="color:#F0F3F6;"> CellStyle </span><span style="color:#DBB7FF;">getHeadCellStyle</span><span style="color:#F0F3F6;">(Workbook workbook) {</span></span>
<span class="line"><span style="color:#F0F3F6;">    CellStyle</span><span style="color:#F0F3F6;"> style</span><span style="color:#FF9492;"> =</span><span style="color:#DBB7FF;"> getBaseCellStyle</span><span style="color:#F0F3F6;">(workbook);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BDC4CC;">    // fill</span></span>
<span class="line"><span style="color:#F0F3F6;">    style.</span><span style="color:#DBB7FF;">setFillForegroundColor</span><span style="color:#F0F3F6;">(IndexedColors.GREY_25_PERCENT.</span><span style="color:#DBB7FF;">getIndex</span><span style="color:#F0F3F6;">());</span></span>
<span class="line"><span style="color:#F0F3F6;">    style.</span><span style="color:#DBB7FF;">setFillPattern</span><span style="color:#F0F3F6;">(FillPatternType.SOLID_FOREGROUND);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF9492;">    return</span><span style="color:#F0F3F6;"> style;</span></span>
<span class="line"><span style="color:#F0F3F6;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF9492;">private</span><span style="color:#F0F3F6;"> CellStyle </span><span style="color:#DBB7FF;">getBodyCellStyle</span><span style="color:#F0F3F6;">(Workbook workbook) {</span></span>
<span class="line"><span style="color:#FF9492;">    return</span><span style="color:#DBB7FF;"> getBaseCellStyle</span><span style="color:#F0F3F6;">(workbook);</span></span>
<span class="line"><span style="color:#F0F3F6;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF9492;">private</span><span style="color:#F0F3F6;"> CellStyle </span><span style="color:#DBB7FF;">getBaseCellStyle</span><span style="color:#F0F3F6;">(Workbook workbook) {</span></span>
<span class="line"><span style="color:#F0F3F6;">    CellStyle</span><span style="color:#F0F3F6;"> style</span><span style="color:#FF9492;"> =</span><span style="color:#F0F3F6;"> workbook.</span><span style="color:#DBB7FF;">createCellStyle</span><span style="color:#F0F3F6;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BDC4CC;">    // font</span></span>
<span class="line"><span style="color:#F0F3F6;">    Font</span><span style="color:#F0F3F6;"> font</span><span style="color:#FF9492;"> =</span><span style="color:#F0F3F6;"> workbook.</span><span style="color:#DBB7FF;">createFont</span><span style="color:#F0F3F6;">();</span></span>
<span class="line"><span style="color:#F0F3F6;">    font.</span><span style="color:#DBB7FF;">setBold</span><span style="color:#F0F3F6;">(</span><span style="color:#91CBFF;">true</span><span style="color:#F0F3F6;">);</span></span>
<span class="line"><span style="color:#F0F3F6;">    style.</span><span style="color:#DBB7FF;">setFont</span><span style="color:#F0F3F6;">(font);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BDC4CC;">    // align</span></span>
<span class="line"><span style="color:#F0F3F6;">    style.</span><span style="color:#DBB7FF;">setAlignment</span><span style="color:#F0F3F6;">(HorizontalAlignment.CENTER);</span></span>
<span class="line"><span style="color:#F0F3F6;">    style.</span><span style="color:#DBB7FF;">setVerticalAlignment</span><span style="color:#F0F3F6;">(VerticalAlignment.TOP);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BDC4CC;">    // border</span></span>
<span class="line"><span style="color:#F0F3F6;">    style.</span><span style="color:#DBB7FF;">setBorderBottom</span><span style="color:#F0F3F6;">(BorderStyle.THIN);</span></span>
<span class="line"><span style="color:#F0F3F6;">    style.</span><span style="color:#DBB7FF;">setBottomBorderColor</span><span style="color:#F0F3F6;">(IndexedColors.BLACK.</span><span style="color:#DBB7FF;">getIndex</span><span style="color:#F0F3F6;">());</span></span>
<span class="line"><span style="color:#F0F3F6;">    style.</span><span style="color:#DBB7FF;">setBorderLeft</span><span style="color:#F0F3F6;">(BorderStyle.THIN);</span></span>
<span class="line"><span style="color:#F0F3F6;">    style.</span><span style="color:#DBB7FF;">setLeftBorderColor</span><span style="color:#F0F3F6;">(IndexedColors.BLACK.</span><span style="color:#DBB7FF;">getIndex</span><span style="color:#F0F3F6;">());</span></span>
<span class="line"><span style="color:#F0F3F6;">    style.</span><span style="color:#DBB7FF;">setBorderRight</span><span style="color:#F0F3F6;">(BorderStyle.THIN);</span></span>
<span class="line"><span style="color:#F0F3F6;">    style.</span><span style="color:#DBB7FF;">setRightBorderColor</span><span style="color:#F0F3F6;">(IndexedColors.BLACK.</span><span style="color:#DBB7FF;">getIndex</span><span style="color:#F0F3F6;">());</span></span>
<span class="line"><span style="color:#F0F3F6;">    style.</span><span style="color:#DBB7FF;">setBorderTop</span><span style="color:#F0F3F6;">(BorderStyle.THIN);</span></span>
<span class="line"><span style="color:#F0F3F6;">    style.</span><span style="color:#DBB7FF;">setTopBorderColor</span><span style="color:#F0F3F6;">(IndexedColors.BLACK.</span><span style="color:#DBB7FF;">getIndex</span><span style="color:#F0F3F6;">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF9492;">    return</span><span style="color:#F0F3F6;"> style;</span></span>
<span class="line"><span style="color:#F0F3F6;">}</span></span></code></pre></div><h3 id="导入excel" tabindex="-1"><a class="header-anchor" href="#导入excel"><span>导入Excel</span></a></h3><p>我们将上面导出的<code>excel</code>文件导入。<code>UserController</code>中导入的方法</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">@</span><span style="color:#FF9492;">ApiOperation</span><span style="color:#F0F3F6;">(</span><span style="color:#ADDCFF;">&quot;Upload Excel&quot;</span><span style="color:#F0F3F6;">)</span></span>
<span class="line"><span style="color:#F0F3F6;">@</span><span style="color:#FF9492;">PostMapping</span><span style="color:#F0F3F6;">(</span><span style="color:#ADDCFF;">&quot;/excel/upload&quot;</span><span style="color:#F0F3F6;">)</span></span>
<span class="line"><span style="color:#FF9492;">public</span><span style="color:#F0F3F6;"> ResponseResult</span><span style="color:#FF9492;">&lt;</span><span style="color:#F0F3F6;">String</span><span style="color:#FF9492;">&gt;</span><span style="color:#DBB7FF;"> upload</span><span style="color:#F0F3F6;">(@</span><span style="color:#FF9492;">RequestParam</span><span style="color:#F0F3F6;">(</span><span style="color:#91CBFF;">value</span><span style="color:#FF9492;"> =</span><span style="color:#ADDCFF;"> &quot;file&quot;</span><span style="color:#F0F3F6;">, </span><span style="color:#91CBFF;">required</span><span style="color:#FF9492;"> =</span><span style="color:#91CBFF;"> true</span><span style="color:#F0F3F6;">) MultipartFile file) {</span></span>
<span class="line"><span style="color:#FF9492;">    try</span><span style="color:#F0F3F6;"> {</span></span>
<span class="line"><span style="color:#F0F3F6;">        userService.</span><span style="color:#DBB7FF;">upload</span><span style="color:#F0F3F6;">(file.</span><span style="color:#DBB7FF;">getInputStream</span><span style="color:#F0F3F6;">());</span></span>
<span class="line"><span style="color:#F0F3F6;">    } </span><span style="color:#FF9492;">catch</span><span style="color:#F0F3F6;"> (Exception </span><span style="color:#FFB757;">e</span><span style="color:#F0F3F6;">) {</span></span>
<span class="line"><span style="color:#F0F3F6;">        e.</span><span style="color:#DBB7FF;">printStackTrace</span><span style="color:#F0F3F6;">();</span></span>
<span class="line"><span style="color:#FF9492;">        return</span><span style="color:#F0F3F6;"> ResponseResult.</span><span style="color:#DBB7FF;">fail</span><span style="color:#F0F3F6;">(e.</span><span style="color:#DBB7FF;">getMessage</span><span style="color:#F0F3F6;">());</span></span>
<span class="line"><span style="color:#F0F3F6;">    }</span></span>
<span class="line"><span style="color:#FF9492;">    return</span><span style="color:#F0F3F6;"> ResponseResult.</span><span style="color:#DBB7FF;">success</span><span style="color:#F0F3F6;">();</span></span>
<span class="line"><span style="color:#F0F3F6;">}</span></span></code></pre></div><p><code>UserServiceImpl</code>中导入<code>Excel</code>的主方法</p><div class="language-java" data-highlighter="shiki" data-ext="java" data-title="java" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">@</span><span style="color:#FF9492;">Override</span></span>
<span class="line"><span style="color:#FF9492;">public</span><span style="color:#FF9492;"> void</span><span style="color:#DBB7FF;"> upload</span><span style="color:#F0F3F6;">(InputStream inputStream) throws IOException {</span></span>
<span class="line"><span style="color:#F0F3F6;">    XSSFWorkbook</span><span style="color:#F0F3F6;"> book</span><span style="color:#FF9492;"> =</span><span style="color:#FF9492;"> new</span><span style="color:#DBB7FF;"> XSSFWorkbook</span><span style="color:#F0F3F6;">(inputStream);</span></span>
<span class="line"><span style="color:#F0F3F6;">    XSSFSheet</span><span style="color:#F0F3F6;"> sheet</span><span style="color:#FF9492;"> =</span><span style="color:#F0F3F6;"> book.</span><span style="color:#DBB7FF;">getSheetAt</span><span style="color:#F0F3F6;">(</span><span style="color:#91CBFF;">0</span><span style="color:#F0F3F6;">);</span></span>
<span class="line"><span style="color:#BDC4CC;">    // add some validation here</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BDC4CC;">    // parse data</span></span>
<span class="line"><span style="color:#FF9492;">    int</span><span style="color:#F0F3F6;"> cols;</span></span>
<span class="line"><span style="color:#FF9492;">    for</span><span style="color:#F0F3F6;"> (</span><span style="color:#FF9492;">int</span><span style="color:#F0F3F6;"> i</span><span style="color:#FF9492;"> =</span><span style="color:#F0F3F6;"> POSITION_ROW; i </span><span style="color:#FF9492;">&lt;</span><span style="color:#F0F3F6;"> sheet.</span><span style="color:#DBB7FF;">getLastRowNum</span><span style="color:#F0F3F6;">(); i</span><span style="color:#FF9492;">++</span><span style="color:#F0F3F6;">) {</span></span>
<span class="line"><span style="color:#F0F3F6;">        XSSFRow</span><span style="color:#F0F3F6;"> row</span><span style="color:#FF9492;"> =</span><span style="color:#F0F3F6;"> sheet.</span><span style="color:#DBB7FF;">getRow</span><span style="color:#F0F3F6;">(i </span><span style="color:#FF9492;">+</span><span style="color:#91CBFF;"> 1</span><span style="color:#F0F3F6;">); </span><span style="color:#BDC4CC;">// 表头不算</span></span>
<span class="line"><span style="color:#F0F3F6;">        cols </span><span style="color:#FF9492;">=</span><span style="color:#F0F3F6;"> POSITION_COL;</span></span>
<span class="line"><span style="color:#F0F3F6;">        User</span><span style="color:#F0F3F6;"> user</span><span style="color:#FF9492;"> =</span><span style="color:#F0F3F6;"> User.</span><span style="color:#DBB7FF;">builder</span><span style="color:#F0F3F6;">()</span></span>
<span class="line"><span style="color:#F0F3F6;">                .</span><span style="color:#DBB7FF;">id</span><span style="color:#F0F3F6;">(</span><span style="color:#DBB7FF;">getCellLongValue</span><span style="color:#F0F3F6;">(row.</span><span style="color:#DBB7FF;">getCell</span><span style="color:#F0F3F6;">(cols</span><span style="color:#FF9492;">++</span><span style="color:#F0F3F6;">)))</span></span>
<span class="line"><span style="color:#F0F3F6;">                .</span><span style="color:#DBB7FF;">userName</span><span style="color:#F0F3F6;">(</span><span style="color:#DBB7FF;">getCellStringValue</span><span style="color:#F0F3F6;">(row.</span><span style="color:#DBB7FF;">getCell</span><span style="color:#F0F3F6;">(cols</span><span style="color:#FF9492;">++</span><span style="color:#F0F3F6;">)))</span></span>
<span class="line"><span style="color:#F0F3F6;">                .</span><span style="color:#DBB7FF;">email</span><span style="color:#F0F3F6;">(</span><span style="color:#DBB7FF;">getCellStringValue</span><span style="color:#F0F3F6;">(row.</span><span style="color:#DBB7FF;">getCell</span><span style="color:#F0F3F6;">(cols</span><span style="color:#FF9492;">++</span><span style="color:#F0F3F6;">)))</span></span>
<span class="line"><span style="color:#F0F3F6;">                .</span><span style="color:#DBB7FF;">phoneNumber</span><span style="color:#F0F3F6;">(Long.</span><span style="color:#DBB7FF;">parseLong</span><span style="color:#F0F3F6;">(</span><span style="color:#DBB7FF;">getCellStringValue</span><span style="color:#F0F3F6;">(row.</span><span style="color:#DBB7FF;">getCell</span><span style="color:#F0F3F6;">(cols</span><span style="color:#FF9492;">++</span><span style="color:#F0F3F6;">))))</span></span>
<span class="line"><span style="color:#F0F3F6;">                .</span><span style="color:#DBB7FF;">description</span><span style="color:#F0F3F6;">(</span><span style="color:#DBB7FF;">getCellStringValue</span><span style="color:#F0F3F6;">(row.</span><span style="color:#DBB7FF;">getCell</span><span style="color:#F0F3F6;">(cols</span><span style="color:#FF9492;">++</span><span style="color:#F0F3F6;">)))</span></span>
<span class="line"><span style="color:#F0F3F6;">                .</span><span style="color:#DBB7FF;">build</span><span style="color:#F0F3F6;">();</span></span>
<span class="line"><span style="color:#F0F3F6;">        log.</span><span style="color:#DBB7FF;">info</span><span style="color:#F0F3F6;">(user.</span><span style="color:#DBB7FF;">toString</span><span style="color:#F0F3F6;">());</span></span>
<span class="line"><span style="color:#F0F3F6;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F0F3F6;">    book.</span><span style="color:#DBB7FF;">close</span><span style="color:#F0F3F6;">();</span></span>
<span class="line"><span style="color:#F0F3F6;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF9492;">private</span><span style="color:#F0F3F6;"> String </span><span style="color:#DBB7FF;">getCellStringValue</span><span style="color:#F0F3F6;">(XSSFCell cell) {</span></span>
<span class="line"><span style="color:#FF9492;">    try</span><span style="color:#F0F3F6;"> {</span></span>
<span class="line"><span style="color:#FF9492;">        if</span><span style="color:#F0F3F6;"> (</span><span style="color:#91CBFF;">null</span><span style="color:#FF9492;">!=</span><span style="color:#F0F3F6;">cell) {</span></span>
<span class="line"><span style="color:#FF9492;">            return</span><span style="color:#F0F3F6;"> String.</span><span style="color:#DBB7FF;">valueOf</span><span style="color:#F0F3F6;">(cell.</span><span style="color:#DBB7FF;">getStringCellValue</span><span style="color:#F0F3F6;">());</span></span>
<span class="line"><span style="color:#F0F3F6;">        }</span></span>
<span class="line"><span style="color:#F0F3F6;">    } </span><span style="color:#FF9492;">catch</span><span style="color:#F0F3F6;"> (Exception </span><span style="color:#FFB757;">e</span><span style="color:#F0F3F6;">) {</span></span>
<span class="line"><span style="color:#FF9492;">        return</span><span style="color:#F0F3F6;"> String.</span><span style="color:#DBB7FF;">valueOf</span><span style="color:#F0F3F6;">(</span><span style="color:#DBB7FF;">getCellIntValue</span><span style="color:#F0F3F6;">(cell));</span></span>
<span class="line"><span style="color:#F0F3F6;">    }</span></span>
<span class="line"><span style="color:#FF9492;">    return</span><span style="color:#ADDCFF;"> &quot;&quot;</span><span style="color:#F0F3F6;">;</span></span>
<span class="line"><span style="color:#F0F3F6;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF9492;">private</span><span style="color:#FF9492;"> long</span><span style="color:#DBB7FF;"> getCellLongValue</span><span style="color:#F0F3F6;">(XSSFCell cell) {</span></span>
<span class="line"><span style="color:#FF9492;">    try</span><span style="color:#F0F3F6;"> {</span></span>
<span class="line"><span style="color:#FF9492;">        if</span><span style="color:#F0F3F6;"> (</span><span style="color:#91CBFF;">null</span><span style="color:#FF9492;">!=</span><span style="color:#F0F3F6;">cell) {</span></span>
<span class="line"><span style="color:#FF9492;">            return</span><span style="color:#F0F3F6;"> Long.</span><span style="color:#DBB7FF;">parseLong</span><span style="color:#F0F3F6;">(</span><span style="color:#ADDCFF;">&quot;&quot;</span><span style="color:#FF9492;"> +</span><span style="color:#F0F3F6;"> (</span><span style="color:#FF9492;">long</span><span style="color:#F0F3F6;">) cell.</span><span style="color:#DBB7FF;">getNumericCellValue</span><span style="color:#F0F3F6;">());</span></span>
<span class="line"><span style="color:#F0F3F6;">        }</span></span>
<span class="line"><span style="color:#F0F3F6;">    } </span><span style="color:#FF9492;">catch</span><span style="color:#F0F3F6;"> (Exception </span><span style="color:#FFB757;">e</span><span style="color:#F0F3F6;">) {</span></span>
<span class="line"><span style="color:#F0F3F6;">        e.</span><span style="color:#DBB7FF;">printStackTrace</span><span style="color:#F0F3F6;">();</span></span>
<span class="line"><span style="color:#F0F3F6;">    }</span></span>
<span class="line"><span style="color:#FF9492;">    return</span><span style="color:#91CBFF;"> 0L</span><span style="color:#F0F3F6;">;</span></span>
<span class="line"><span style="color:#F0F3F6;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF9492;">private</span><span style="color:#FF9492;"> int</span><span style="color:#DBB7FF;"> getCellIntValue</span><span style="color:#F0F3F6;">(XSSFCell cell) {</span></span>
<span class="line"><span style="color:#FF9492;">    try</span><span style="color:#F0F3F6;"> {</span></span>
<span class="line"><span style="color:#FF9492;">        if</span><span style="color:#F0F3F6;"> (</span><span style="color:#91CBFF;">null</span><span style="color:#FF9492;">!=</span><span style="color:#F0F3F6;">cell) {</span></span>
<span class="line"><span style="color:#FF9492;">            return</span><span style="color:#F0F3F6;"> Integer.</span><span style="color:#DBB7FF;">parseInt</span><span style="color:#F0F3F6;">(</span><span style="color:#ADDCFF;">&quot;&quot;</span><span style="color:#FF9492;"> +</span><span style="color:#F0F3F6;"> (</span><span style="color:#FF9492;">int</span><span style="color:#F0F3F6;">) cell.</span><span style="color:#DBB7FF;">getNumericCellValue</span><span style="color:#F0F3F6;">());</span></span>
<span class="line"><span style="color:#F0F3F6;">        }</span></span>
<span class="line"><span style="color:#F0F3F6;">    } </span><span style="color:#FF9492;">catch</span><span style="color:#F0F3F6;"> (Exception </span><span style="color:#FFB757;">e</span><span style="color:#F0F3F6;">) {</span></span>
<span class="line"><span style="color:#F0F3F6;">        e.</span><span style="color:#DBB7FF;">printStackTrace</span><span style="color:#F0F3F6;">();</span></span>
<span class="line"><span style="color:#F0F3F6;">    }</span></span>
<span class="line"><span style="color:#FF9492;">    return</span><span style="color:#91CBFF;"> 0</span><span style="color:#F0F3F6;">;</span></span>
<span class="line"><span style="color:#F0F3F6;">}</span></span></code></pre></div><p>通过 PostMan 进行接口测试执行接口后，后台的日志如下：</p><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span>2024-06-10 21:36:01.720  INFO 15100 --- [nio-8080-exec-2] t.p.s.f.e.p.s.impl.UserServiceImpl: User(id=1, userName=pdai, email=pdai@pdai.tech, phoneNumber=121231231231, description=hello world)</span></span></code></pre></div>`,24)]))}const r=n(o,[["render",e],["__file","springBoot—集成POI.html.vue"]]),y=JSON.parse('{"path":"/java/springBoot/springBoot%E2%80%94%E9%9B%86%E6%88%90POI.html","title":"","lang":"zh-CN","frontmatter":{"description":"什么是POI Apache POI 是用 Java 编写的免费开源的跨平台的 Java API，Apache POI 提供 API 给 Java 程序对 Microsoft Office 格式档案读和写的功能。POI 为Poor Obfuscation Implementation的首字母缩写，意为“简洁版的模糊实现”。 Apache POI 是创建和...","head":[["meta",{"property":"og:url","content":"https://0oWSQo0.github.io/wsq-blog/java/springBoot/springBoot%E2%80%94%E9%9B%86%E6%88%90POI.html"}],["meta",{"property":"og:description","content":"什么是POI Apache POI 是用 Java 编写的免费开源的跨平台的 Java API，Apache POI 提供 API 给 Java 程序对 Microsoft Office 格式档案读和写的功能。POI 为Poor Obfuscation Implementation的首字母缩写，意为“简洁版的模糊实现”。 Apache POI 是创建和..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-11-01T01:55:29.000Z"}],["meta",{"property":"article:modified_time","content":"2024-11-01T01:55:29.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-11-01T01:55:29.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"WSQ\\",\\"url\\":\\"https://0oWSQo0.github.com\\"}]}"]]},"headers":[{"level":2,"title":"什么是POI","slug":"什么是poi","link":"#什么是poi","children":[]},{"level":2,"title":"POI中基础概念","slug":"poi中基础概念","link":"#poi中基础概念","children":[]},{"level":2,"title":"实现案例","slug":"实现案例","link":"#实现案例","children":[{"level":3,"title":"Pom依赖","slug":"pom依赖","link":"#pom依赖","children":[]},{"level":3,"title":"导出Excel","slug":"导出excel","link":"#导出excel","children":[]},{"level":3,"title":"导入Excel","slug":"导入excel","link":"#导入excel","children":[]}]}],"git":{"createdTime":1730426129000,"updatedTime":1730426129000,"contributors":[{"name":"WSQ","email":"592786982@qq.com","commits":1}]},"readingTime":{"minutes":2.93,"words":879},"filePathRelative":"java/springBoot/springBoot—集成POI.md","localizedDate":"2024年11月1日","autoDesc":true}');export{r as comp,y as data};
