<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.59" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://0oWSQo0.github.io/wsq-blog/%E7%AC%94%E8%AE%B0/%E5%8D%8E%E4%B8%BA%E6%95%B0%E9%80%9A%E7%AC%94%E8%AE%B0.html"><meta property="og:description" content="VRP命令行视图VRP命令行视图 命令行在线帮助命令行在线帮助 系统时钟是设备上的系统时间戳。由于地域的不同，用户可以根据当地规定设置系统时钟。用户必须正确设置系统时钟以确保其与其他设备保持同步。 设置系统时钟的公式为：UTC+时区偏移量+夏时制时间偏移量。clock datetime命令设置HH:MM:SS YYYY-MM-DD格式的系统时钟。但是需..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-05-07T05:36:04.000Z"><meta property="article:modified_time" content="2025-05-07T05:36:04.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"","image":[""],"dateModified":"2025-05-07T05:36:04.000Z","author":[{"@type":"Person","name":"WSQ","url":"https://0oWSQo0.github.com"}]}</script><title></title><meta name="description" content="VRP命令行视图VRP命令行视图 命令行在线帮助命令行在线帮助 系统时钟是设备上的系统时间戳。由于地域的不同，用户可以根据当地规定设置系统时钟。用户必须正确设置系统时钟以确保其与其他设备保持同步。 设置系统时钟的公式为：UTC+时区偏移量+夏时制时间偏移量。clock datetime命令设置HH:MM:SS YYYY-MM-DD格式的系统时钟。但是需...">
    <link rel="preload" href="/wsq-blog/assets/style-B8iyyxn3.css" as="style"><link rel="stylesheet" href="/wsq-blog/assets/style-B8iyyxn3.css">
    <link rel="modulepreload" href="/wsq-blog/assets/app-BAoNGAQX.js"><link rel="modulepreload" href="/wsq-blog/assets/华为数通笔记.html-CFn1KnHB.js"><link rel="modulepreload" href="/wsq-blog/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/wsq-blog/assets/index.html-y9hjWg4H.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/portfolio.html-BXkm2R9O.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/进制.html-D8SGjDfR.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ACL详解.html-BloX_IeT.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ARP详解.html-cBNfZDN_.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/BGP详解.html-H-6DMP-Q.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/DHCP详解.html-5OsfIqif.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/DNS详解.html-9f9jSQ6z.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/HTTPS详解.html-B1MNeeCC.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ICMP详解.html-rOsq0YlX.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/IPv6详解.html-mcuWo4Lm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/IP详解.html-Cn_WOg-x.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ISIS详解.html-CKYYamtd.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/NAT详解.html-9GTOa7EI.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/OSPF-LSA.html-DeRnGEZO.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/OSPF实战.html-DP7X6rhm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/OSPF特性.html-CHIr3PPJ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/OSPF详解.html-CbPtE_bm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/RIP详解.html-QgpY6GUV.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/RSTP、MSTP详解.html-BXEuGz-T.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/STP详解.html-C1DTR0aY.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/TCP和UDP详解.html-BZu5cSVW.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/VLAN详解.html-D6hv5wdt.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/VPN详解.html-BhwoQ2eB.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/VRRP详解.html-DVENiYOQ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Wireshark使用教程.html-nr1YJCIH.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/三层交换机.html-DfJEb5tX.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/华为命令.html-CLrOQfhN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/应用层协议详解.html-DVr0k4nr.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/数据链路层基础知识.html-BXryfrXx.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/无线网络详解.html-QsHhSR6H.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/校验码.html-CMZ1aKIy.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/网络基础知识.html-lq4pXFoN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/路由协议详解.html-DIdwYcdD.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/路由器.html-C9VJQbwh.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/路由策略和策略路由.html-CxTk51aa.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/路由高级特性.html-BLZaIDsP.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/链路聚合技术.html-BBLX_r7x.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/防火墙.html-xIL0MxFq.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/静态路由详解.html-Cn79_8_w.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/网站收藏.html-wtWtedCA.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python元组.html-C35VawoP.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python函数.html-D6Qhr5G1.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python列表.html-CLPZErQH.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python变量.html-YJzPA_R6.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python基础.html-BZCQtRn2.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python字典.html-qcjF8v7r.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python字符串常用方法.html-DYzfZrjm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python异常处理机制.html-CjgoKvUP.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python文件操作.html-B0iP2xCS.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python模块和包.html-CResYCBN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python流程控制.html-C3ZzWANj.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python爬虫.html-CQqaavzW.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python类和对象.html-DYK3lmTC.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python类特殊成员.html-DxW-zaVC.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python运算符.html-Am9I9ipn.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python集合.html-Dp4fBRSz.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-GtLqceJP.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/disable.html-DhwD98pb.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/encrypt.html-BmguXeXU.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/layout.html-Ccbzvy5y.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/markdown.html-b_YalApo.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/page.html-M98jd5pQ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/OSPF.html-cztG_FLD.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/网络.html-BbtEGDZP.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/文字特效.html-CDNfMzpk.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 ArrayBuffer.html-Cl4VZg1r.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 Class.html-CaeH-519.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 Class的继承.html-D1Gdrm4I.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 Module的加载实现.html-n59X0Nwm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 Module语法.html-CUrdTY80.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 Set和Map.html-DKX3dnZP.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 async函数.html-D1WNxO1H.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 let和const.html-8HvK1j46.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 proxy.html-3homrOiA.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6Iterator和forof循环.html-4EZTMvYn.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6Promise对象.html-BPigeBNB.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6Symbol.html-CtdsFENt.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6函数.html-BcPSTM_5.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6字符串.html-D0qEo11d.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6对象.html-CJWUhs9N.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6数值.html-BlBM_CBu.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6数组.html-DrjqHESM.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6结构赋值.html-DIY-p22Z.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6运算符.html-C8BDY9Rl.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/d.ts类型声明文件.html-CDZ4uJ25.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts三种特殊类型.html-CUjOdOBa.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts函数类型.html-j8m-EAgP.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts对象类型.html-DPXW-ga3.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts数据类型.html-BpaHf3ds.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts数组和元组.html-BAaRqN14.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts泛型.html-Buw5j75J.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts的Enum类型.html-Byl3l3qW.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts的interface接口.html-FPr7UtEK.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts类型断言.html-B-iBe9DT.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-CanvasAPI.html-C4EL_HZd.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-ClipboardAPI.html-CwrWQ7PN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-FetchAPI.html-TI0HPebM.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-File_FileList_FileReader.html-BAlNMKUb.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-FormData.html-D9ULMjGG.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-History.html-BR4tGLRY.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-SVG.html-L7Ds9vcL.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-URL.html-C6Za9YIY.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-URLPatternAPI.html-BdJeGXZm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-WebSocket.html-DIFx7koR.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-window.html-Bz0eWajB.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS实用代码片段.html-CSVtMNuW.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/SpringJdbcTemplate.html-B0ZT7oaZ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring事务.html-KeGQ7jKA.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring的整体脉络.html-BhMb13xM.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring详解—IOC实现原理之Bean实例化.html-755XRiKp.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring详解—IOC实现原理之IOC体系结构设计.html-BU12GVal.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring详解—IOC实现原理之IOC初始化流程.html-Bcdh-3-8.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring详解—Spring和Spring框架组成.html-DhEpbrji.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring详解—控制反转IOC.html-1HXdthO7.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring详解—简单例子引入Spring要点.html-pbJC4jBI.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring详解—面向切面编程(AOP).html-2uhc-qFV.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java 集合.html-CI_1se6U.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java修饰符和关键字.html-Bds7WBkl.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java内置包装类.html-WRzUyaot.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java内部类.html-D-hpb9YN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java反射机制.html-B0u-aZMm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java基础—SPI机制.html--PjTaDC-.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java基础—反射机制.html-Di7zg_-6.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java基础—异常机制.html-C9Jltuxw.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java基础—泛型机制.html-DMd2pwVR.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java基础—注解机制.html-B9USVSlN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java字符串处理.html-D_rrovfs.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java序列化与反序列化.html-BOs0fCXy.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java异常处理.html-CiErb1jn.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java数字处理.html-DmexAmZG.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java数组.html-BP5Yfe2s.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java数组操作.html-BArfyCs_.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java时间日期的处理.html-BZJD8Yo2.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java泛型和枚举.html-BI24_Lh7.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java类和对象.html-CPUY67Fk.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java输入输出流.html-BWPJfW4h.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/java继承封装和多态.html-CSpnGKJ4.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—Mapper映射文件配置.html-BNmW_Z06.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—sqlSession执行流程.html-DBTVa2OW.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—一级缓存实现机制.html-Cb435cgF.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—事务管理机制.html-DIHpVRBV.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—二级缓存实现机制.html-8q3bkMC0.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—初始化基本流程.html-d1Vr3b-S.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—动态SQL使用与原理.html-DBuN--r0.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—总体框架设计.html-BspOqrrx.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—插件之分页机制.html-CVfnE8LX.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—插件机制.html-CqsrZDcp.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—数据源与连接池.html-Czq24GfH.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—配置清单.html-DF3yeIZ0.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—配置解析过程.html-CEJH1pu7.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Servlet Cookie和Session.html-CWWdORcy.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Servlet过滤器.html-C-xLWyJr.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/servlet1.html-Coup9vOB.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/servlet2.html-ihS4wAZT.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/servlet3.html-BWeFNNxS.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot—devtools.html-xEXVpFBb.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot—常用注解.html-_HVb37q8.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot—集成Druid连接池.html-CfYGmu2g.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot—集成EasyExcel.html-tq0SN1Ft.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot—集成POI.html-KhW9FXwO.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot—集成actuator监控工具.html-BXbyLj_m.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot—集成admin监控工具.html-D9p-UOPX.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot集成MyBatis—XML方式.html-DTuQ-eoR.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot集成Mybatis—PageHelper分页.html-CfUITTDW.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot集成Mybatis—注解方式.html-BZ1OLpXO.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/SpringMVC入门.html-DYUPumLp.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/SpringMVC域对象共享数据.html-ChLAabt7.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/SpringMVC实现Restful.html-CGsAaTLD.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/SpringMVC获取请求参数.html-vMl99Hg6.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/SpringMVC视图和视图解析器.html-BiLG-6j8.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Dockerfile定制镜像.html-G2sxyKio.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Docker基础.html-DVo1b4T6.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Docker的数据卷.html-CUaR897X.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Docker的网络.html-D_zThKFh.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/docker-compose.html-UGr3yfF8.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/热门镜像安装.html-_u7TFfrM.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/集成Docker实现一键部署.html-BhlW0_gg.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—入门.html-BhtxRtVN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—函数.html-DktAR5MO.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—变量.html-CDD3IwzV.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—字符串操作.html-CQcvhH9K.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—常用命令.html-_akWuHlJ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—数组.html-vTJEhlPQ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—模式扩展.html-CI7-g1hm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—流程控制.html-BFyG9TLx.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—算数运算.html-DBrCwfx3.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/LinuxSSH命令.html-Bpxk7XTt.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/LinuxVim.html-DGPh-mEF.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux入门.html-ZAKFcDi2.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux常用软件安装.html-CJz7CUK1.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux打包压缩命令.html-oVn9T6yl.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux操作历史.html-BEZVZdks.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux文件目录相关命令.html-CT8cuya0.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux文件系统结构.html-BCYXQfGo.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux文本操作命令.html-C1qx5bj6.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux权限管理.html-BrzQFM_6.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux用户和用户组管理.html-cHqLXYUS.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux磁盘相关命令.html-Bk1vWp_s.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux系统服务管理.html-DQVl65aa.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux网络相关命令.html-BCrparGN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux软件安装.html-BdsrJqcj.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux进程相关命令.html-DkriE6C4.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux防火墙详解.html-BfE8j8Co.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linx其它常用命令.html-DbIEYSRH.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/VMware安装linux.html-DF9azwZa.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/linux常用工具.html-CGtPjFAM.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/安装脚本实例.html-0kRVZri1.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ansible-playbook.html-CDcGrj1_.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ansible.html-CehcSPGK.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ansible常用模块.html-KBDB5y_K.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/nginx入门.html-D0xAoW9D.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Requests基本用法.html-DhBsfgOV.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Scrapy爬虫框架.html-B3M5MZow.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/urllib包.html-B4r7Fmqq.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL事务.html-dWAPSxdl.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL入门.html-Bm_oWoBE.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL基础查询.html-B-emxQ5X.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL多表查询.html-BrwxgCv6.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL字符集和校对规则.html-ozeyPJdP.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL存储引擎.html-3zjiFhFD.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL存储过程.html-KbabVN6z.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL安装.html-Cos3L3tR.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL常用函数汇总.html-BxaA0aHv.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL常见问题.html-CXFDHjlk.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL执行流程.html-BAXJ078x.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL操作表中的数据.html-BSFFJgYT.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL数据库备份恢复.html-D1o3_rhN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL数据库的基本操作.html-CdzWAGDm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL数据类型.html-kVOe4_gy.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL数据表的基本操作.html-BKQeQ9rK.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL日志.html-B8qVLOIE.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL用户管理.html-DY5mkBHL.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL索引.html-Y5-Wn-Ns.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL约束.html-tqcKxnNB.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL视图.html-Dvlg6sc5.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL触发器.html-DrUUb4sH.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL试题.html-CrD4I06p.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL运算符.html-Cuyt0x-G.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL锁机制.html-CEXSfDOm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL高级查询.html-MYzC4-LQ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Redis Stream.html-DRkKy_fr.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Redis发布订阅模式.html-8ovmHjic.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Redis基础入门.html-CnPzPUcO.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Redis基础数据类型.html-CclhSKaQ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Redis特殊数据类型.html-BVv9ijlq.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Redis的键.html-CvQ3kMQg.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Redis配置文件.html-D2SsHd1F.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/404.html-BlieSuoI.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-CZ6tDm5n.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-DDe4C4By.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-BzfxMV2E.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-CGR1uTaO.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-C8i93F1_.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-DMZ4MO3h.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-D4-erai_.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-7v6dhxuF.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-DW2tbR-f.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-CJiqu4_o.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-BPuFGnBK.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-Czqdcg4u.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-OvYZXapl.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-C61Yv5KG.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-BTU9BpIn.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-e_1t2G6T.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-CI6fbVHE.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-BTxrdDkL.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-Ddp4aLQU.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-O0sx69kH.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-BVGzpYeT.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-BmmsHO8n.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-B7mYeUT8.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-BFacqWRe.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-B5DDXp-M.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/giscus-BZxmVUME.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/flowchart-CTwbLKUk.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index-BYq9jyaM.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index-DRWmbcXV.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index-B9oRC6ej.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/mermaid.esm.min-CATR3y-q.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/photoswipe.esm-GXRgw7eJ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/setupDevtools-7MC2TMWH-DtIpLJvU.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/wsq-blog/" aria-label="带我回家"><img class="vp-nav-logo" src="/wsq-blog/logo.png" alt><!----><!----></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/wsq-blog/" aria-label="主页"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="logos:google-home" width="1em" height="1em"></iconify-icon><!--]-->主页<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="前端"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:javascript" width="1em" height="1em"></iconify-icon>前端<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/js/%E5%9F%BA%E7%A1%80/" aria-label="JS基础"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:javascript" width="1em" height="1em"></iconify-icon><!--]-->JS基础<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/js/es6/" aria-label="ES6"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="logos:es6" width="1em" height="1em"></iconify-icon><!--]-->ES6<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/js/CSS/" aria-label="CSS"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:css3" width="1em" height="1em"></iconify-icon><!--]-->CSS<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Java"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:java" width="1em" height="1em"></iconify-icon>Java<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/java/java%E5%9F%BA%E7%A1%80/" aria-label="Java基础"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:java" width="1em" height="1em"></iconify-icon><!--]-->Java基础<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/java/mybatis/" aria-label="Mybatis"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Mybatis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/java/Spring/" aria-label="Spring"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/java/springBoot/" aria-label="springBoot"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->springBoot<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="SQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:azuresqldatabase" width="1em" height="1em"></iconify-icon>SQL<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/sql/redis/" aria-label="Redis"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/sql/mysql/" aria-label="MySQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mysql-wordmark" width="1em" height="1em"></iconify-icon><!--]-->MySQL<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="运维"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:centos" width="1em" height="1em"></iconify-icon>运维<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/linux/linux%E5%9F%BA%E7%A1%80/" aria-label="linux基础"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:linux" width="1em" height="1em"></iconify-icon><!--]-->linux基础<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/linux/docker/" aria-label="Docker"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:docker" width="1em" height="1em"></iconify-icon><!--]-->Docker<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/linux/tools/" aria-label="运维工具"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:linux" width="1em" height="1em"></iconify-icon><!--]-->运维工具<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="计算机基础"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:windows11" width="1em" height="1em"></iconify-icon>计算机基础<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/network/" aria-label="网络"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:networkx" width="1em" height="1em"></iconify-icon><!--]-->网络<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/computer/" aria-label="其他"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:haskell" width="1em" height="1em"></iconify-icon><!--]-->其他<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://0oWSQo0.github.com" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/" aria-label="主页"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="logos:google-home" width="1em" height="1em"></iconify-icon><!--]-->主页<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!----></h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://0oWSQo0.github.com" target="_blank" rel="noopener noreferrer">WSQ</a></span><span property="author" content="WSQ"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025年4月23日</span><meta property="datePublished" content="2025-04-23T09:49:11.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 56 分钟</span><meta property="timeRequired" content="PT56M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#命令等级">命令等级</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#用户界面">用户界面</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#配置用户界面命令">配置用户界面命令</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#配置登陆权限">配置登陆权限</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#配置接口ip地址">配置接口IP地址</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#静态路由">静态路由</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#路由的度量值-metric">路由的度量值（metric）</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#路由条目优选进路由表">路由条目优选进路由表</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#路由的选路规则">路由的选路规则</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#最长匹配原则">最长匹配原则</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#静态路由的下一跳">静态路由的下一跳</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#缺省路由">缺省路由</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#负载分担">负载分担</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#浮动路由">浮动路由</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#ipv6">IPv6</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ipv6基本报头">IPv6基本报头</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ipv6扩展报头">IPv6扩展报头</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ipv6地址格式">IPv6地址格式</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ipv6地址压缩格式">IPv6地址压缩格式</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ipv6地址分类">IPv6地址分类</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ipv6单播地址">IPv6单播地址</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ipv6组播地址">IPv6组播地址</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ipv6任播地址">IPv6任播地址</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ipv6无状态地址自动配置">IPv6无状态地址自动配置</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#eui-64规范">EUI-64规范</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ipv6无状态地址dad检查">IPv6无状态地址DAD检查</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#基本acl介绍">基本ACL介绍</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#acl的匹配顺序">ACL的匹配顺序</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#基本ipv4-acl的-深度优先-原则">基本IPv4 ACL的“深度优先”原则</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#配置acl">配置ACL</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#通配符掩码-wildcard-mask">通配符掩码 （WildCard Mask）</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#基本acl应用">基本ACL应用</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#什么是in-什么是out">什么是IN，什么是OUT</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#命名acl">命名acl</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#time-range">time-range</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#基本ipv4-acl的-深度优先-原则-1">基本IPv4 ACL的“深度优先”原则</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#acl应用实例">ACL应用实例</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#静态nat、动态nat">静态NAT、动态NAT</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#静态nat">静态NAT</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#动态nat">动态NAT</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#静态nat配置">静态NAT配置</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#动态nat配置">动态NAT配置</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#vlan原理和配置">VLAN原理和配置</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#传统以太网">传统以太网</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#vlan技术">VLAN技术</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#链路类型">链路类型</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#vlan帧格式">VLAN帧格式</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#pvid">PVID</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#端口类型–-access">端口类型– Access</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#端口类型–trunk">端口类型–Trunk</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#端口类型-hybrid">端口类型-Hybrid</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#vlan端口类型总结">VLAN端口类型总结</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#vlan划分方法">VLAN划分方法</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#vlan配置">VLAN配置</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content" vp-content><figure><img src="/wsq-blog/assets/1-B4H2Rcpu.png" alt="VRP命令行视图" tabindex="0" loading="lazy"><figcaption>VRP命令行视图</figcaption></figure><figure><img src="/wsq-blog/assets/2-Az5gJU-E.png" alt="命令行在线帮助" tabindex="0" loading="lazy"><figcaption>命令行在线帮助</figcaption></figure><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span>[Huawei]d?</span></span>
<span class="line"><span>  ddns                                    dhcp</span></span>
<span class="line"><span>  dhcpv6                                  diagnose</span></span>
<span class="line"><span>  display                                 dns</span></span>
<span class="line"><span>  domain                                  dot1x</span></span></code></pre></div><table><thead><tr><th style="text-align:center;">命令</th><th style="text-align:center;">功能</th></tr></thead><tbody><tr><td style="text-align:center;">sysname</td><td style="text-align:center;">配置设备名称</td></tr><tr><td style="text-align:center;">clock timezone</td><td style="text-align:center;">设置设备时区</td></tr><tr><td style="text-align:center;">clock datetime</td><td style="text-align:center;">设置当前日期和时间</td></tr><tr><td style="text-align:center;">clock daylight-saving-time</td><td style="text-align:center;">设置采用夏令时制</td></tr><tr><td style="text-align:center;">header login</td><td style="text-align:center;">配置在用户登陆前显示的标题消息</td></tr><tr><td style="text-align:center;">header shell</td><td style="text-align:center;">配置在用户登陆后显示的标题消息</td></tr></tbody></table><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#FF9492;">&lt;</span><span style="color:#F0F3F6;">Huawei</span><span style="color:#FF9492;">&gt;</span><span style="color:#F0F3F6;">system-view </span></span>
<span class="line"><span style="color:#FFB757;">Enter</span><span style="color:#ADDCFF;"> system</span><span style="color:#ADDCFF;"> view,</span><span style="color:#ADDCFF;"> return</span><span style="color:#ADDCFF;"> user</span><span style="color:#ADDCFF;"> view</span><span style="color:#ADDCFF;"> with</span><span style="color:#ADDCFF;"> Ctrl+Z.</span></span>
<span class="line"><span style="color:#F0F3F6;">[Huawei]sysname RTA</span></span>
<span class="line"><span style="color:#F0F3F6;">[RTA]</span></span></code></pre></div><p>系统时钟是设备上的系统时间戳。由于地域的不同，用户可以根据当地规定设置系统时钟。用户必须正确设置系统时钟以确保其与其他设备保持同步。</p><p>设置系统时钟的公式为：UTC+时区偏移量+夏时制时间偏移量。clock datetime命令设置HH:MM:SS YYYY-MM-DD格式的系统时钟。但是需要注意的是，如果没有设定时区，或者时区设定为零，那么设定的日期和时间将被认为是UTC时间，所以建议在对系统时间和日期进行配置前先设置时区。</p><p>clock timezone命令用来对本地时区信息进行设置，具体的命令参数为time-zone-name { add | minus } offset。其中参数add表示与UTC时间相比，time-zone-name增加的时间偏移量。即，在系统默认的UTC时区的基础上，加上offset，就可以得到time-zone-name所标识的时区时间；参数minus指的是与UTC时间相比，time-zone-name减少的时间偏移量。即，在系统默认的UTC时区的基础上，减去offset，就可以得到time-zone-name所标识的时区时间。</p><p>有的地区实行夏令时制，因此当进入夏令时实施区间的一刻，系统时间要根据用户的设定进行夏令时时间的调整。VRP支持夏令时功能。比如，在英国，从三月的最后一个星期天到十月最后一个星期天是夏令时区间，那么可以通过执行命令指定夏令时的开始和结束时间。</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#FF9492;">&lt;</span><span style="color:#F0F3F6;">Huawei</span><span style="color:#FF9492;">&gt;</span><span style="color:#F0F3F6;">clock timezone BJ add 08:00:00</span></span>
<span class="line"><span style="color:#FF9492;">&lt;</span><span style="color:#F0F3F6;">Huawei</span><span style="color:#FF9492;">&gt;</span><span style="color:#F0F3F6;">clock datetime 10:20:29 2013-04-11</span></span>
<span class="line"><span style="color:#FF9492;">&lt;</span><span style="color:#F0F3F6;">Huawei</span><span style="color:#FF9492;">&gt;</span><span style="color:#F0F3F6;">display clock </span></span>
<span class="line"><span style="color:#FFB757;">2013-04-11</span><span style="color:#ADDCFF;"> 10:20:48</span></span>
<span class="line"><span style="color:#FFB757;">Thursday</span></span>
<span class="line"><span style="color:#FFB757;">Time</span><span style="color:#ADDCFF;"> Zone</span><span style="color:#F0F3F6;">(</span><span style="color:#FFB757;">BJ</span><span style="color:#F0F3F6;">) </span><span style="color:#ADDCFF;">:</span><span style="color:#ADDCFF;"> UTC+08:00</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">[Huawei]header login information </span><span style="color:#ADDCFF;">&quot;welcome to huawei certification!&quot;</span></span>
<span class="line"><span style="color:#F0F3F6;">[Huawei]header shell information </span><span style="color:#ADDCFF;">&quot;Please don&#39;t reboot the device!&quot;</span></span>
<span class="line"><span style="color:#FFB757;">……</span></span>
<span class="line"><span style="color:#FFB757;">welcome</span><span style="color:#ADDCFF;"> to</span><span style="color:#ADDCFF;"> huawei</span><span style="color:#ADDCFF;"> certification!</span></span>
<span class="line"><span style="color:#FFB757;">Login</span><span style="color:#ADDCFF;"> authentication</span></span>
<span class="line"><span style="color:#FFB757;">Password:</span></span>
<span class="line"><span style="color:#FFB757;">Please</span><span style="color:#ADDCFF;"> don&#39;t reboot the device!</span></span>
<span class="line"><span style="color:#ADDCFF;">&lt;Huawei&gt;</span></span></code></pre></div><h2 id="命令等级" tabindex="-1"><a class="header-anchor" href="#命令等级"><span>命令等级</span></a></h2><table><thead><tr><th style="text-align:center;">用户等级</th><th style="text-align:center;">命令等级</th><th style="text-align:center;">名称</th></tr></thead><tbody><tr><td style="text-align:center;">0</td><td style="text-align:center;">0</td><td style="text-align:center;">访问级</td></tr><tr><td style="text-align:center;">1</td><td style="text-align:center;">0 and 1</td><td style="text-align:center;">监控级</td></tr><tr><td style="text-align:center;">2</td><td style="text-align:center;">0, 1 and 2</td><td style="text-align:center;">配置级</td></tr><tr><td style="text-align:center;">3-15</td><td style="text-align:center;">0, 1, 2 and 3</td><td style="text-align:center;">管理级</td></tr></tbody></table><p>系统将命令进行分级管理，以增加设备的安全性。设备管理员可以设置用户级别，一定级别的用户可以使用对应级别的命令行。缺省情况下命令级别分为0～3级，用户级别分为0～15级。用户0级为访问级别，对应网络诊断工具命令（ping、tracert）、从本设备出发访问外部设备的命令（Telnet客户端）、部分display命令等。用户1级为监控级别，对应命令级0、1级，包括用于系统维护的命令以及display等命令。用户2级是配置级别，包括向用户提供直接网络服务，包括路由、各个网络层次的命令。用户3-15级是管理级别，对应命令3级，该级别主要是用于系统运行的命令，对业务提供支撑作用，包括文件系统、FTP、TFTP下载、文件交换配置、电源供应控制，备份板控制、用户管理、命令级别设置、系统内部参数设置、以及用于业务故障诊断的debugging命令。本例展示了如何修改命令级别，在用户视图下执行save命令需要3级的权限。</p><p>在具体使用中，如果我们有多个管理员帐号，但只允许某一个管理员保存系统配置，则可以将save命令的级别提高到4级，并定义只有该管理员有4级权限。这样，在不影响其他用户的情况下，可以实现对命令的使用控制。</p><h2 id="用户界面" tabindex="-1"><a class="header-anchor" href="#用户界面"><span>用户界面</span></a></h2><table><thead><tr><th style="text-align:center;">用户界面类型</th><th style="text-align:center;">编号</th></tr></thead><tbody><tr><td style="text-align:center;">Console</td><td style="text-align:center;">0</td></tr><tr><td style="text-align:center;">VTY</td><td style="text-align:center;">0-4</td></tr></tbody></table><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span>&lt;Huawei&gt;system-view</span></span>
<span class="line"><span>[Huawei]user-interface vty 0 4</span></span>
<span class="line"><span>[Huawei-ui-vty0-4]</span></span></code></pre></div><p>VTY 接口最大可配范围为0-14。</p><p>每类用户界面都有对应的用户界面视图。用户界面（User-interface）视图是系统提供的一种命令行视图，用来配置和管理所有工作在异步交互方式下的物理接口和逻辑接口，从而达到统一管理各种用户界面的目的。</p><p>在连接到设备前，用户要设置用户界面参数。系统支持的用户界面包括Console用户界面和VTY用户界面。控制口（Console Port）是一种通信串行端口，由设备的主控板提供。虚拟类型终端（Virtual Type Terminal）是一种虚拟线路端口，用户通过终端与设备建立Telnet或SSH连接后，也就建立了一条VTY，即用户可以通过VTY方式登录设备。</p><p>设备一般最多支持15个用户同时通过VTY方式访问。执行user-interface maximum-vty number 命令可以配置同时登录到设备的VTY类型用户界面的最大个数。如果将最大登录用户数设为0，则任何用户都不能通过Telnet或者SSH登录到路由器。</p><p>display user-interface 命令用来查看用户界面信息。</p><p>不同的设备，或使用不同版本的VRP软件系统，具体可以被使用的VTY接口的最大数量可能不同。</p><h2 id="配置用户界面命令" tabindex="-1"><a class="header-anchor" href="#配置用户界面命令"><span>配置用户界面命令</span></a></h2><table><thead><tr><th style="text-align:center;">命令</th><th style="text-align:center;">功能</th></tr></thead><tbody><tr><td style="text-align:center;">idle-timeout</td><td style="text-align:center;">设置超时时间</td></tr><tr><td style="text-align:center;">screen-length</td><td style="text-align:center;">设置指定终端屏幕的临时显示行数</td></tr><tr><td style="text-align:center;">history-command max-size</td><td style="text-align:center;">设置历史命令缓冲区的大小</td></tr></tbody></table><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span># Set the size of the history command buffer to 20. </span></span>
<span class="line"><span>&lt;Huawei&gt;system-view</span></span>
<span class="line"><span>[Huawei]user-interface console 0</span></span>
<span class="line"><span>[Huawei-ui-console0]history-command max-size 20 </span></span>
<span class="line"><span># Set the timeout duration to 1 minute and 30 seconds.</span></span>
<span class="line"><span>[Huawei-ui-console0]idle-timeout 1 30</span></span></code></pre></div><p>用户可以设置Console界面和VTY界面的属性，以提高系统安全性。如果一个连接上设备的用户一直处于空闲状态而不断开，可能会给系统带来很大风险，所以在等待一个超时时间后，系统会自动中断连接。这个闲置切断时间又称超时时间，默认为10分钟。</p><p>当display命令输出的信息超过一页时，系统会对输出内容进行分页，使用空格键切换下一页。</p><p>如果一页输出的信息过少或过多时，用户可以执行screen-length命令修改信息输出时一页的行数。默认行数为24，最大支持512行。不建议将行数设置为0，因为那样将不会显示任何输出内容了。</p><p>每条命令执行过后，执行的记录都保存在历史命令缓存区。用户可以利用(↑)，(↓) ，CTRL+P，Ctrl+N这些快捷键调用这些命令。历史命令缓存区中默认能存储10条命令，可以通过运行history-command max-size改变可存储的命令数，最多可存储256条。</p><h2 id="配置登陆权限" tabindex="-1"><a class="header-anchor" href="#配置登陆权限"><span>配置登陆权限</span></a></h2><table><thead><tr><th style="text-align:center;">命令</th><th style="text-align:center;">功能</th></tr></thead><tbody><tr><td style="text-align:center;">user privilege</td><td style="text-align:center;">配置指定用户界面下的用户级别</td></tr><tr><td style="text-align:center;">set authentication password</td><td style="text-align:center;">配置本地认证密码</td></tr></tbody></table><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#BDC4CC;"># Set the user level on the VTY0 user interface to 2.</span></span>
<span class="line"><span style="color:#FF9492;">&lt;</span><span style="color:#F0F3F6;">Huawei</span><span style="color:#FF9492;">&gt;</span><span style="color:#F0F3F6;">system-view</span></span>
<span class="line"><span style="color:#F0F3F6;">[Huawei]user-interface vty 0</span></span>
<span class="line"><span style="color:#F0F3F6;">[Huawei-ui-vty0]user privilege level 2 </span></span>
<span class="line"><span style="color:#F0F3F6;">[Huawei-ui-vty0-4]set authentication password cipher huawei</span></span></code></pre></div><p>只使用密码登陆的情况下，登陆权限的密码配置方式。</p><p>如果没有权限限制，未授权的用户就可以使用设备获取信息并更改配置。从设备安全的角度考虑，限制用户的访问和操作权限是很有必要的。用户权限和用户认证是提升终端安全的两种方式。用户权限要求规定用户的级别，一定级别的用户只能执行特定级别的命令。</p><p>配置用户界面的用户认证方式后，用户登录设备时，需要输入密码进行认证，这样就限制了用户访问设备的权限。在通过VTY进行Telnet连接时，所有接入设备的用户都必须要经过认证。</p><p>设备提供三种认证模式，AAA模式、密码认证模式和不认证模式。AAA认证模式具有很高的安全性，因为登录时必须输入用户名和密码。密码认证只需要输入登录密码即可，所以所有的用户使用的都是同一个密码。使用不认证模式就是不需要对用户认证直接登陆到设备。需要注意的是，Console界面默认使用不认证模式。</p><p>对于Telnet登录用户，授权是非常必要的，最好设置用户名、密码和指定和帐号相关联的权限。</p><h2 id="配置接口ip地址" tabindex="-1"><a class="header-anchor" href="#配置接口ip地址"><span>配置接口IP地址</span></a></h2><figure><img src="/wsq-blog/assets/3-BM-05SxB.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span># Configure an IP address 10.0.12.1/24 and an IP address 1.1.1.1/32 for LoopBack0.</span></span>
<span class="line"><span>&lt;Huawei&gt;system-view </span></span>
<span class="line"><span>[Huawei]interface gigabitethernet 0/0/0 </span></span>
<span class="line"><span>[Huawei-GigabitEthernet0/0/0]ip address 10.0.12.1 255.255.255.0</span></span>
<span class="line"><span>[Huawei-GigabitEthernet0/0/0]interface loopback 0</span></span>
<span class="line"><span>[Huawei-LoopBack0]ip address 1.1.1.1 32</span></span></code></pre></div><p>要在接口运行IP服务，必须为接口配置一个IP地址。一个接口一般只需要一个IP地址。在特殊情况下，也有可能为接口配置一个次要IP地址。例如，当路由器AR2200的接口连接到一个物理网络时，该物理网络中的主机属于两个网段。为了让两个网段的主机都可以通过路由器AR2200访问其它网络，可以配置一个主IP地址和一个次要IP地址。一个接口只能有一个主IP地址，如果接口配置了新的主IP地址，那么新的主IP地址就替代了原来的主IP地址。</p><p>用户可以利用<code>ip address &lt;ip-address &gt; { mask | mask-length }</code>命令为接口配置IP地址，这个命令中，mask代表的是 32 比特的子网掩码，如<code>255.255.255.0</code>，mask-length 代表的是可替换的掩码长度值，如 24，这两者可以交换使用。</p><p>Loopback接口是一个逻辑接口，可用来虚拟一个网络或者一个IP主机。在运行多种协议的时候，由于Loopback接口稳定可靠，所以也可以用来做管理接口。</p><p>在给物理接口配置IP地址时，需要关注该接口的物理状态。默认情况下，华为路由器和交换机的接口状态为up；如果该接口曾被手动关闭，则在配置完IP地址后，应使用undo shutdown打开该接口。</p><p>华为网络设备同时只能有一个用户登录Console界面，因此Console用户的编号固定为0。<br> Loopback接口是一种逻辑接口，在未创建之前，Loopback接口并不存在。从创建开始，Loopback接口就一直存在，并一直保持Up状态，除非被手动关闭。</p><table><thead><tr><th style="text-align:center;">命令</th><th style="text-align:center;">功能</th></tr></thead><tbody><tr><td style="text-align:center;">display version</td><td style="text-align:center;">查看路由器基本信息</td></tr><tr><td style="text-align:center;">display interface GigabitEthernet 0/0/0</td><td style="text-align:center;">查看接口状态信息</td></tr><tr><td style="text-align:center;">display ip interface brief</td><td style="text-align:center;">查看全部接口的IP简要信息，含IP地址</td></tr><tr><td style="text-align:center;">display ip routing-table</td><td style="text-align:center;">查看路由表</td></tr><tr><td style="text-align:center;">display current-configuration</td><td style="text-align:center;">查看当前的配置（内存中）</td></tr><tr><td style="text-align:center;">display saved-configuration</td><td style="text-align:center;">查看保存的配置（Flash中）</td></tr><tr><td style="text-align:center;">dir flash</td><td style="text-align:center;">查看Flash中的文件</td></tr><tr><td style="text-align:center;">save</td><td style="text-align:center;">保存配置文件</td></tr><tr><td style="text-align:center;">reboot</td><td style="text-align:center;">重启设备</td></tr></tbody></table><p>路由的来源：</p><ul><li>链路层发现的路由</li><li>静态路由</li><li>动态路由协议发现的路由</li></ul><h2 id="静态路由" tabindex="-1"><a class="header-anchor" href="#静态路由"><span>静态路由</span></a></h2><p>静态路由是由管理员手工配置而生成的路由。</p><table><thead><tr><th style="text-align:center;">命令</th><th style="text-align:center;">视图</th><th style="text-align:center;">作用</th></tr></thead><tbody><tr><td style="text-align:center;"><code>ip route-static ip-address {mask| mask-length} {nexthop-address|interface-type interface-number [nexthop-address]} [preference preference |tag tag]</code></td><td style="text-align:center;">系统</td><td style="text-align:center;">配置单播静态路由</td></tr><tr><td style="text-align:center;"><code>display ip interface [brief] [interface-type interface-number]</code></td><td style="text-align:center;">所有</td><td style="text-align:center;">查看接口与IP相关的配置和统计信息或者简要信息</td></tr><tr><td style="text-align:center;">display ip routing-table</td><td style="text-align:center;">所有</td><td style="text-align:center;">查看路由表</td></tr></tbody></table><h2 id="路由的度量值-metric" tabindex="-1"><a class="header-anchor" href="#路由的度量值-metric"><span>路由的度量值（metric）</span></a></h2><p>路由度量值表示到达这条路由所指定的路径的代价或者开销，也称为路由权值。<br> 路由器A到路由器D有两条路由：<br> Path1： A→B→C→D ，总开销是9<br> Path2： A→E→F→C→D ，总开销是12<br> 路由器优选较小代价值的路由，并加入到路由表中</p><figure><img src="/wsq-blog/assets/4-Bz3pzaSn.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>通常会考虑以下因素作为或者用来计算路由的度量值</p><ul><li>跳数</li><li>链路带宽</li><li>链路延迟</li><li>链路负载</li><li>链路可靠度</li><li>链路MTU</li><li>代价</li></ul><h3 id="路由条目优选进路由表" tabindex="-1"><a class="header-anchor" href="#路由条目优选进路由表"><span>路由条目优选进路由表</span></a></h3><figure><img src="/wsq-blog/assets/5-B1J6I0VG.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="路由的选路规则" tabindex="-1"><a class="header-anchor" href="#路由的选路规则"><span>路由的选路规则</span></a></h2><h3 id="最长匹配原则" tabindex="-1"><a class="header-anchor" href="#最长匹配原则"><span>最长匹配原则</span></a></h3><figure><img src="/wsq-blog/assets/6-JrVsESEK.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>最长匹配举例</p><p>目的地址为9.1.2.1的数据报文，将命中9.1.0.0/16的路由</p><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span>[Quidway] display ip routing-table</span></span>
<span class="line"><span>Routing Tables:</span></span>
<span class="line"><span>Destination/Mask proto   pref  Metric Nexthop     Interface</span></span>
<span class="line"><span>0.0.0.0/0        Static  60    0      120.0.0.2   Serial0/0</span></span>
<span class="line"><span>8.0.0.0/8        RIP     100   3      120.0.0.2   Serial0/1</span></span>
<span class="line"><span>9.0.0.0/8        OSPF    10    50     20.0.0.2    Ethernet0/0</span></span>
<span class="line"><span>9.1.0.0/16       RIP     100   4      120.0.0.2   Serial0/0</span></span>
<span class="line"><span>11.0.0.0/8       Static  60    0      120.0.0.2   Serial0/1</span></span>
<span class="line"><span>20.0.0.0/8       Direct  0     0      20.0.0.1    Ethernet0/2</span></span>
<span class="line"><span>20.0.0.1/32      Direct  0     0      127.0.0.1   LoopBack0</span></span></code></pre></div><h3 id="静态路由的下一跳" tabindex="-1"><a class="header-anchor" href="#静态路由的下一跳"><span>静态路由的下一跳</span></a></h3><p>点对点链路：至少写上出接口；但也可以写上下一跳IP地址。<br> 以太网链路：至少写上下一跳IP地址；也可以写上出接口。</p><p>下一跳IP地址可以不直连，但这样会发生递归。</p><h3 id="缺省路由" tabindex="-1"><a class="header-anchor" href="#缺省路由"><span>缺省路由</span></a></h3><p>当路由表中没有与报文的目的地址匹配的表项时，设备可以选择缺省路由作为报文的转发路径。在路由表中，缺省路由的目的网络地址为0.0.0.0，掩码也为0.0.0.0。在本示例中，RTA使用缺省路由转发到达未知目的地址的报文。缺省静态路由的默认优先级也是60。在路由选择过程中，缺省路由会被最后匹配。</p><figure><img src="/wsq-blog/assets/7-C_bEFzZg.png" alt="缺省路由" tabindex="0" loading="lazy"><figcaption>缺省路由</figcaption></figure><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span>[RTA]ip route-static 0.0.0.0 0.0.0.0 10.0.12.2 </span></span>
<span class="line"><span>[RTA]ip route-static 0.0.0.0 0 10.0.12.2 GigabitEthernet 0/0/0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[RTA]display ip routing-table </span></span>
<span class="line"><span>Route Flags: R - relay, D - download to fib</span></span>
<span class="line"><span>--------------------------------------------------------------</span></span>
<span class="line"><span>Routing Tables: Public  Destinations : 13       Routes : 14       </span></span>
<span class="line"><span>Destination/Mask Proto Pre Cost Flags NextHop Interface</span></span>
<span class="line"><span>……</span></span>
<span class="line"><span> 0.0.0.0/0      Static  60   0  RD   10.0.12.2 GigabitEthernet0/0/0</span></span></code></pre></div><p>缺省路由是目的地址和掩码都为全0的特殊路由。<br> 如果报文的目的地址无法匹配路由表中的任何一项，路由器将选择依照缺省路由来转发报文。</p><p>配置缺省路由后，可以使用<code>display ip routing-table</code>命令来查看该路由的详细信息。在本示例中，目的地址在路由表中没能匹配的所有报文都将通过<code>GigabitEthernet 0/0/0</code>接口转发到下一跳地址10.0.12.2。</p><h3 id="负载分担" tabindex="-1"><a class="header-anchor" href="#负载分担"><span>负载分担</span></a></h3><p>静态路由支持到达同一目的地的等价负载分担。</p><p>当源网络和目的网络之间存在多条链路时，可以通过等价路由来实现流量负载分担。这些等价路由具有相同的目的网络和掩码、优先级和度量值。</p><p>本示例中RTA和RTB之间有两条链路相连，通过使用等价的静态路由来实现流量负载分担。</p><p>在RTB上配置了两条静态路由，它们具有相同的目的IP地址和子网掩码、优先级（都为60）、路由开销（都为0），但下一跳不同。在RTB需要转发数据给RTA时，就会使用这两条等价静态路由将数据进行负载分担。</p><p>在RTA上也应该配置对应的两条等价的静态路由。</p><figure><img src="/wsq-blog/assets/8-B6mXEwfU.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span>[RTB]ip route-static 192.168.1.0 255.255.255.0 10.0.12.1 </span></span>
<span class="line"><span>[RTB]ip route-static 192.168.1.0 255.255.255.0 20.0.12.1 </span></span>
<span class="line"><span></span></span>
<span class="line"><span>[RTB]display ip routing-table </span></span>
<span class="line"><span>Route Flags: R - relay, D - download to fib</span></span>
<span class="line"><span>--------------------------------------------------------------</span></span>
<span class="line"><span>Routing Tables: Public  Destinations : 13       Routes : 14       </span></span>
<span class="line"><span>Destination/Mask  Proto Pre Cost Flags NextHop Interface</span></span>
<span class="line"><span>……</span></span>
<span class="line"><span>192.168.1.0/24	Static 60  0   RD 10.0.12.1 GigabitEthernet 0/0/0</span></span>
<span class="line"><span>        		   	Static 60  0   RD 20.0.12.1 GigabitEthernet 0/0/1</span></span></code></pre></div><p>在配置完静态路由之后，可以使用display ip routing-table命令来验证配置结果。在本示例中，红色高亮部分代表路由表中的静态路由。这两条路由具有相同的目的地址和掩码，并且有相同的优先级和度量值，但是它们的下一跳地址和出接口不同。此时，RTB就可以通过这两条等价路由实现负载分担。</p><h3 id="浮动路由" tabindex="-1"><a class="header-anchor" href="#浮动路由"><span>浮动路由</span></a></h3><p>浮动静态路由在网络中主路由失效的情况下，会加入到路由表并承担数据转发业务。</p><p>在配置多条静态路由时，可以修改静态路由的优先级，使一条静态路由的优先级高于其他静态路由，从而实现静态路由的备份，也叫浮动静态路由。在本示例中，RTB上配置了两条静态路由。正常情况下，这两条静态路由是等价的。通过配置preference 100，使第二条静态路由的优先级要低于第一条（值越大优先级越低）。路由器只把优先级最高的静态路由加入到路由表中。当加入到路由表中静态路由出现故障时，优先级低的静态路由才会加入到路由表并承担数据转发业务。</p><figure><img src="/wsq-blog/assets/8-B6mXEwfU.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span>[RTB]ip route-static 192.168.1.0 255.255.255.0 10.0.12.1 </span></span>
<span class="line"><span>[RTB]ip route-static 192.168.1.0 255.255.255.0 20.0.12.1 preference 100</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[RTB]display ip routing-table </span></span>
<span class="line"><span>Route Flags: R - relay, D - download to fib</span></span>
<span class="line"><span>--------------------------------------------------------------</span></span>
<span class="line"><span>Routing Tables: Public  Destinations : 13       Routes : 14       </span></span>
<span class="line"><span>Destination/Mask Proto Pre Cost Flags NextHop Interface</span></span>
<span class="line"><span>……</span></span>
<span class="line"><span>192.168.1.0/24  Static  60   0  RD  10.0.12.1 GigabitEthernet0/0/0</span></span></code></pre></div><p>在主链路正常情况下，只有主路由会出现在路由表中。</p><p>从display ip routing-table命令的回显信息中可以看出，通过修改静态路由优先级实现了浮动静态路由。正常情况下，路由表中应该显示两条有相同目的地、但不同下一跳和出接口的等价路由。由于修改了优先级，回显中只有一条默认优先级为60的静态路由。另一条静态路由的优先级是100，该路由优先级低，所以不会显示在路由表中。</p><p>在主链路出现故障时，浮动静态路由会被激活并加入到路由表中，承担数据转发业务。</p><p>当主用静态路由出现物理链路故障或者接口故障时，该静态路由不能再提供到达目的地的路径，所以在路由表中会被删除。此时，浮动静态路由会被加入到路由表，以保证报文能够从备份链路成功转发到目的地。在主用静态路由的物理链路恢复正常后，主用静态路由会重新被加入到路由表，并且数据转发业务会从浮动静态路由切换到主用静态路由，而浮动静态路由会在路由表中再次被隐藏。</p><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span>[RTB]interface GigabitEthernet 0/0/0</span></span>
<span class="line"><span>[RTB-GigabitEthernet 0/0/0]shutdown </span></span>
<span class="line"><span>[RTB]display ip routing-table </span></span>
<span class="line"><span>Route Flags: R - relay, D - download to fib</span></span>
<span class="line"><span>--------------------------------------------------------------</span></span>
<span class="line"><span>Routing Tables: Public  Destinations : 13       Routes : 14       </span></span>
<span class="line"><span>Destination/Mask Proto Pre Cost Flags NextHop Interface</span></span>
<span class="line"><span>……</span></span>
<span class="line"><span>192.168.1.0/24 Static  100  0  RD  20.0.12.1 GigabitEthernet 0/0/1</span></span></code></pre></div><h2 id="ipv6" tabindex="-1"><a class="header-anchor" href="#ipv6"><span>IPv6</span></a></h2><h3 id="ipv6基本报头" tabindex="-1"><a class="header-anchor" href="#ipv6基本报头"><span>IPv6基本报头</span></a></h3><p>IPv6报文由IPv6基本报头、IPv6扩展报头以及上层协议数据单元三部分组成。<br> 基本报头中的各字段解释如下：</p><ol><li>Version：版本号，长度为4bit。对于IPv6，该值为6。</li><li>Traffic Class：流类别，长度为8bit，它等同于IPv4报头中的TOS字段，表示IPv6数据报的类或优先级，主要应用于QoS。</li><li>Flow Label：流标签，长度为20bit，它用于区分实时流量。流可以理解为特定应用或进程的来自某一源地址发往一个或多个目的地址的连续单播、组播或任播报文。IPv6中的流标签字段、源地址字段和目的地址字段一起为特定数据流指定了网络中的转发路径。这样，报文在IP网络中传输时会保持原有的顺序，提高了处理效率。随着三网合一的发展趋势，IP网络不仅要求能够传输传统的数据报文，还需要能够传输语音、视频等报文。这种情况下，流标签字段的作用就显得更加重要。</li><li>Payload Length：有效载荷长度，长度为16bit，它是指紧跟IPv6报头的数据报的其它部分。</li><li>Next Header：下一个报头，长度为8bit。该字段定义了紧跟在IPv6报头后面的第一个扩展报头（如果存在）的类型。<br> 跳数限制（Hop Limit），长度为8bit，该字段类似于IPv4报头中的Time to Live字段，它定义了IP数据报所能经过的最大跳数。每经过一个路由器，该数值减去1；当该字段的值为0时，数据报将被丢弃。</li><li>Source Address：源地址，长度为128bit，表示发送方的地址。</li><li>Destination Address：目的地址，长度为128bit，表示接收方的地址。</li></ol><p>与IPv4相比，IPv6报头去除了IHL、Identifier、Flags、Fragment Offset、Header Checksum、 Options、Padding域，只增了流标签域，因此IPv6报文头的处理较IPv4大大简化，提高了处理效率。另外，IPv6为了更好支持各种选项处理，提出了扩展头的概念。</p><figure><img src="/wsq-blog/assets/5-1-B1M9RmPi.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="ipv6扩展报头" tabindex="-1"><a class="header-anchor" href="#ipv6扩展报头"><span>IPv6扩展报头</span></a></h3><figure><img src="/wsq-blog/assets/5-2-B0-CA6pY.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Pv6增加了扩展报头，使得IPv6报头更加简化。一个IPv6报文可以包含0个、1个或多个扩展报头，仅当需要路由器或目的节点做某些特殊处理时，才由发送方添加一个或多个扩展头。IPv6支持多个扩展报头，各扩展报头中都含有一个下一个报头字段，用于指明下一个扩展报头的类型。这些报头必须按照以下顺序出现：<br> IPv6基本报头<br> 逐跳选项扩展报头<br> 目的选项扩展报头<br> 路由扩展报头<br> 分片扩展报头<br> 认证扩展报头<br> 封装安全有效载荷扩展报头<br> 目的选项扩展报头（指那些将被分组报文的最终目的地处理的选项）<br> 上层协议数据报文<br> 除了目的选项扩展报头外，每个扩展报头在一个报文中最多只能出现一次。目的选项扩展报头在一个报文中最多也只能出现两次，一次是在路由扩展报头之前，另一次是在上层协议扩展报头之前。</p><h3 id="ipv6地址格式" tabindex="-1"><a class="header-anchor" href="#ipv6地址格式"><span>IPv6地址格式</span></a></h3><figure><img src="/wsq-blog/assets/5-3-CJDb39j0.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>IPv6地址长度为128比特，用于标识一个或一组接口。IPv6地址通常写作xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx:xxxx，其中xxxx是4个十六进制数，等同于一个16比特二进制数；八组xxxx共同组成了一个128比特的IPv6地址。一个IPv6地址由IPv6地址前缀和接口ID组成，IPv6地址前缀用来标识IPv6网络，接口ID用来标识接口。</p><p>IPv6地址长度为128比特，每16比特划分为一段，每段由4个十六进制数表示，并用冒号隔开。<br> IPv6地址包括网络前缀和接口标识两部分。</p><h3 id="ipv6地址压缩格式" tabindex="-1"><a class="header-anchor" href="#ipv6地址压缩格式"><span>IPv6地址压缩格式</span></a></h3><p>由于IPv6地址长度为128比特，书写时会非常不方便。此外，IPv6地址的巨大地址空间使得地址中往往会包含多个0。为了应对这种情况，IPv6提供了压缩方式来简化地址的书写。压缩规则如下：<br> 每16比特组中的前导0可以省略。<br> 地址中包含的连续两个或多个均为0的组，可以用双冒号“::”来代替。需要注意的是，在一个IPv6地址中只能使用一次双冒号“::”，否则，设备将压缩后的地址恢复成128位时，无法确定每段中0的个数。<br> 本示例展示了如何利用压缩规则对IPv6地址进行简化表示。</p><figure><img src="/wsq-blog/assets/5-4-Bclyi8c0.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>每一组中的前导“0”都可以省略。<br> 地址中包含的连续全为0的组，可以用双冒号“::”来代替。</p><h3 id="ipv6地址分类" tabindex="-1"><a class="header-anchor" href="#ipv6地址分类"><span>IPv6地址分类</span></a></h3><p>目前，IPv6地址空间中还有很多地址尚未分配。这一方面是因为IPv6有着巨大的地址空间，足够在未来很多年使用，另一方面是因为寻址方案还有待发展，同时关于地址类型的适用范围也多有值得商榷的地方。<br> 目前，有一小部分全球单播地址已经由IANA（互联网名称与数字地址分配机构ICANN的一个分支）分配给了用户。单播地址的格式是2000::/3，代表公共IP网络上任意可及的地址。IANA负责将该段地址范围内的地址分配给多个区域互联网注册管理机构（RIR）。RIR负责全球5个区域的地址分配。以下几个地址范围已经分配：2400::/12 (APNIC)、2600::/12 (ARIN)、2800::/12 (LACNIC)、2A00::/12 (RIPE NCC)和2C00::/12 (AfriNIC)，它们使用单一地址前缀标识特定区域中的所有地址。2000::/3地址范围中还为文档示例预留了地址空间，例如2001:0DB8::/32。</p><p>链路本地地址只能在连接到同一本地链路的节点之间使用。可以在自动地址分配、邻居发现和链路上没有路由器的情况下使用链路本地地址。以链路本地地址为源地址或目的地址的IPv6报文不会被路由器转发到其他链路。链路本地地址的前缀是FE80::/10。</p><p>组播地址的前缀是FF00::/8。组播地址范围内的大部分地址都是为特定组播组保留的。跟IPv4一样，IPv6组播地址还支持路由协议。IPv6中没有广播地址。组播地址替代广播地址可以确保报文只发送给特定的组播组而不是IPv6网络中的任意终端。</p><p>IPv6还包括一些特殊地址，比如未指定地址::/128。如果没有给一个接口分配IP地址，该接口的地址则为::/128。需要注意的是，不能将未指定地址跟默认IP地址::/0相混淆。默认IP地址::/0跟IPv4中的默认地址0.0.0.0/0类似。环回地址127.0.0.1在IPv6中被定义为保留地址::1/128。</p><table><thead><tr><th>地址范围</th><th>描述</th></tr></thead><tbody><tr><td>2000::/3</td><td>全球单播地址</td></tr><tr><td>2001:0DB8::/32</td><td>保留地址</td></tr><tr><td>FE80::/10</td><td>链路本地地址</td></tr><tr><td>FF00::/8</td><td>组播地址</td></tr><tr><td>::/128</td><td>未指定地址</td></tr><tr><td>::1/128</td><td>环回地址</td></tr></tbody></table><p>IPv6地址分为单播地址、任播地址、组播地址三种类型。</p><h3 id="ipv6单播地址" tabindex="-1"><a class="header-anchor" href="#ipv6单播地址"><span>IPv6单播地址</span></a></h3><figure><img src="/wsq-blog/assets/5-5-yqmwlGB3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>全球单播地址带有固定前缀，类似于IPv4中的公网地址。</p><figure><img src="/wsq-blog/assets/5-6-DnKP6XBJ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>链路本地单播地址前缀为FE80::/10，类似于IPv4中的私有地址。</p><h3 id="ipv6组播地址" tabindex="-1"><a class="header-anchor" href="#ipv6组播地址"><span>IPv6组播地址</span></a></h3><p>IPv6的组播与IPv4相同，用来标识一组接口，一般这些接口属于不同的节点。一个节点可能属于0到多个组播组。目的地址为组播地址的报文会被该组播地址标识的所有接口接收。<br> 一个IPv6组播地址是由前缀、标志（Flag）字段、范围（Scope）字段以及组播组ID（Group ID）4个部分组成：<br> 前缀：IPv6组播地址的前缀是FF00::/8（1111 1111）。<br> 标志字段（Flag）：长度4bit，目前只使用了最后一个比特（前三位必须置0），当该位值为0时，表示当前的组播地址是由IANA所分配的一个永久分配地址；当该值为1时，表示当前的组播地址是一个临时组播地址（非永久分配地址）。<br> 范围字段（Scope）：长度4bit，用来限制组播数据流在网络中发送的范围。<br> 组播组ID（Group ID）：长度112bit，用以标识组播组。目前，RFC2373并没有将所有的112位都定义成组标识，而是建议仅使用该112位的最低32位作为组播组ID，将剩余的80位都置0，这样，每个组播组ID都可以映射到一个唯一的以太网组播MAC地址（RFC2464）。</p><figure><img src="/wsq-blog/assets/5-7-DrSflUTq.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><table><thead><tr><th>地址范围</th><th>描述</th></tr></thead><tbody><tr><td>FF02::1</td><td>链路本地范围所有节点</td></tr><tr><td>FF02::2</td><td>链路本地范围所有路由器</td></tr></tbody></table><p>所有IPv6组播地址都以FF开始。</p><p>IPv6为需要使用组播发送数据的协议预留了一些组播组。</p><h3 id="ipv6任播地址" tabindex="-1"><a class="header-anchor" href="#ipv6任播地址"><span>IPv6任播地址</span></a></h3><p>任播地址标识一组网络接口（通常属于不同的节点）。目标地址是任播地址的数据包将发送给其中路由意义上最近的一个网络接口。任播过程涉及一个任播报文发起方和一个或多个响应方。任播报文的发起方通常为请求某一服务（DNS查找）的主机或请求返还特定数据（例如，HTTP网页信息）的主机。任播地址与单播地址在格式上无任何差异，唯一的区别是一台设备可以给多台具有相同地址的设备发送报文。<br> 企业网络中运用任播地址有很多优势。其中一个优势是业务冗余。比如，用户可以通过多台使用相同地址的服务器获取同一个服务（例如，HTTP）。这些服务器都是任播报文的响应方。如果不是采用任播地址通信，当其中一台服务器发生故障时，用户需要获取另一台服务器的地址才能重新建立通信。如果采用的是任播地址，当一台服务器发生故障时，任播报文的发起方能够自动与使用相同地址的另一台服务器通信，从而实现业务冗余。<br> 使用多服务器接入还能够提高工作效率。例如，用户（即任播地址的发起方）浏览公司网页时，与相同的单播地址建立一条连接，连接的对端是具有相同任播地址的多个服务器。用户可以从不同的镜像服务器分别下载html文件和图片。用户利用多个服务器的带宽同时下载网页文件，其效率远远高于使用单播地址进行下载。<br><img src="/wsq-blog/assets/5-8-B8ZljLv3.png" alt="" loading="lazy"><br> 播地址用来标识一组网络接口，在给多个主机或者节点提供相同服务时提供冗余和负载分担。</p><h3 id="ipv6无状态地址自动配置" tabindex="-1"><a class="header-anchor" href="#ipv6无状态地址自动配置"><span>IPv6无状态地址自动配置</span></a></h3><p>IPv6支持无状态地址自动配置，无需使用诸如DHCP之类的辅助协议，主机即可获取IPv6前缀并自动生成接口ID。路由器发现功能是IPv6地址自动配置功能的基础，主要通过以下两种报文实现：<br> RA报文：每台路由器为了让二层网络上的主机和其它路由器知道自己的存在，定期以组播方式发送携带网络配置参数的RA报文。RA报文的Type字段值为134。<br> RS报文：主机接入网络后可以主动发送RS报文。RA报文是由路由器定期发送的，但是如果主机希望能够尽快收到RA报文，它可以立刻主动发送RS报文给路由器。网络上的路由器收到该RS报文后会立即向相应的主机单播回应RA报文，告知主机该网段的默认路由器和相关配置参数。RS报文的Type字段值为133。</p><figure><img src="/wsq-blog/assets/5-9-s_f4wmJv.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>网络节点向相连的路由器发送RS，请求地址前缀信息。<br> 路由器通过发送路由器通告RA，回复地址前缀信息。</p><h3 id="eui-64规范" tabindex="-1"><a class="header-anchor" href="#eui-64规范"><span>EUI-64规范</span></a></h3><p>为了通过IPv6网络进行通信，各接口必须获取有效的IPv6地址，以下三种方式可以用来配置IPv6地址的接口ID：网络管理员手动配置；通过系统软件生成；采用扩展唯一标识符（EUI-64）格式生成。就实用性而言，EUI-64格式是IPv6生成接口ID的最常用方式。IEEE EUI-64标准采用接口的MAC地址生成IPv6接口ID。MAC地址只有48位，而接口ID却要求64位。MAC地址的前24位代表厂商ID，后24位代表制造商分配的唯一扩展标识。MAC地址的第七高位是一个U/L位，值为1时表示MAC地址全局唯一，值为0时表示MAC地址本地唯一。在MAC地址向EUI-64格式的转换过程中，在MAC地址的前24位和后24位之间插入了16比特的FFFE，并将U/L位的值从0变成了1，这样就生成了一个64比特的接口ID，且接口ID的值全局唯一。接口ID和接口前缀一起组成接口地址。</p><figure><img src="/wsq-blog/assets/5-10-CxXVMs-C.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>将FFFE插入MAC地址的前24位与后24位之间，并将第7位的0改为1即可生成接口ID。</p><h3 id="ipv6无状态地址dad检查" tabindex="-1"><a class="header-anchor" href="#ipv6无状态地址dad检查"><span>IPv6无状态地址DAD检查</span></a></h3><p>设备在给接口分配IPv6单播地址之前会进行重复地址检测（DAD），确认是否有其它的节点使用了该地址。尤其是在地址自动配置的时候，进行DAD检测是很必要的。一个IPv6单播地址在分配给一个接口之后且通过重复地址检测之前称为试验地址，此时该接口不能使用这个试验地址进行单播通信，但是仍然会加入两个组播组：ALL-nodes组播组和Solicited-node组播组。Solicited-node组播组由单播或任播地址的后24位加上地址前缀FF02:0:0:0:0:1:FF00::/104组成。例如，本示例中配置的试验地址为2000::1，该地址被加入Solicited-node组播组FF02::1:FF00:1。<br> IPv6重复地址检测技术和IPv4中的免费ARP类似：用于地址分配或主机连接网络时检测重复的IPv4主机地址。节点向一个自己将使用的试验地址所在的Solicited-node组播组发送一个以该试验地址为请求的目标地址的邻居请求（NS）报文，如果收到某个其它站点回应的邻居通告（NA）报文，就证明该地址已被网络上使用，节点将不能使用该试验地址进行通信。这种情况下，网络管理员需要手动为该节点分配另外一个地址。</p><figure><img src="/wsq-blog/assets/5-11-DwvXqsHq.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>当为接口配置IPv6地址时，DAD用来在本地链路范围内检测将要使用的IPv6地址是否唯一。</p><h2 id="基本acl介绍" tabindex="-1"><a class="header-anchor" href="#基本acl介绍"><span>基本ACL介绍</span></a></h2><table><thead><tr><th>ACL类型</th><th>编号范围</th><th>规则制订依据</th></tr></thead><tbody><tr><td>基本ACL</td><td>2000～2999</td><td>报文的源IP地址</td></tr><tr><td>高级ACL</td><td>3000～3999</td><td>报文的源IP地址、目的IP地址、报文优先级、IP承载的协议类型及特性等三、四层信息</td></tr><tr><td>二层ACL</td><td>4000～4999</td><td>报文的源MAC地址、目的MAC地址、802.1p优先级、链路层协议类型等二层信息</td></tr><tr><td>用户自定义ACL</td><td>5000～5999</td><td>用户自定义报文的偏移位置和偏移量、从报文中提取出相关内容等信息</td></tr></tbody></table><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#FFB757;">acl</span><span style="color:#F0F3F6;"> [ </span><span style="color:#ADDCFF;">number</span><span style="color:#ADDCFF;"> ]</span><span style="color:#ADDCFF;"> acl-number</span><span style="color:#F0F3F6;"> </span></span>
<span class="line"><span style="color:#FFB757;">rule</span><span style="color:#F0F3F6;"> [ </span><span style="color:#ADDCFF;">rule-id</span><span style="color:#ADDCFF;"> ]</span><span style="color:#ADDCFF;"> {</span><span style="color:#ADDCFF;"> permit</span><span style="color:#FF9492;"> |</span><span style="color:#FFB757;"> deny</span><span style="color:#ADDCFF;"> }</span><span style="color:#F0F3F6;"> [ </span><span style="color:#ADDCFF;">source</span><span style="color:#ADDCFF;"> {</span><span style="color:#ADDCFF;"> sour-address</span><span style="color:#ADDCFF;"> sour-wildcard</span><span style="color:#FF9492;"> |</span><span style="color:#FFB757;"> any</span><span style="color:#ADDCFF;"> }</span><span style="color:#ADDCFF;"> ]</span><span style="color:#F0F3F6;"> [ </span><span style="color:#ADDCFF;">time-range</span><span style="color:#ADDCFF;"> time-name</span><span style="color:#ADDCFF;"> ]</span><span style="color:#91CBFF;">  ----基本ACL</span></span>
<span class="line"><span style="color:#FFB757;">rule</span><span style="color:#F0F3F6;"> [ </span><span style="color:#ADDCFF;">rule-id</span><span style="color:#ADDCFF;"> ]</span><span style="color:#ADDCFF;"> {</span><span style="color:#ADDCFF;"> permit</span><span style="color:#FF9492;"> |</span><span style="color:#FFB757;"> deny</span><span style="color:#ADDCFF;"> }</span><span style="color:#ADDCFF;"> protocol</span><span style="color:#F0F3F6;"> [ </span><span style="color:#ADDCFF;">source</span><span style="color:#ADDCFF;"> {</span><span style="color:#ADDCFF;"> sour-address</span><span style="color:#ADDCFF;"> sour-wildcard</span><span style="color:#FF9492;"> |</span><span style="color:#FFB757;"> any</span><span style="color:#ADDCFF;"> }</span><span style="color:#ADDCFF;"> ]</span><span style="color:#F0F3F6;"> [ </span><span style="color:#ADDCFF;">destination</span><span style="color:#ADDCFF;"> {</span><span style="color:#ADDCFF;"> dest-address</span><span style="color:#ADDCFF;"> dest-mask</span><span style="color:#FF9492;"> |</span><span style="color:#FFB757;"> any</span><span style="color:#ADDCFF;"> }</span><span style="color:#ADDCFF;"> ]</span><span style="color:#F0F3F6;"> [ </span><span style="color:#ADDCFF;">source-port</span><span style="color:#ADDCFF;"> operator</span><span style="color:#ADDCFF;"> port1</span><span style="color:#F0F3F6;"> [ </span><span style="color:#ADDCFF;">port2</span><span style="color:#ADDCFF;"> ]</span><span style="color:#ADDCFF;"> ]</span><span style="color:#F0F3F6;"> [ </span><span style="color:#ADDCFF;">destination-port</span><span style="color:#ADDCFF;"> operator</span><span style="color:#ADDCFF;"> port1</span><span style="color:#F0F3F6;"> [ </span><span style="color:#ADDCFF;">port2</span><span style="color:#ADDCFF;"> ]</span><span style="color:#ADDCFF;"> ]</span><span style="color:#F0F3F6;"> [ </span><span style="color:#ADDCFF;">icmp-type</span><span style="color:#ADDCFF;"> {</span><span style="color:#ADDCFF;"> icmp-type</span><span style="color:#ADDCFF;"> icmp-code</span><span style="color:#FF9492;"> |</span><span style="color:#FFB757;"> icmp-message</span><span style="color:#ADDCFF;"> }</span><span style="color:#ADDCFF;"> ]</span><span style="color:#F0F3F6;"> [ </span><span style="color:#ADDCFF;">precedence</span><span style="color:#ADDCFF;"> precedence</span><span style="color:#ADDCFF;"> ]</span><span style="color:#F0F3F6;"> [ </span><span style="color:#ADDCFF;">tos</span><span style="color:#ADDCFF;"> tos</span><span style="color:#ADDCFF;"> ]</span><span style="color:#F0F3F6;"> [ </span><span style="color:#ADDCFF;">time-range</span><span style="color:#ADDCFF;"> time-name</span><span style="color:#ADDCFF;"> ]</span></span></code></pre></div><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#FFB757;">rule</span><span style="color:#91CBFF;"> 5</span><span style="color:#ADDCFF;"> permit</span><span style="color:#ADDCFF;"> source</span><span style="color:#91CBFF;"> 192.168.1.1</span><span style="color:#91CBFF;"> 0.0.0.0</span></span>
<span class="line"><span style="color:#FFB757;">rule</span><span style="color:#91CBFF;"> 10</span><span style="color:#ADDCFF;"> deny</span><span style="color:#ADDCFF;"> source</span><span style="color:#91CBFF;"> 192.168.1.0</span><span style="color:#91CBFF;"> 0.0.0.255</span></span></code></pre></div><h3 id="acl的匹配顺序" tabindex="-1"><a class="header-anchor" href="#acl的匹配顺序"><span>ACL的匹配顺序</span></a></h3><p>ACL是多条规则的集合，在将一个数据包和访问控制列表的规则进行匹配的时候，由规则的匹配顺序决定规则的优先级。<br> 华为设备支持两种匹配顺序：<br> 配置顺序按照用户配置ACL规则的先后进行匹配，先配置的规则先匹配。此为缺省配置。<br> 自动排序（auto）使用“深度优先”的原则进行匹配。“深度优先”根据ACL规则的精确度排序，如果匹配条件（如协议类型、源和目的IP地址范围等）限制越严格，规则就越先匹配。</p><h3 id="基本ipv4-acl的-深度优先-原则" tabindex="-1"><a class="header-anchor" href="#基本ipv4-acl的-深度优先-原则"><span>基本IPv4 ACL的“深度优先”原则</span></a></h3><p>基本IPv4 ACL的“深度优先”顺序判断原则如下：<br> 1、规则中是否带VPN实例，带VPN实例的规则优先。<br> 2、比较源IP地址范围，源IP地址范围小（即通配符掩码中“0” 位的数量多）的规则优先。<br> 3、先配置的规则优先。</p><h3 id="配置acl" tabindex="-1"><a class="header-anchor" href="#配置acl"><span>配置ACL</span></a></h3><p>实际上就是告诉路由器允许或者拒绝某些数据包<br> ACL中的三大难点：</p><ul><li>通配符（WildCard）</li><li>语句的顺序(sequence of statement)</li><li>方向(direction)</li></ul><p>基本ACL基础</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#BDC4CC;">#允许来自10.1.1.1主机的IP数据包通过</span></span>
<span class="line"><span style="color:#FFB757;">rule</span><span style="color:#91CBFF;"> 10</span><span style="color:#ADDCFF;"> permit</span><span style="color:#ADDCFF;"> source</span><span style="color:#91CBFF;"> 10.1.1.1</span><span style="color:#91CBFF;"> 0.0.0.0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BDC4CC;">#拒绝自10.1.1.2主机的IP数据包通过</span></span>
<span class="line"><span style="color:#FFB757;">rule</span><span style="color:#91CBFF;"> 10</span><span style="color:#ADDCFF;"> deny</span><span style="color:#ADDCFF;"> source</span><span style="color:#91CBFF;"> 10.1.1.2</span><span style="color:#91CBFF;"> 0.0.0.0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BDC4CC;"># 允许来自IP地址为10.×.×.×（即IP地址的第一个字节为10）的主机的数据包通过。</span></span>
<span class="line"><span style="color:#FFB757;">rule</span><span style="color:#91CBFF;"> 10</span><span style="color:#ADDCFF;">  permit</span><span style="color:#ADDCFF;">  source</span><span style="color:#91CBFF;"> 10.0.0.0</span><span style="color:#91CBFF;">    0.255.255.255</span></span></code></pre></div><h3 id="通配符掩码-wildcard-mask" tabindex="-1"><a class="header-anchor" href="#通配符掩码-wildcard-mask"><span>通配符掩码 （WildCard Mask）</span></a></h3><p>是一个32比特位的数字字符串<br> 0表示“检查相应的位，并且值要相同”<br> 1表示“不检查（忽略）相应的位”</p><figure><img src="/wsq-blog/assets/6-1-Dp0YxQ-T.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#BDC4CC;"># 允许来自10.0.0.0/255.255.255.0的IP数据包通过</span></span>
<span class="line"><span style="color:#FFB757;">rule</span><span style="color:#91CBFF;"> 5</span><span style="color:#ADDCFF;"> permit</span><span style="color:#ADDCFF;"> source</span><span style="color:#91CBFF;"> 10.0.0.0</span><span style="color:#91CBFF;"> 0.0.0.255</span></span>
<span class="line"><span style="color:#BDC4CC;"># 拒绝来自10.1.0.0/255.255.0.0的IP数据包通过</span></span>
<span class="line"><span style="color:#FFB757;">rule</span><span style="color:#91CBFF;"> 5</span><span style="color:#ADDCFF;"> deny</span><span style="color:#ADDCFF;"> source</span><span style="color:#91CBFF;"> 10.1.0.0</span><span style="color:#91CBFF;"> 0.0.255.255</span></span>
<span class="line"><span style="color:#BDC4CC;"># 允许来自10.128.0.0/255.224.0.0的IP数据包通过</span></span>
<span class="line"><span style="color:#FFB757;">rule</span><span style="color:#91CBFF;"> 5</span><span style="color:#ADDCFF;"> permit</span><span style="color:#ADDCFF;"> source</span><span style="color:#91CBFF;"> 10.128.0.0</span><span style="color:#91CBFF;"> 0.31.255.255</span></span></code></pre></div><p>注意：看起来像是掩码反过来，但不是掩码！</p><p>特殊的通配符掩码</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#FFB757;">permit</span><span style="color:#ADDCFF;"> source</span><span style="color:#ADDCFF;"> any</span></span>
<span class="line"><span style="color:#ADDCFF;">=</span><span style="color:#ADDCFF;"> permit</span><span style="color:#ADDCFF;"> source</span><span style="color:#91CBFF;"> 0.0.0.0</span><span style="color:#91CBFF;">   255.255.255.255</span></span>
<span class="line"><span style="color:#ADDCFF;">=</span><span style="color:#ADDCFF;"> permit</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFB757;">permit</span><span style="color:#ADDCFF;"> source</span><span style="color:#91CBFF;"> 172.30.16.29</span><span style="color:#91CBFF;"> 0</span><span style="color:#ADDCFF;">  某一具体主机</span></span>
<span class="line"><span style="color:#ADDCFF;">=</span><span style="color:#ADDCFF;"> permit</span><span style="color:#ADDCFF;">  source</span><span style="color:#91CBFF;"> 172.30.16.29</span><span style="color:#91CBFF;"> 0.0.0.0</span></span></code></pre></div><p>ACL匹配顺序之一：按照用户配置ACL规则的先后进行匹配</p><p>ACL条件比较顺序（有多个语句）<br> 根据ACL中语句的顺序，把数据包和判断条件进行比较。一旦匹配，就采用语句中的动作并结束比较过程，不再检查以后的其他条件判断语句。如果没有任何语句匹配，数据包被放行。</p><p>未命中规则：不同模块处理不一样。如果是转发模块，则转发数据包；如果是telnet模块，则不允许;如果是路由过滤，不允许路由通过。</p><h3 id="基本acl应用" tabindex="-1"><a class="header-anchor" href="#基本acl应用"><span>基本ACL应用</span></a></h3><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#FFB757;">interface</span><span style="color:#ADDCFF;"> GigabitEthernet0/0/1</span></span>
<span class="line"><span style="color:#FFB757;">traffic-filter</span><span style="color:#ADDCFF;"> outbound</span><span style="color:#ADDCFF;"> acl</span><span style="color:#91CBFF;"> 2000</span></span></code></pre></div><h3 id="什么是in-什么是out" tabindex="-1"><a class="header-anchor" href="#什么是in-什么是out"><span>什么是IN，什么是OUT</span></a></h3><figure><img src="/wsq-blog/assets/6-2-NrbWuvGW.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>数据包从PC到Server，是从E0口IN，而从E1口OUT。<br> IN和OUT是站在Router的角度来看的。</p><h3 id="命名acl" tabindex="-1"><a class="header-anchor" href="#命名acl"><span>命名acl</span></a></h3><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#FFB757;">acl</span><span style="color:#ADDCFF;"> name</span><span style="color:#ADDCFF;"> test</span><span style="color:#ADDCFF;"> basic</span><span style="color:#F0F3F6;"> </span></span>
<span class="line"><span style="color:#FFB757;">rule</span><span style="color:#91CBFF;"> 5</span><span style="color:#ADDCFF;"> deny</span><span style="color:#ADDCFF;">  source</span><span style="color:#91CBFF;"> 10.1.1.1</span><span style="color:#91CBFF;"> 0.0.0.0</span></span>
<span class="line"><span style="color:#FFB757;">rule</span><span style="color:#91CBFF;"> 10</span><span style="color:#ADDCFF;">  permit</span><span style="color:#ADDCFF;">  source</span><span style="color:#91CBFF;"> 10.1.1.0</span><span style="color:#91CBFF;">  0.0.0.255</span></span>
<span class="line"><span style="color:#FFB757;">rule</span><span style="color:#91CBFF;"> 15</span><span style="color:#ADDCFF;"> deny</span><span style="color:#ADDCFF;">  source</span><span style="color:#91CBFF;"> 10.1.0.0</span><span style="color:#91CBFF;">  0.0.255.255</span></span>
<span class="line"><span style="color:#FFB757;">rule</span><span style="color:#91CBFF;"> 20</span><span style="color:#ADDCFF;">  permit</span><span style="color:#ADDCFF;">  source</span><span style="color:#91CBFF;"> 10.0.0.0</span><span style="color:#91CBFF;">  0.255.255.255</span></span></code></pre></div><h3 id="time-range" tabindex="-1"><a class="header-anchor" href="#time-range"><span>time-range</span></a></h3><p>第一种模式——相对时间段：以星期为参数来定义时间范围。<br> 格式为：<code>time-range time-name start-time to end-time { days } &amp;&lt;1-7&gt;</code><br> time-name：时间段名称，以英文字母开头的字符串。<br> start-time to end-time：开始时间和结束时间。格式为<code>[小时:分钟]</code> to <code>[小时:分钟]</code>。<br> days：有多种表达方式：<br> Mon、Tue、Wed、Thu、Fri、Sat、Sun中的一个或者几个的组合，也可以用数字表达，0表示星期日，1表示星期一，……6表示星期六。<br> working-day：从星期一到星期五，五天。<br> daily：包括一周七天。<br> off-day：包括星期六和星期日，两天。</p><p>第二种模式——绝对时间段：从某年某月某日的某一时间开始，到某年某月某日的某一时间结束。<br> 格式为：<code>time-range time-name from time1 date1 [ to time2 date2 ]</code><br> time：格式为 <code>[小时:分钟]</code>。<br> date：格式为<code>[YYYY/MM/DD]</code>,表示年/月/日。</p><h3 id="基本ipv4-acl的-深度优先-原则-1" tabindex="-1"><a class="header-anchor" href="#基本ipv4-acl的-深度优先-原则-1"><span>基本IPv4 ACL的“深度优先”原则</span></a></h3><p>基本IPv4 ACL的“深度优先”顺序判断原则如下：<br> 1、规则中是否带VPN实例，带VPN实例的规则优先。<br> 2、比较源IP地址范围，源IP地址范围小（即通配符掩码中“0” 位的数量多）的规则优先。<br> 3、先配置的规则优先。</p><h3 id="acl应用实例" tabindex="-1"><a class="header-anchor" href="#acl应用实例"><span>ACL应用实例</span></a></h3><figure><img src="/wsq-blog/assets/6-3-Cf5PByzc.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">[Eudemon] acl number 3101</span></span>
<span class="line"><span style="color:#F0F3F6;">[Eudemon-acl-adv-3101] rule permit ip source 129.38.1.4 0</span></span>
<span class="line"><span style="color:#F0F3F6;">[Eudemon-acl-adv-3101] rule permit ip source 129.38.1.1 0</span></span>
<span class="line"><span style="color:#F0F3F6;">[Eudemon-acl-adv-3101] rule permit ip source 129.38.1.2 0</span></span>
<span class="line"><span style="color:#F0F3F6;">[Eudemon-acl-adv-3101] rule permit ip source 129.38.1.3 0</span></span>
<span class="line"><span style="color:#F0F3F6;">[Eudemon-acl-adv-3101] rule deny ip</span></span>
<span class="line"><span style="color:#F0F3F6;">[Eudemon-acl-adv-3101] quit</span></span>
<span class="line"><span style="color:#F0F3F6;">[Eudemon] acl number 3102</span></span>
<span class="line"><span style="color:#F0F3F6;">[Eudemon-acl-adv-3102] rule permit tcp source 202.39.2.3 0 destination 129.38.1.1 0</span></span>
<span class="line"><span style="color:#F0F3F6;">[Eudemon-acl-adv-3102] rule permit tcp source 202.39.2.3 0 destination 129.38.1.2 0</span></span>
<span class="line"><span style="color:#F0F3F6;">[Eudemon-acl-adv-3102] rule permit tcp source 202.39.2.3 0 destination 129.38.1.3 0</span></span>
<span class="line"><span style="color:#F0F3F6;">[Eudemon-Interzone-trust-untrust] packet-filter 3101 outbound</span></span>
<span class="line"><span style="color:#F0F3F6;">[Eudemon-Interzone-trust-untrust] packet-filter 3102 inbound</span></span></code></pre></div><h2 id="静态nat、动态nat" tabindex="-1"><a class="header-anchor" href="#静态nat、动态nat"><span>静态NAT、动态NAT</span></a></h2><h3 id="静态nat" tabindex="-1"><a class="header-anchor" href="#静态nat"><span>静态NAT</span></a></h3><p>NAT的实现方式有多种，适用于不同的场景。<br> 静态NAT实现了私有地址和公有地址的一对一映射。如果希望一台主机优先使用某个关联地址，或者想要外部网络使用一个指定的公网地址访问内部服务器时，可以使用静态NAT。但是在大型网络中，这种一对一的IP地址映射无法缓解公用地址短缺的问题。<br> 在本示例中，源地址为192.168.1.1的报文需要发往公网地址100.1.1.1。在网关RTA上配置了一个私网地址192.168.1.1到公网地址200.10.10.1的映射。当网关收到主机A发送的数据包后，会先将报文中的源地址192.168.1.1转换为200.10.10.1，然后转发报文到目的设备。目的设备回复的报文目的地址是200.10.10.1。当网关收到回复报文后，也会执行静态地址转换，将200.10.10.1转换成192.168.1.1，然后转发报文到主机A。和主机A在同一个网络中其他主机，如主机B，访问公网的过程也需要网关RTA做静态NAT转换。</p><p><img src="/wsq-blog/assets/7-1-BGxgdSxJ.png" alt="" loading="lazy"><br> 静态NAT实现了私有地址和公有地址的一对一映射。<br> 一个公网IP只会分配给唯一且固定的内网主机。</p><h3 id="动态nat" tabindex="-1"><a class="header-anchor" href="#动态nat"><span>动态NAT</span></a></h3><p>动态NAT通过使用地址池来实现。<br> 本示例中，当内部主机A和主机B需要与公网中的目的主机通信时，网关RTA会从配置的公网地址池中选择一个未使用的公网地址与之做映射。每台主机都会分配到地址池中的一个唯一地址。当不需要此连接时，对应的地址映射将会被删除，公网地址也会被恢复到地址池中待用。当网关收到回复报文后，会根据之前的映射再次进行转换之后转发给对应主机。<br> 动态NAT地址池中的地址用尽以后，只能等待被占用的公用IP被释放后，其他主机才能使用它来访问公网。<br><img src="/wsq-blog/assets/7-2-IUx_W91c.png" alt="" loading="lazy"></p><p>动态NAT基于地址池来实现私有地址和公有地址的转换。</p><h3 id="静态nat配置" tabindex="-1"><a class="header-anchor" href="#静态nat配置"><span>静态NAT配置</span></a></h3><p><code>nat static global { global-address} inside {host-address }</code> 命令用于创建静态NAT。<br> global参数用于配置外部公网地址。<br> inside参数用于配置内部私有地址。</p><figure><img src="/wsq-blog/assets/7-3-CMRHZMmp.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">[RTA]interface GigabitEthernet0/0/1</span></span>
<span class="line"><span style="color:#F0F3F6;">[RTA-GigabitEthernet0/0/1]ip address 192.168.1.254 24</span></span>
<span class="line"><span style="color:#F0F3F6;">[RTA-GigabitEthernet0/0/1]interface Serial1/0/0</span></span>
<span class="line"><span style="color:#F0F3F6;">[RTA-Serial1/0/0]ip address 200.10.10.2 24</span></span>
<span class="line"><span style="color:#F0F3F6;">[RTA-Serial1/0/0]nat static global 202.10.10.1 inside 192.168.1.1</span></span>
<span class="line"><span style="color:#F0F3F6;">[RTA-Serial1/0/0]nat static global 202.10.10.2 inside 192.168.1.2</span></span>
<span class="line"><span style="color:#F0F3F6;">[RTA]display nat static </span></span>
<span class="line"><span style="color:#FFB757;">  Static</span><span style="color:#ADDCFF;"> Nat</span><span style="color:#ADDCFF;"> Information:</span></span>
<span class="line"><span style="color:#FFB757;">  Interface</span><span style="color:#ADDCFF;">  :</span><span style="color:#ADDCFF;"> Serial1/0/0</span></span>
<span class="line"><span style="color:#FFB757;">    Global</span><span style="color:#ADDCFF;"> IP/Port</span><span style="color:#ADDCFF;">     :</span><span style="color:#ADDCFF;"> 202.10.10.1/----</span><span style="color:#F0F3F6;"> </span></span>
<span class="line"><span style="color:#FFB757;">    Inside</span><span style="color:#ADDCFF;"> IP/Port</span><span style="color:#ADDCFF;">     :</span><span style="color:#ADDCFF;"> 192.168.1.1/----</span></span>
<span class="line"><span style="color:#FFB757;">……</span></span>
<span class="line"><span style="color:#FFB757;"> Global</span><span style="color:#ADDCFF;"> IP/Port</span><span style="color:#ADDCFF;">     :</span><span style="color:#ADDCFF;"> 202.10.10.2/----</span><span style="color:#F0F3F6;"> </span></span>
<span class="line"><span style="color:#FFB757;">    Inside</span><span style="color:#ADDCFF;"> IP/Port</span><span style="color:#ADDCFF;">     :</span><span style="color:#ADDCFF;"> 192.168.1.2/----</span></span>
<span class="line"><span style="color:#FFB757;">……</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFB757;">  Total</span><span style="color:#ADDCFF;"> :</span><span style="color:#91CBFF;">    2</span></span></code></pre></div><p>命令display nat static用于查看静态NAT的配置。<br> Global IP/Port表示公网地址和服务端口号。<br> Inside IP/Port表示私有地址和服务端口号。</p><h3 id="动态nat配置" tabindex="-1"><a class="header-anchor" href="#动态nat配置"><span>动态NAT配置</span></a></h3><p>nat outbound命令用来将一个访问控制列表ACL和一个地址池关联起来，表示ACL中规定的地址可以使用地址池进行地址转换。ACL用于指定一个规则，用来过滤特定流量。后续将会介绍有关ACL的详细信息。<br> nat address-group命令用来配置NAT地址池。<br> 本示例中使用nat outbound命令将ACL 2000与待转换的192.168.1.0/24网段的流量关联起来，并使用地址池1（address-group 1）中的地址进行地址转换。no-pat表示只转换数据报文的地址而不转换端口信息。</p><figure><img src="/wsq-blog/assets/7-4-NKo-_zk1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">[RTA]nat address-group 1 200.10.10.1 200.10.10.200 </span></span>
<span class="line"><span style="color:#F0F3F6;">[RTA]acl 2000</span></span>
<span class="line"><span style="color:#F0F3F6;">[RTA-acl-basic-2000]rule 5 permit source 192.168.1.0 0.0.0.255</span></span>
<span class="line"><span style="color:#F0F3F6;">[RTA-acl-basic-2000]quit</span></span>
<span class="line"><span style="color:#F0F3F6;">[RTA]interface serial1/0/0</span></span>
<span class="line"><span style="color:#F0F3F6;">[RTA-Serial1/0/0]nat outbound 2000 address-group 1 no-pat</span></span>
<span class="line"><span style="color:#F0F3F6;">[RTA]display nat address-group 1</span></span>
<span class="line"><span style="color:#FFB757;"> NAT</span><span style="color:#ADDCFF;"> Address-Group</span><span style="color:#ADDCFF;"> Information:</span></span>
<span class="line"><span style="color:#FFB757;"> --------------------------------------</span></span>
<span class="line"><span style="color:#FFB757;"> Index</span><span style="color:#ADDCFF;">   Start-address</span><span style="color:#ADDCFF;">      End-address</span></span>
<span class="line"><span style="color:#FFB757;"> 1</span><span style="color:#91CBFF;">       200.10.10.1</span><span style="color:#91CBFF;">        200.10.10.200</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F0F3F6;">[RTA]display nat outbound </span></span>
<span class="line"><span style="color:#FFB757;"> NAT</span><span style="color:#ADDCFF;"> Outbound</span><span style="color:#ADDCFF;"> Information:</span></span>
<span class="line"><span style="color:#FFB757;"> ----------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFB757;"> Interface</span><span style="color:#ADDCFF;">          Acl</span><span style="color:#ADDCFF;">     Address-group/IP/Interface</span><span style="color:#ADDCFF;">      Type</span></span>
<span class="line"><span style="color:#FFB757;"> ----------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFB757;"> Serial1/0/0</span><span style="color:#91CBFF;">       2000</span><span style="color:#91CBFF;">                        1</span><span style="color:#ADDCFF;">         no-pat</span></span>
<span class="line"><span style="color:#FFB757;"> ----------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFB757;">  Total</span><span style="color:#ADDCFF;"> :</span><span style="color:#91CBFF;"> 1</span></span></code></pre></div><p>display nat address-group group-index命令用来查看NAT地址池配置信息。<br> 命令display nat outbound用来查看动态NAT配置信息。<br> 可以用这两条命令验证动态NAT的详细配置。在本示例中，指定接口Serial 1/0/0与ACL关联在一起，并定义了用于地址转换的地址池1。参数no-pat说明没有进行端口地址转换。</p><h2 id="vlan原理和配置" tabindex="-1"><a class="header-anchor" href="#vlan原理和配置"><span>VLAN原理和配置</span></a></h2><p>VLAN（Virtual Local Area Network）即虚拟局域网，是将一个物理的局域网在逻辑上划分成多个广播域的技术。通过在交换机上配置VLAN，可以实现在同一个VLAN内的用户可以进行二层互访，而不同VLAN间的用户被二层隔离。这样既能够隔离广播域，又能够提升网络的安全性。</p><h3 id="传统以太网" tabindex="-1"><a class="header-anchor" href="#传统以太网"><span>传统以太网</span></a></h3><p>早期的局域网LAN技术是基于总线型结构的，它存在以下主要问题：<br> 若某时刻有多个节点同时试图发送消息，那么它们将产生冲突。<br> 从任意节点发出的消息都会被发送到其他节点，形成广播。<br> 所有主机共享一条传输通道，无法控制网络中的信息安全。<br> 这种网络构成了一个冲突域，网络中计算机数量越多，冲突越严重，网络效率越低。同时，该网络也是一个广播域，当网络中发送信息的计算机数量越多时，广播流量将会耗费大量带宽。<br> 因此，传统局域网不仅面临冲突域太大和广播域太大两大难题，而且无法保障传输信息的安全。<br> 为了扩展传统LAN，以接入更多计算机，同时避免冲突的恶化，出现了网桥和二层交换机，它们能有效隔离冲突域。网桥和交换机采用交换方式将来自入端口的信息转发到出端口上，克服了共享网络中的冲突问题。但是，采用交换机进行组网时，广播域和信息安全问题依旧存在。<br> 为限制广播域的范围，减少广播流量，需要在没有二层互访需求的主机之间进行隔离。路由器是基于三层IP地址信息来选择路由和转发数据的，其连接两个网段时可以有效抑制广播报文的转发，但成本较高。因此，人们设想在物理局域网上构建多个逻辑局域网，即VLAN。</p><h3 id="vlan技术" tabindex="-1"><a class="header-anchor" href="#vlan技术"><span>VLAN技术</span></a></h3><p>VLAN技术可以将一个物理局域网在逻辑上划分成多个广播域，也就是多个VLAN。VLAN技术部署在数据链路层，用于隔离二层流量。同一个VLAN内的主机共享同一个广播域，它们之间可以直接进行二层通信。而VLAN间的主机属于不同的广播域，不能直接实现二层互通。这样，广播报文就被限制在各个相应的VLAN内，同时也提高了网络安全性。<br> 本例中，原本属于同一广播域的主机被划分到了两个VLAN中，即，VLAN1和VLAN2。VLAN内部的主机可以直接在二层互相通信，VLAN1和VLAN2之间的主机无法直接实现二层通信。</p><h3 id="链路类型" tabindex="-1"><a class="header-anchor" href="#链路类型"><span>链路类型</span></a></h3><p>VLAN链路分为两种类型：Access链路和Trunk链路。<br> 接入链路（Access Link）：连接用户主机和交换机的链路称为接入链路。如本例所示，图中主机和交换机之间的链路都是接入链路。<br> 干道链路（Trunk Link）：连接交换机和交换机的链路称为干道链路。如本例所示，图中交换机之间的链路都是干道链路。干道链路上通过的帧一般为带Tag的VLAN帧。</p><figure><img src="/wsq-blog/assets/8-1-22Qf40la.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>用户主机和交换机之间的链路为接入链路，交换机与交换机之间的链路为干道链路。</p><h3 id="vlan帧格式" tabindex="-1"><a class="header-anchor" href="#vlan帧格式"><span>VLAN帧格式</span></a></h3><p>VLAN标签长4个字节，直接添加在以太网帧头中，IEEE802.1Q文档对VLAN标签作出了说明。<br> TPID：Tag Protocol Identifier，2字节，固定取值，0x8100，是IEEE定义的新类型，表明这是一个携带802.1Q标签的帧。如果不支持802.1Q的设备收到这样的帧，会将其丢弃。<br> TCI：Tag Control Information，2字节。帧的控制信息，详细说明如下：</p><ul><li>Priority：3比特，表示帧的优先级，取值范围为0～7，值越大优先级越高。当交换机阻塞时，优先发送优先级高的数据帧。</li><li>CFI：Canonical Format Indicator，1比特。CFI表示MAC地址是否是经典格式。CFI为0说明是经典格式，CFI为1表示为非经典格式。用于区分以太网帧、FDDI（Fiber Distributed Digital Interface）帧和令牌环网帧。在以太网中，CFI的值为0。</li><li>VLAN Identifier：VLAN ID，12比特，在X7系列交换机中，可配置的VLAN ID取值范围为0～4095，但是0和4095在协议中规定为保留的VLAN ID，不能给用户使用。</li></ul><p>在现有的交换网络环境中，以太网的帧有两种格式：没有加上VLAN标记的标准以太网帧（untagged frame）；有VLAN标记的以太网帧（tagged frame）。</p><figure><img src="/wsq-blog/assets/8-2-h1rdCwGy.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>通过Tag区分不同VLAN。</p><h3 id="pvid" tabindex="-1"><a class="header-anchor" href="#pvid"><span>PVID</span></a></h3><p>PVID即Port VLAN ID，代表端口的缺省VLAN。交换机从对端设备收到的帧有可能是Untagged的数据帧，但所有以太网帧在交换机中都是以Tagged的形式来被处理和转发的，因此交换机必须给端口收到的Untagged数据帧添加上Tag。为了实现此目的，必须为交换机配置端口的缺省VLAN。当该端口收到Untagged数据帧时，交换机将给它加上该缺省VLAN的VLAN Tag。</p><figure><img src="/wsq-blog/assets/8-3-805uvuPO.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>PVID表示端口在缺省情况下所属的VLAN。<br> 缺省情况下，X7系列交换机每个端口的PVID是1。</p><h3 id="端口类型–-access" tabindex="-1"><a class="header-anchor" href="#端口类型–-access"><span>端口类型– Access</span></a></h3><p>Access端口是交换机上用来连接用户主机的端口，它只能连接接入链路，并且只能允许唯一的VLAN ID通过本端口。</p><p>Access端口收发数据帧的规则如下：<br> 如果该端口收到对端设备发送的帧是untagged（不带VLAN标签），交换机将强制加上该端口的PVID。如果该端口收到对端设备发送的帧是tagged（带VLAN标签），交换机会检查该标签内的VLAN ID。当VLAN ID与该端口的PVID相同时，接收该报文。当VLAN ID与该端口的PVID不同时，丢弃该报文。<br> Access端口发送数据帧时，总是先剥离帧的Tag，然后再发送。Access端口发往对端设备的以太网帧永远是不带标签的帧。<br> 在本示例中，交换机的G0/0/1，G0/0/2，G0/0/3端口分别连接三台主机，都配置为Access端口。主机A把数据帧（未加标签）发送到交换机的G0/0/1端口，再由交换机发往其他目的地。收到数据帧之后，交换机根据端口的PVID给数据帧打上VLAN标签10，然后决定从G0/0/3端口转发数据帧。G0/0/3端口的PVID也是10，与VLAN标签中的VLAN ID相同，交换机移除标签，把数据帧发送到主机C。连接主机B的端口的PVID是2，与VLAN10不属于同一个VLAN，因此此端口不会接收到VLAN10的数据帧。</p><figure><img src="/wsq-blog/assets/8-4-Cq8NzT5j.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Access端口在收到数据后会添加VLAN Tag，VLAN ID和端口的PVID相同。<br> Access端口在转发数据前会移除VLAN Tag。</p><h3 id="端口类型–trunk" tabindex="-1"><a class="header-anchor" href="#端口类型–trunk"><span>端口类型–Trunk</span></a></h3><p>Trunk端口是交换机上用来和其他交换机连接的端口，它只能连接干道链路。Trunk端口允许多个VLAN的帧（带Tag标记）通过。</p><p>Trunk端口收发数据帧的规则如下：</p><ol><li>当接收到对端设备发送的不带Tag的数据帧时，会添加该端口的PVID，如果PVID在允许通过的VLAN ID列表中，则接收该报文，否则丢弃该报文。当接收到对端设备发送的带Tag的数据帧时，检查VLAN ID是否在允许通过的VLAN ID列表中。如果VLAN ID在接口允许通过的VLAN ID列表中，则接收该报文。否则丢弃该报文。</li><li>端口发送数据帧时，当VLAN ID与端口的PVID相同，且是该端口允许通过的VLAN ID时，去掉Tag，发送该报文。当VLAN ID与端口的PVID不同，且是该端口允许通过的VLAN ID时，保持原有Tag，发送该报文。</li></ol><p>在本示例中，SWA和SWB连接主机的端口为Access端口，PVID如图所示。SWA和SWB互连的端口为Trunk端口，PVID都为1，此Trunk链路允许所有VLAN的流量通过。当SWA转发VLAN1的数据帧时会剥离VLAN标签，然后发送到Trunk链路上。而在转发VLAN20的数据帧时，不剥离VLAN标签直接转发到Trunk链路上。</p><figure><img src="/wsq-blog/assets/8-5-CvOMtg0f.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>当Trunk端口收到帧时，如果该帧不包含Tag，将打上端口的PVID；如果该帧包含Tag，则不改变。<br> 当Trunk端口发送帧时，该帧的VLAN ID在Trunk的允许发送列表中：若与端口的PVID相同时，则剥离Tag发送；若与端口的PVID不同时，则直接发送。</p><h3 id="端口类型-hybrid" tabindex="-1"><a class="header-anchor" href="#端口类型-hybrid"><span>端口类型-Hybrid</span></a></h3><p>Access端口发往其他设备的报文，都是Untagged数据帧，而Trunk端口仅在一种特定情况下才能发出untagged数据帧，其它情况发出的都是Tagged数据帧。</p><p>Hybrid端口是交换机上既可以连接用户主机，又可以连接其他交换机的端口。Hybrid端口既可以连接接入链路又可以连接干道链路。Hybrid端口允许多个VLAN的帧通过，并可以在出端口方向将某些VLAN帧的Tag剥掉。华为设备默认的端口类型是Hybrid。<br> 在本示例中，要求主机A和主机B都能访问服务器，但是它们之间不能互相访问。此时交换机连接主机和服务器的端口，以及交换机互连的端口都配置为Hybrid类型。交换机连接主机A的端口的PVID是2，连接主机B的端口的PVID是3，连接服务器的端口的PVID是100。</p><figure><img src="/wsq-blog/assets/8-6-Dz2G0tPF.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Hybrid端口既可以连接主机，又可以连接交换机。<br> Hybrid端口可以以Tagged 或Untagged方式加入VLAN 。</p><figure><img src="/wsq-blog/assets/8-7-D-6HghsF.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Hybrid端口收发数据帧的规则如下：<br> 当接收到对端设备发送的不带Tag的数据帧时，会添加该端口的PVID，如果PVID在允许通过的VLAN ID列表中，则接收该报文，否则丢弃该报文。当接收到对端设备发送的带Tag的数据帧时，检查VLAN ID是否在允许通过的VLAN ID列表中。如果VLAN ID在接口允许通过的VLAN ID列表中，则接收该报文，否则丢弃该报文。<br> Hybrid端口发送数据帧时，将检查该接口是否允许该VLAN数据帧通过。如果允许通过，则可以通过命令配置发送时是否携带Tag。<br> 配置port hybrid tagged vlan vlan-id命令后，接口发送该vlan-id的数据帧时，不剥离帧中的VLAN Tag，直接发送。该命令一般配置在连接交换机的端口上。<br> 配置port hybrid untagged vlan vlan-id命令后，接口在发送vlan-id的数据帧时，会将帧中的VLAN Tag剥离掉再发送出去。该命令一般配置在连接主机的端口上。<br> 本例介绍了主机A和主机B发送数据给服务器的情况。在SWA和SWB互连的端口上配置了port hybrid tagged vlan 2 3 100命令后，SWA和SWB之间的链路上传输的都是带Tag标签的数据帧。在SWB连接服务器的端口上配置了port hybrid untagged vlan 2 3，主机A和主机B发送的数据会被剥离VLAN标签后转发到服务器。</p><h3 id="vlan端口类型总结" tabindex="-1"><a class="header-anchor" href="#vlan端口类型总结"><span>VLAN端口类型总结</span></a></h3><figure><img src="/wsq-blog/assets/8-8-D3OdSg9n.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="vlan划分方法" tabindex="-1"><a class="header-anchor" href="#vlan划分方法"><span>VLAN划分方法</span></a></h3><p>VLAN的划分包括如下5种方法：</p><ul><li>基于端口划分：根据交换机的端口编号来划分VLAN。通过为交换机的每个端口配置不同的PVID，来将不同端口划分到VLAN中。初始情况下，X7系列交换机的端口处于VLAN1中。此方法配置简单，但是当主机移动位置时，需要重新配置VLAN。</li><li>基于MAC地址划分：根据主机网卡的MAC地址划分VLAN。此划分方法需要网络管理员提前配置网络中的主机MAC地址和VLAN ID的映射关系。如果交换机收到不带标签的数据帧，会查找之前配置的MAC地址和VLAN映射表，根据数据帧中携带的MAC地址来添加相应的VLAN标签。在使用此方法配置VLAN时，即使主机移动位置也不需要重新配置VLAN。</li><li>基于IP子网划分：交换机在收到不带标签的数据帧时，根据报文携带的IP地址给数据帧添加VLAN标签。</li><li>基于协议划分：根据数据帧的协议类型（或协议族类型）、封装格式来分配VLAN ID。网络管理员需要首先配置协议类型和VLAN ID之间的映射关系。</li><li>基于策略划分：使用几个条件的组合来分配VLAN标签。这些条件包括IP子网、端口和IP地址等。只有当所有条件都匹配时，交换机才为数据帧添加VLAN标签。另外，针对每一条策略都是需要手工配置的。</li></ul><figure><img src="/wsq-blog/assets/8-9-Bb43hGM3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><table><thead><tr><th>划分方法</th><th>VLAN5</th><th>VLAN10</th></tr></thead><tbody><tr><td>基于端口</td><td>G0/0/1, G0/0/7</td><td>G0/0/2 G0/0/9</td></tr><tr><td>基于MAC地址</td><td>00-01-02-03-04-AA,00-01-02-03-04-CC</td><td>00-01-02-03-04-BB, 00-01-02-03-04-DD</td></tr><tr><td>基于IP子网划分</td><td>10.0.1.*</td><td>10.0.2.*</td></tr><tr><td>基于协议划分</td><td>IP</td><td>IPX</td></tr><tr><td>基于策略</td><td>10.0.1.* + G0/0/1+ 00-01-02-03-04-AA</td><td>10.0.2.* + G0/0/2 + 00-01-02-03-04-BB</td></tr></tbody></table><p>基于端口的VLAN划分方法在实际中最为常见。</p><h3 id="vlan配置" tabindex="-1"><a class="header-anchor" href="#vlan配置"><span>VLAN配置</span></a></h3><p>在交换机上划分VLAN时，需要首先创建VLAN。在交换机上执行<code>vlan &lt;vlan-id&gt;</code>命令，创建VLAN。如本例所示，执行vlan 10命令后，就创建了VLAN 10，并进入了VLAN 10视图。VLAN ID的取值范围是1到4094。如需创建多个VLAN，可以在交换机上执行<code>vlan batch { vlan-id1 [ to vlan-id2 ] }</code>命令，以创建多个连续的VLAN。也可以执行<code>vlan batch { vlan-id1 vlan-id2 }</code>命令，创建多个不连续的VLAN，VLAN号之间需要有空格。</p><figure><img src="/wsq-blog/assets/8-10-CMo4v3AI.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">[SWA]vlan 10</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA-vlan10]quit</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA]vlan batch 2 to 3</span></span>
<span class="line"><span style="color:#FFB757;">Info:</span><span style="color:#ADDCFF;"> This</span><span style="color:#ADDCFF;"> operation</span><span style="color:#ADDCFF;"> may</span><span style="color:#ADDCFF;"> take</span><span style="color:#ADDCFF;"> a</span><span style="color:#ADDCFF;"> few</span><span style="color:#ADDCFF;"> seconds.</span><span style="color:#ADDCFF;"> Please</span><span style="color:#ADDCFF;"> wait</span><span style="color:#ADDCFF;"> for</span><span style="color:#ADDCFF;"> a</span><span style="color:#ADDCFF;"> moment...done.</span><span style="color:#F0F3F6;"> </span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA]display vlan</span></span>
<span class="line"><span style="color:#FFB757;">The</span><span style="color:#ADDCFF;"> total</span><span style="color:#ADDCFF;"> number</span><span style="color:#ADDCFF;"> of</span><span style="color:#ADDCFF;"> vlans</span><span style="color:#ADDCFF;"> is</span><span style="color:#ADDCFF;"> :</span><span style="color:#91CBFF;"> 4</span></span>
<span class="line"><span style="color:#FFB757;">------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFB757;">U:Up</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">D:Down</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">TG:Tagged</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">UT:Untagged</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">MP:Vlan-mapping</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">ST:Vlan-stacking</span><span style="color:#F0F3F6;">; </span><span style="color:#BDC4CC;">#: ProtocolTransparent-vlan; *:Management-vlan;</span></span>
<span class="line"><span style="color:#FFB757;">--------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFB757;">VID</span><span style="color:#ADDCFF;">  Type</span><span style="color:#ADDCFF;">    Ports</span><span style="color:#F0F3F6;">                                                          </span></span>
<span class="line"><span style="color:#FFB757;">--------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFB757;">1</span><span style="color:#ADDCFF;">    common</span><span style="color:#ADDCFF;">  UT:GE0/0/1</span><span style="color:#F0F3F6;">(</span><span style="color:#FFB757;">U</span><span style="color:#F0F3F6;">) </span><span style="color:#ADDCFF;">……</span></span>
<span class="line"><span style="color:#FFB757;">2</span><span style="color:#ADDCFF;">    common</span><span style="color:#F0F3F6;">  </span></span>
<span class="line"><span style="color:#FFB757;">3</span><span style="color:#ADDCFF;">    common</span><span style="color:#F0F3F6;">  </span></span>
<span class="line"><span style="color:#FFB757;">  common</span><span style="color:#F0F3F6;">  </span></span>
<span class="line"><span style="color:#FFB757;">……</span></span></code></pre></div><p>创建VLAN后，可以执行display vlan命令验证配置结果。如果不指定任何参数，则该命令将显示所有VLAN的简要信息。<br> 执行<code>display vlan [ vlan-id [ verbose ] ]</code>命令，可以查看指定VLAN的详细信息，包括VLAN ID、类型、描述、VLAN的状态、VLAN中的端口、以及VLAN中端口的模式等。<br> 执行display vlan vlan-id statistics命令，可以查看指定VLAN中的流量统计信息。<br> 执行display vlan summary命令，可以查看系统中所有VLAN的汇总信息。</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">[SWA]interface GigabitEthernet 0/0/5</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA-GigabitEthernet0/0/5]port link-type access</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA-GigabitEthernet0/0/5]interface GigabitEthernet 0/0/7</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA-GigabitEthernet0/0/7]port link-type access</span></span></code></pre></div><p>华为X7系列交换机上，默认的端口类型是hybrid。<br> 配置端口类型的命令是<code>port link-type &lt;type&gt;</code>，type可以配置为Access，Trunk或Hybrid。需要注意的是，如果查看端口配置时没有发现端口类型信息，说明端口使用了默认的hybrid端口链路类型。当修改端口类型时，必须先恢复端口的默认VLAN配置，使端口属于缺省的VLAN 1。</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">[SWA]vlan 2</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA-vlan2]port GigabitEthernet 0/0/7</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA-vlan2]quit</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA]interface GigabitEthernet0/0/5 </span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA-GigabitEthernet0/0/5]port default vlan 3</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA]display vlan</span></span>
<span class="line"><span style="color:#FFB757;">The</span><span style="color:#ADDCFF;"> total</span><span style="color:#ADDCFF;"> number</span><span style="color:#ADDCFF;"> of</span><span style="color:#ADDCFF;"> vlans</span><span style="color:#ADDCFF;"> is</span><span style="color:#ADDCFF;"> :</span><span style="color:#91CBFF;"> 4</span></span>
<span class="line"><span style="color:#FFB757;">------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFB757;">U:Up</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">D:Down</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">TG:Tagged</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">UT:Untagged</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">MP:Vlan-mapping</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">ST:Vlan-stacking</span><span style="color:#F0F3F6;">; </span><span style="color:#BDC4CC;">#: ProtocolTransparent-vlan; *:Management-vlan;</span></span>
<span class="line"><span style="color:#FFB757;">--------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFB757;">VID</span><span style="color:#ADDCFF;">  Type</span><span style="color:#ADDCFF;">    Ports</span><span style="color:#F0F3F6;">                                                          </span></span>
<span class="line"><span style="color:#FFB757;">--------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFB757;">1</span><span style="color:#ADDCFF;">    common</span><span style="color:#ADDCFF;">  UT:GE0/0/1</span><span style="color:#F0F3F6;">(</span><span style="color:#FFB757;">U</span><span style="color:#F0F3F6;">) </span><span style="color:#ADDCFF;">……</span></span>
<span class="line"><span style="color:#FFB757;">2</span><span style="color:#ADDCFF;">    common</span><span style="color:#ADDCFF;">  UT:GE0/0/7</span><span style="color:#F0F3F6;">(</span><span style="color:#FFB757;">U</span><span style="color:#F0F3F6;">)                                                      </span></span>
<span class="line"><span style="color:#FFB757;">  common</span><span style="color:#ADDCFF;">  UT:GE0/0/5</span><span style="color:#F0F3F6;">(</span><span style="color:#FFB757;">U</span><span style="color:#F0F3F6;">) </span></span>
<span class="line"><span style="color:#FFB757;">10</span><span style="color:#ADDCFF;">   common</span><span style="color:#F0F3F6;">  </span></span>
<span class="line"><span style="color:#FFB757;">……</span></span></code></pre></div><p>可以使用两种方法把端口加入到VLAN。<br> 第一种方法是进入到VLAN视图，执行<code>port &lt;interface&gt;</code>命令，把端口加入VLAN。<br> 第二种方法是进入到接口视图，执行<code>port default &lt;vlan-id&gt;</code>命令，把端口加入VLAN。vlan-id是指端口要加入的VLAN。</p><p>执行display vlan命令，可以确认端口是否已经加入到VLAN中。在本示例中，端口GigabitEthernet0/0/5和GigabitEthernet0/0/7分别加入了VLAN 3和VLAN 2。UT表明该端口发送数据帧时，会剥离VLAN标签，即此端口是一个Access端口或不带标签的Hybrid端口。U或D分别表示链路当前是Up状态或Down状态。</p><figure><img src="/wsq-blog/assets/8-11-BvoYiI14.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">[SWA-GigabitEthernet0/0/1]port link-type trunk</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA-GigabitEthernet0/0/1]port trunk allow-pass vlan 2 3</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA-GigabitEthernet0/0/1]port trunk pvid vlan 1</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA]display vlan</span></span>
<span class="line"><span style="color:#FFB757;">The</span><span style="color:#ADDCFF;"> total</span><span style="color:#ADDCFF;"> number</span><span style="color:#ADDCFF;"> of</span><span style="color:#ADDCFF;"> vlans</span><span style="color:#ADDCFF;"> is</span><span style="color:#ADDCFF;"> :</span><span style="color:#91CBFF;"> 4</span></span>
<span class="line"><span style="color:#FFB757;">------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFB757;">U:Up</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">D:Down</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">TG:Tagged</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">UT:Untagged</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">MP:Vlan-mapping</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">ST:Vlan-stacking</span><span style="color:#F0F3F6;">; </span><span style="color:#BDC4CC;">#: ProtocolTransparent-vlan; *:Management-vlan;</span></span>
<span class="line"><span style="color:#FFB757;">--------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFB757;">VID</span><span style="color:#ADDCFF;">  Type</span><span style="color:#ADDCFF;">    Ports</span><span style="color:#F0F3F6;">                                                          </span></span>
<span class="line"><span style="color:#FFB757;">--------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFB757;">1</span><span style="color:#ADDCFF;">    common</span><span style="color:#ADDCFF;">  UT:GE0/0/1</span><span style="color:#F0F3F6;">(</span><span style="color:#FFB757;">U</span><span style="color:#F0F3F6;">) </span><span style="color:#ADDCFF;">……</span></span>
<span class="line"><span style="color:#FFB757;">2</span><span style="color:#ADDCFF;">    common</span><span style="color:#ADDCFF;">  UT:GE0/0/7</span><span style="color:#F0F3F6;">(</span><span style="color:#FFB757;">D</span><span style="color:#F0F3F6;">) </span><span style="color:#ADDCFF;">TG:GE0/0/1</span><span style="color:#F0F3F6;">(</span><span style="color:#FFB757;">U</span><span style="color:#F0F3F6;">)                                                     </span></span>
<span class="line"><span style="color:#FFB757;">  common</span><span style="color:#ADDCFF;">  UT:GE0/0/5</span><span style="color:#F0F3F6;">(</span><span style="color:#FFB757;">U</span><span style="color:#F0F3F6;">) </span><span style="color:#ADDCFF;">TG:GE0/0/1</span><span style="color:#F0F3F6;">(</span><span style="color:#FFB757;">U</span><span style="color:#F0F3F6;">)</span></span>
<span class="line"><span style="color:#FFB757;">10</span><span style="color:#ADDCFF;">   common</span><span style="color:#F0F3F6;">  </span></span>
<span class="line"><span style="color:#FFB757;">……</span></span></code></pre></div><p>配置Trunk时，应先使用port link-type trunk命令修改端口的类型为Trunk，然后再配置Trunk端口允许哪些VLAN的数据帧通过。执行<code>port trunk allow-pass vlan { { vlan-id1 [ to vlan-id2 ] } | all }</code>命令，可以配置端口允许的VLAN，all表示允许所有VLAN的数据帧通过。<br> 执行port trunk pvid vlan vlan-id命令，可以修改Trunk端口的PVID。修改Trunk端口的PVID之后，需要注意：缺省VLAN不一定是端口允许通过的VLAN。只有使用命令<code>port trunk allow-pass vlan { { vlan-id1 [ to vlan-id2 ] } | all }</code>允许缺省VLAN数据通过，才能转发缺省VLAN的数据帧。交换机的所有端口默认允许VLAN1的数据通过。<br> 在本示例中，将SWA的G0/0/1端口配置为Trunk端口，该端口PVID默认为1。配置port trunk allow-pass vlan 2 3命令之后，该Trunk允许VLAN 2和VLAN 3的数据流量通过。</p><p>执行display vlan命令可以查看修改后的配置。TG表明该端口在转发对应VLAN的数据帧时，不会剥离标签，直接进行转发，该端口可以是Trunk端口或带标签的Hybrid端口。本示例中，GigabitEthernet0/0/1在转发VLAN 2和VLAN3的流量时，不剥离标签，直接转发。</p><figure><img src="/wsq-blog/assets/8-12-CuSeSnk4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">[SWA-GigabitEthernet0/0/1]port link-type hybrid</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA-GigabitEthernet0/0/1]port hybrid tagged vlan 2 3 100</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA-GigabitEthernet0/0/2]port hybrid pvid vlan 2</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA-GigabitEthernet0/0/2]port hybrid untagged vlan 2 100</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA-GigabitEthernet0/0/3]port hybrid pvid vlan 3</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA-GigabitEthernet0/0/3]port hybrid untagged vlan 3 100</span></span></code></pre></div><p>port link-type hybrid命令的作用是将端口的类型配置为Hybrid。默认情况下，X7系列交换机的端口类型是Hybrid。因此，只有在把Access口或Trunk口配置成Hybrid时，才需要执行此命令。<br><code>port hybrid tagged vlan{ { vlan-id1 [ to vlan-id2 ] } | all }</code>命令用来配置允许哪些VLAN的数据帧以Tagged方式通过该端口。<br><code>port hybrid untagged vlan { { vlan-id1 [ to vlan-id2 ] } | all }</code>命令用来配置允许哪些VLAN的数据帧以Untagged方式通过该端口。<br> 在本示例中，要求主机A和主机B都能访问服务器，但是它们之间不能互相访问。此时通过命令port link-type hybrid配置交换机连接主机和服务器的端口，以及交换机互连的端口都为Hybrid类型。通过命令port hybrid pvid vlan 2配置交换机连接主机A的端口的PVID是2。类似地，连接主机B的端口的PVID是3，连接服务器的端口的PVID是100。<br> 通过在G0/0/1端口下使用命令port hybrid tagged vlan 2 3 100，配置VLAN2,VLAN3和VLAN100的数据帧在通过该端口时都携带标签。在G0/0/2端口下使用命令port hybrid untagged vlan 2 100，配置VLAN2和VLAN100的数据帧在通过该端口时都不携带标签。在G0/0/3端口下使用命令port hybrid untagged vlan 3 100，配置VLAN3和VLAN100的数据帧在通过该端口时都不携带标签。</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">[SWB-GigabitEthernet0/0/1]port link-type hybrid</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWB-GigabitEthernet0/0/1]port hybrid tagged vlan 2 3 100</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWB-GigabitEthernet0/0/2]port hybrid pvid vlan 100</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWB-GigabitEthernet0/0/2]port hybrid untagged vlan 2 3 100</span></span>
<span class="line"><span style="color:#F0F3F6;">[SWA]display vlan</span></span>
<span class="line"><span style="color:#FFB757;">The</span><span style="color:#ADDCFF;"> total</span><span style="color:#ADDCFF;"> number</span><span style="color:#ADDCFF;"> of</span><span style="color:#ADDCFF;"> vlans</span><span style="color:#ADDCFF;"> is</span><span style="color:#ADDCFF;"> :</span><span style="color:#91CBFF;"> 4</span></span>
<span class="line"><span style="color:#FFB757;">------------------------------------------------------------</span></span>
<span class="line"><span style="color:#FFB757;">U:Up</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">D:Down</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">TG:Tagged</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">UT:Untagged</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">MP:Vlan-mapping</span><span style="color:#F0F3F6;">; </span><span style="color:#FFB757;">ST:Vlan-stacking</span><span style="color:#F0F3F6;">; </span><span style="color:#BDC4CC;">#: ProtocolTransparent-vlan; *:Management-vlan;</span></span>
<span class="line"><span style="color:#FFB757;">1</span><span style="color:#ADDCFF;">   common</span><span style="color:#ADDCFF;">   UT:GE0/0/1</span><span style="color:#F0F3F6;">(</span><span style="color:#FFB757;">U</span><span style="color:#F0F3F6;">)</span><span style="color:#ADDCFF;">……</span></span>
<span class="line"><span style="color:#FFB757;">2</span><span style="color:#ADDCFF;">   common</span><span style="color:#ADDCFF;">   UT:GE0/0/2</span><span style="color:#F0F3F6;">(</span><span style="color:#FFB757;">U</span><span style="color:#F0F3F6;">)            </span></span>
<span class="line"><span style="color:#FFB757;">             TG:GE0/0/1(U</span><span style="color:#F0F3F6;">)            </span></span>
<span class="line"><span style="color:#FFB757;">3</span><span style="color:#ADDCFF;">   common</span><span style="color:#ADDCFF;">   UT:GE0/0/3</span><span style="color:#F0F3F6;">(</span><span style="color:#FFB757;">U</span><span style="color:#F0F3F6;">)            </span></span>
<span class="line"><span style="color:#FFB757;">             TG:GE0/0/1(U</span><span style="color:#F0F3F6;">)            </span></span>
<span class="line"><span style="color:#FFB757;">100</span><span style="color:#ADDCFF;">  common</span><span style="color:#ADDCFF;">  UT:GE0/0/2</span><span style="color:#F0F3F6;">(</span><span style="color:#FFB757;">U</span><span style="color:#F0F3F6;">)      </span><span style="color:#ADDCFF;">GE0/0/3</span><span style="color:#F0F3F6;">(</span><span style="color:#FFB757;">U</span><span style="color:#F0F3F6;">)                                      </span></span>
<span class="line"><span style="color:#FFB757;">             TG:GE0/0/1(U</span><span style="color:#F0F3F6;">)</span></span></code></pre></div><p>在SWB上继续进行配置，在G0/0/1端口下使用命令port link-type hybrid配置端口类型为Hybrid。<br> 在G0/0/1端口下使用命令port hybrid tagged vlan 2 3 100，配置VLAN2，VLAN3和VLAN100的数据帧在通过该端口时都携带标签。<br> 在G0/0/2端口下使用命令port hybrid untagged vlan 2 3 100，配置VLAN2，VLAN3和VLAN100的数据帧在通过该端口时都不携带标签。</p><p>在SWA上执行display vlan命令，可以查看hybrid端口的配置。在本示例中，GigabitEthernet 0/0/2在发送VLAN2和VLAN100的数据帧时会剥离标签。GigabitEthernet 0/0/3在发送VLAN3和VLAN100的数据帧时会剥离标签。GigabitEthernet 0/0/1允许VLAN 2，VLAN 3和VLAN 100的带标签的数据帧通过。此配置满足了多个VLAN可以访问特定VLAN，而其他VLAN间不允许互相访问的需求。</p></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><span class="vp-meta-info" data-allow-mismatch="text">2025/5/7 05:36:04</span></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 592786982@qq.com">WSQ</span><!--]--><!--]--></div></div></footer><!----><div id="comment" class="giscus-wrapper input-top vp-comment" vp-comment style="display:none;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><!----></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/wsq-blog/assets/app-BAoNGAQX.js" defer></script>
  </body>
</html>
