<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.59" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://0oWSQo0.github.io/wsq-blog/network/%E9%98%B2%E7%81%AB%E5%A2%99.html"><meta property="og:title" content="防火墙"><meta property="og:description" content="为什么需要防火墙 内部网络和外部网络互访时，内部网络可能存在一些安全隐患，可能被攻击。 这个时候就需要在内部网络和外部网络之间有一个设备能够保护内网。那么这个设备就是防火墙。防火墙是一种安全设备，保护一个网络区域免受另一个网络区域的攻击和入侵，通常被部署在网络边界，例如：企业互联网出口。 简单讲，防火墙的主要作用是划分网络安全边界，实现关键系统与外部环..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-05-14T10:35:45.000Z"><meta property="article:published_time" content="2025-04-05T00:00:00.000Z"><meta property="article:modified_time" content="2025-05-14T10:35:45.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"防火墙","image":[""],"datePublished":"2025-04-05T00:00:00.000Z","dateModified":"2025-05-14T10:35:45.000Z","author":[{"@type":"Person","name":"WSQ","url":"https://0oWSQo0.github.com"}]}</script><title>防火墙</title><meta name="description" content="为什么需要防火墙 内部网络和外部网络互访时，内部网络可能存在一些安全隐患，可能被攻击。 这个时候就需要在内部网络和外部网络之间有一个设备能够保护内网。那么这个设备就是防火墙。防火墙是一种安全设备，保护一个网络区域免受另一个网络区域的攻击和入侵，通常被部署在网络边界，例如：企业互联网出口。 简单讲，防火墙的主要作用是划分网络安全边界，实现关键系统与外部环...">
    <link rel="preload" href="/wsq-blog/assets/style-B8iyyxn3.css" as="style"><link rel="stylesheet" href="/wsq-blog/assets/style-B8iyyxn3.css">
    <link rel="modulepreload" href="/wsq-blog/assets/app-BAoNGAQX.js"><link rel="modulepreload" href="/wsq-blog/assets/防火墙.html-xIL0MxFq.js"><link rel="modulepreload" href="/wsq-blog/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/wsq-blog/assets/index.html-y9hjWg4H.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/portfolio.html-BXkm2R9O.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/进制.html-D8SGjDfR.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ACL详解.html-BloX_IeT.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ARP详解.html-cBNfZDN_.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/BGP详解.html-H-6DMP-Q.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/DHCP详解.html-5OsfIqif.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/DNS详解.html-9f9jSQ6z.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/HTTPS详解.html-B1MNeeCC.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ICMP详解.html-rOsq0YlX.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/IPv6详解.html-mcuWo4Lm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/IP详解.html-Cn_WOg-x.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ISIS详解.html-CKYYamtd.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/NAT详解.html-9GTOa7EI.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/OSPF-LSA.html-DeRnGEZO.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/OSPF实战.html-DP7X6rhm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/OSPF特性.html-CHIr3PPJ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/OSPF详解.html-CbPtE_bm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/RIP详解.html-QgpY6GUV.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/RSTP、MSTP详解.html-BXEuGz-T.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/STP详解.html-C1DTR0aY.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/TCP和UDP详解.html-BZu5cSVW.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/VLAN详解.html-D6hv5wdt.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/VPN详解.html-BhwoQ2eB.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/VRRP详解.html-DVENiYOQ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Wireshark使用教程.html-nr1YJCIH.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/三层交换机.html-DfJEb5tX.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/华为命令.html-CLrOQfhN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/应用层协议详解.html-DVr0k4nr.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/数据链路层基础知识.html-BXryfrXx.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/无线网络详解.html-QsHhSR6H.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/校验码.html-CMZ1aKIy.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/网络基础知识.html-lq4pXFoN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/路由协议详解.html-DIdwYcdD.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/路由器.html-C9VJQbwh.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/路由策略和策略路由.html-CxTk51aa.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/路由高级特性.html-BLZaIDsP.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/链路聚合技术.html-BBLX_r7x.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/静态路由详解.html-Cn79_8_w.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/网站收藏.html-wtWtedCA.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python元组.html-C35VawoP.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python函数.html-D6Qhr5G1.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python列表.html-CLPZErQH.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python变量.html-YJzPA_R6.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python基础.html-BZCQtRn2.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python字典.html-qcjF8v7r.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python字符串常用方法.html-DYzfZrjm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python异常处理机制.html-CjgoKvUP.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python文件操作.html-B0iP2xCS.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python模块和包.html-CResYCBN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python流程控制.html-C3ZzWANj.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python爬虫.html-CQqaavzW.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python类和对象.html-DYK3lmTC.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python类特殊成员.html-DxW-zaVC.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python运算符.html-Am9I9ipn.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/python集合.html-Dp4fBRSz.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-GtLqceJP.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/disable.html-DhwD98pb.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/encrypt.html-BmguXeXU.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/layout.html-Ccbzvy5y.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/markdown.html-b_YalApo.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/page.html-M98jd5pQ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/OSPF.html-cztG_FLD.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/华为数通笔记.html-CFn1KnHB.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/网络.html-BbtEGDZP.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/文字特效.html-CDNfMzpk.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 ArrayBuffer.html-Cl4VZg1r.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 Class.html-CaeH-519.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 Class的继承.html-D1Gdrm4I.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 Module的加载实现.html-n59X0Nwm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 Module语法.html-CUrdTY80.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 Set和Map.html-DKX3dnZP.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 async函数.html-D1WNxO1H.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 let和const.html-8HvK1j46.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6 proxy.html-3homrOiA.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6Iterator和forof循环.html-4EZTMvYn.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6Promise对象.html-BPigeBNB.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6Symbol.html-CtdsFENt.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6函数.html-BcPSTM_5.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6字符串.html-D0qEo11d.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6对象.html-CJWUhs9N.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6数值.html-BlBM_CBu.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6数组.html-DrjqHESM.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6结构赋值.html-DIY-p22Z.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ES6运算符.html-C8BDY9Rl.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/d.ts类型声明文件.html-CDZ4uJ25.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts三种特殊类型.html-CUjOdOBa.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts函数类型.html-j8m-EAgP.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts对象类型.html-DPXW-ga3.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts数据类型.html-BpaHf3ds.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts数组和元组.html-BAaRqN14.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts泛型.html-Buw5j75J.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts的Enum类型.html-Byl3l3qW.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts的interface接口.html-FPr7UtEK.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ts类型断言.html-B-iBe9DT.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-CanvasAPI.html-C4EL_HZd.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-ClipboardAPI.html-CwrWQ7PN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-FetchAPI.html-TI0HPebM.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-File_FileList_FileReader.html-BAlNMKUb.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-FormData.html-D9ULMjGG.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-History.html-BR4tGLRY.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-SVG.html-L7Ds9vcL.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-URL.html-C6Za9YIY.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-URLPatternAPI.html-BdJeGXZm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-WebSocket.html-DIFx7koR.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS-window.html-Bz0eWajB.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/JS实用代码片段.html-CSVtMNuW.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/SpringJdbcTemplate.html-B0ZT7oaZ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring事务.html-KeGQ7jKA.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring的整体脉络.html-BhMb13xM.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring详解—IOC实现原理之Bean实例化.html-755XRiKp.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring详解—IOC实现原理之IOC体系结构设计.html-BU12GVal.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring详解—IOC实现原理之IOC初始化流程.html-Bcdh-3-8.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring详解—Spring和Spring框架组成.html-DhEpbrji.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring详解—控制反转IOC.html-1HXdthO7.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring详解—简单例子引入Spring要点.html-pbJC4jBI.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Spring详解—面向切面编程(AOP).html-2uhc-qFV.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java 集合.html-CI_1se6U.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java修饰符和关键字.html-Bds7WBkl.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java内置包装类.html-WRzUyaot.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java内部类.html-D-hpb9YN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java反射机制.html-B0u-aZMm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java基础—SPI机制.html--PjTaDC-.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java基础—反射机制.html-Di7zg_-6.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java基础—异常机制.html-C9Jltuxw.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java基础—泛型机制.html-DMd2pwVR.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java基础—注解机制.html-B9USVSlN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java字符串处理.html-D_rrovfs.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java序列化与反序列化.html-BOs0fCXy.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java异常处理.html-CiErb1jn.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java数字处理.html-DmexAmZG.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java数组.html-BP5Yfe2s.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java数组操作.html-BArfyCs_.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java时间日期的处理.html-BZJD8Yo2.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java泛型和枚举.html-BI24_Lh7.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java类和对象.html-CPUY67Fk.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Java输入输出流.html-BWPJfW4h.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/java继承封装和多态.html-CSpnGKJ4.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—Mapper映射文件配置.html-BNmW_Z06.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—sqlSession执行流程.html-DBTVa2OW.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—一级缓存实现机制.html-Cb435cgF.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—事务管理机制.html-DIHpVRBV.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—二级缓存实现机制.html-8q3bkMC0.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—初始化基本流程.html-d1Vr3b-S.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—动态SQL使用与原理.html-DBuN--r0.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—总体框架设计.html-BspOqrrx.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—插件之分页机制.html-CVfnE8LX.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—插件机制.html-CqsrZDcp.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—数据源与连接池.html-Czq24GfH.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—配置清单.html-DF3yeIZ0.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MyBatis详解—配置解析过程.html-CEJH1pu7.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Servlet Cookie和Session.html-CWWdORcy.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Servlet过滤器.html-C-xLWyJr.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/servlet1.html-Coup9vOB.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/servlet2.html-ihS4wAZT.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/servlet3.html-BWeFNNxS.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot—devtools.html-xEXVpFBb.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot—常用注解.html-_HVb37q8.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot—集成Druid连接池.html-CfYGmu2g.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot—集成EasyExcel.html-tq0SN1Ft.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot—集成POI.html-KhW9FXwO.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot—集成actuator监控工具.html-BXbyLj_m.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot—集成admin监控工具.html-D9p-UOPX.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot集成MyBatis—XML方式.html-DTuQ-eoR.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot集成Mybatis—PageHelper分页.html-CfUITTDW.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/springBoot集成Mybatis—注解方式.html-BZ1OLpXO.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/SpringMVC入门.html-DYUPumLp.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/SpringMVC域对象共享数据.html-ChLAabt7.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/SpringMVC实现Restful.html-CGsAaTLD.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/SpringMVC获取请求参数.html-vMl99Hg6.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/SpringMVC视图和视图解析器.html-BiLG-6j8.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Dockerfile定制镜像.html-G2sxyKio.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Docker基础.html-DVo1b4T6.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Docker的数据卷.html-CUaR897X.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Docker的网络.html-D_zThKFh.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/docker-compose.html-UGr3yfF8.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/热门镜像安装.html-_u7TFfrM.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/集成Docker实现一键部署.html-BhlW0_gg.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—入门.html-BhtxRtVN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—函数.html-DktAR5MO.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—变量.html-CDD3IwzV.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—字符串操作.html-CQcvhH9K.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—常用命令.html-_akWuHlJ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—数组.html-vTJEhlPQ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—模式扩展.html-CI7-g1hm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—流程控制.html-BFyG9TLx.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Bash脚本—算数运算.html-DBrCwfx3.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/LinuxSSH命令.html-Bpxk7XTt.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/LinuxVim.html-DGPh-mEF.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux入门.html-ZAKFcDi2.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux常用软件安装.html-CJz7CUK1.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux打包压缩命令.html-oVn9T6yl.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux操作历史.html-BEZVZdks.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux文件目录相关命令.html-CT8cuya0.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux文件系统结构.html-BCYXQfGo.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux文本操作命令.html-C1qx5bj6.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux权限管理.html-BrzQFM_6.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux用户和用户组管理.html-cHqLXYUS.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux磁盘相关命令.html-Bk1vWp_s.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux系统服务管理.html-DQVl65aa.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux网络相关命令.html-BCrparGN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux软件安装.html-BdsrJqcj.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux进程相关命令.html-DkriE6C4.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linux防火墙详解.html-BfE8j8Co.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Linx其它常用命令.html-DbIEYSRH.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/VMware安装linux.html-DF9azwZa.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/linux常用工具.html-CGtPjFAM.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/安装脚本实例.html-0kRVZri1.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ansible-playbook.html-CDcGrj1_.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ansible.html-CehcSPGK.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/ansible常用模块.html-KBDB5y_K.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/nginx入门.html-D0xAoW9D.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Requests基本用法.html-DhBsfgOV.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Scrapy爬虫框架.html-B3M5MZow.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/urllib包.html-B4r7Fmqq.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL事务.html-dWAPSxdl.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL入门.html-Bm_oWoBE.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL基础查询.html-B-emxQ5X.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL多表查询.html-BrwxgCv6.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL字符集和校对规则.html-ozeyPJdP.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL存储引擎.html-3zjiFhFD.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL存储过程.html-KbabVN6z.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL安装.html-Cos3L3tR.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL常用函数汇总.html-BxaA0aHv.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL常见问题.html-CXFDHjlk.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL执行流程.html-BAXJ078x.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL操作表中的数据.html-BSFFJgYT.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL数据库备份恢复.html-D1o3_rhN.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL数据库的基本操作.html-CdzWAGDm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL数据类型.html-kVOe4_gy.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL数据表的基本操作.html-BKQeQ9rK.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL日志.html-B8qVLOIE.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL用户管理.html-DY5mkBHL.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL索引.html-Y5-Wn-Ns.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL约束.html-tqcKxnNB.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL视图.html-Dvlg6sc5.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL触发器.html-DrUUb4sH.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL试题.html-CrD4I06p.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL运算符.html-Cuyt0x-G.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL锁机制.html-CEXSfDOm.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/MySQL高级查询.html-MYzC4-LQ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Redis Stream.html-DRkKy_fr.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Redis发布订阅模式.html-8ovmHjic.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Redis基础入门.html-CnPzPUcO.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Redis基础数据类型.html-CclhSKaQ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Redis特殊数据类型.html-BVv9ijlq.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Redis的键.html-CvQ3kMQg.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/Redis配置文件.html-D2SsHd1F.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/404.html-BlieSuoI.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-CZ6tDm5n.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-DDe4C4By.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-BzfxMV2E.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-CGR1uTaO.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-C8i93F1_.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-DMZ4MO3h.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-D4-erai_.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-7v6dhxuF.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-DW2tbR-f.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-CJiqu4_o.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-BPuFGnBK.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-Czqdcg4u.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-OvYZXapl.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-C61Yv5KG.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-BTU9BpIn.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-e_1t2G6T.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-CI6fbVHE.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-BTxrdDkL.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-Ddp4aLQU.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-O0sx69kH.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-BVGzpYeT.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-BmmsHO8n.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-B7mYeUT8.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-BFacqWRe.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index.html-B5DDXp-M.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/giscus-BZxmVUME.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/flowchart-CTwbLKUk.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index-BYq9jyaM.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index-DRWmbcXV.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/index-B9oRC6ej.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/mermaid.esm.min-CATR3y-q.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/photoswipe.esm-GXRgw7eJ.js" as="script"><link rel="prefetch" href="/wsq-blog/assets/setupDevtools-7MC2TMWH-DtIpLJvU.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/wsq-blog/" aria-label="带我回家"><img class="vp-nav-logo" src="/wsq-blog/logo.png" alt><!----><!----></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/wsq-blog/" aria-label="主页"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="logos:google-home" width="1em" height="1em"></iconify-icon><!--]-->主页<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="前端"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:javascript" width="1em" height="1em"></iconify-icon>前端<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/js/%E5%9F%BA%E7%A1%80/" aria-label="JS基础"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:javascript" width="1em" height="1em"></iconify-icon><!--]-->JS基础<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/js/es6/" aria-label="ES6"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="logos:es6" width="1em" height="1em"></iconify-icon><!--]-->ES6<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/js/CSS/" aria-label="CSS"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:css3" width="1em" height="1em"></iconify-icon><!--]-->CSS<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Java"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:java" width="1em" height="1em"></iconify-icon>Java<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/java/java%E5%9F%BA%E7%A1%80/" aria-label="Java基础"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:java" width="1em" height="1em"></iconify-icon><!--]-->Java基础<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/java/mybatis/" aria-label="Mybatis"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Mybatis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/java/Spring/" aria-label="Spring"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->Spring<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/java/springBoot/" aria-label="springBoot"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:spring" width="1em" height="1em"></iconify-icon><!--]-->springBoot<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="SQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:azuresqldatabase" width="1em" height="1em"></iconify-icon>SQL<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/sql/redis/" aria-label="Redis"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:redis" width="1em" height="1em"></iconify-icon><!--]-->Redis<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/sql/mysql/" aria-label="MySQL"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:mysql-wordmark" width="1em" height="1em"></iconify-icon><!--]-->MySQL<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="运维"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:centos" width="1em" height="1em"></iconify-icon>运维<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/linux/linux%E5%9F%BA%E7%A1%80/" aria-label="linux基础"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:linux" width="1em" height="1em"></iconify-icon><!--]-->linux基础<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/linux/docker/" aria-label="Docker"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="mdi:docker" width="1em" height="1em"></iconify-icon><!--]-->Docker<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/linux/tools/" aria-label="运维工具"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:linux" width="1em" height="1em"></iconify-icon><!--]-->运维工具<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="计算机基础"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:windows11" width="1em" height="1em"></iconify-icon>计算机基础<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/wsq-blog/network/" aria-label="网络"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:networkx" width="1em" height="1em"></iconify-icon><!--]-->网络<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/wsq-blog/computer/" aria-label="其他"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="devicon:haskell" width="1em" height="1em"></iconify-icon><!--]-->其他<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://0oWSQo0.github.com" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html" aria-label="网络基础知识"><!---->网络基础知识<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/%E6%A0%A1%E9%AA%8C%E7%A0%81.html" aria-label="校验码"><!---->校验码<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html" aria-label="数据链路层基础知识"><!---->数据链路层基础知识<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/ARP%E8%AF%A6%E8%A7%A3.html" aria-label="ARP详解"><!---->ARP详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/STP%E8%AF%A6%E8%A7%A3.html" aria-label="STP详解"><!---->STP详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/RSTP%E3%80%81MSTP%E8%AF%A6%E8%A7%A3.html" aria-label="RSTP、MSTP详解"><!---->RSTP、MSTP详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/VLAN%E8%AF%A6%E8%A7%A3.html" aria-label="VLAN详解"><!---->VLAN详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/IP%E8%AF%A6%E8%A7%A3.html" aria-label="IP详解"><!---->IP详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/IPv6%E8%AF%A6%E8%A7%A3.html" aria-label="IPv6详解"><!---->IPv6详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/DNS%E8%AF%A6%E8%A7%A3.html" aria-label="DNS详解"><!---->DNS详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/DHCP%E8%AF%A6%E8%A7%A3.html" aria-label="DHCP详解"><!---->DHCP详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/ICMP%E8%AF%A6%E8%A7%A3.html" aria-label="ICMP详解"><!---->ICMP详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/NAT%E8%AF%A6%E8%A7%A3.html" aria-label="NAT详解"><!---->NAT详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/TCP%E5%92%8CUDP%E8%AF%A6%E8%A7%A3.html" aria-label="TCP和UDP详解"><!---->TCP和UDP详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/%E5%BA%94%E7%94%A8%E5%B1%82%E5%8D%8F%E8%AE%AE%E8%AF%A6%E8%A7%A3.html" aria-label="应用层协议详解"><!---->应用层协议详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/HTTPS%E8%AF%A6%E8%A7%A3.html" aria-label="HTTPS详解"><!---->HTTPS详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C%E8%AF%A6%E8%A7%A3.html" aria-label="无线网络详解"><!---->无线网络详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA.html" aria-label="三层交换机"><!---->三层交换机<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/%E8%B7%AF%E7%94%B1%E5%99%A8.html" aria-label="路由器"><!---->路由器<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/wsq-blog/network/%E9%98%B2%E7%81%AB%E5%A2%99.html" aria-label="防火墙"><!---->防火墙<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/ACL%E8%AF%A6%E8%A7%A3.html" aria-label="ACL详解"><!---->ACL详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/VPN%E8%AF%A6%E8%A7%A3.html" aria-label="VPN详解"><!---->VPN详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/Wireshark%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B.html" aria-label="Wireshark使用教程"><!---->Wireshark使用教程<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%E8%AF%A6%E8%A7%A3.html" aria-label="路由协议详解"><!---->路由协议详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/RIP%E8%AF%A6%E8%A7%A3.html" aria-label="RIP详解"><!---->RIP详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/OSPF%E8%AF%A6%E8%A7%A3.html" aria-label="OSPF详解"><!---->OSPF详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/OSPF-LSA.html" aria-label="OSPF-LSA"><!---->OSPF-LSA<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/OSPF%E7%89%B9%E6%80%A7.html" aria-label="OSPF特性"><!---->OSPF特性<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/OSPF%E5%AE%9E%E6%88%98.html" aria-label="OSPF实战"><!---->OSPF实战<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/ISIS%E8%AF%A6%E8%A7%A3.html" aria-label="IS-IS详解"><!---->IS-IS详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1%E8%AF%A6%E8%A7%A3.html" aria-label="静态路由详解"><!---->静态路由详解<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/VRRP%E8%AF%A6%E8%A7%A3.html" aria-label="网关冗余技术"><!---->网关冗余技术<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/%E8%B7%AF%E7%94%B1%E7%AD%96%E7%95%A5%E5%92%8C%E7%AD%96%E7%95%A5%E8%B7%AF%E7%94%B1.html" aria-label="路由策略和策略路由"><!---->路由策略和策略路由<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/%E9%93%BE%E8%B7%AF%E8%81%9A%E5%90%88%E6%8A%80%E6%9C%AF.html" aria-label="链路聚合技术"><!---->链路聚合技术<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/wsq-blog/network/%E5%8D%8E%E4%B8%BA%E5%91%BD%E4%BB%A4.html" aria-label="华为命令"><!---->华为命令<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->防火墙</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://0oWSQo0.github.com" target="_blank" rel="noopener noreferrer">WSQ</a></span><span property="author" content="WSQ"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025年4月5日</span><meta property="datePublished" content="2025-04-05T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 34 分钟</span><meta property="timeRequired" content="PT34M"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color3" role>计算机网络</span><!--]--><meta property="articleSection" content="计算机网络"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color5" role>network</span><!--]--><meta property="keywords" content="network"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#为什么需要防火墙">为什么需要防火墙</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#防火墙分类">防火墙分类</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#软件防火墙">软件防火墙</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#硬件防火墙">硬件防火墙</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#防火墙技术类型">防火墙技术类型</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#代理服务器">代理服务器</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#防火墙的接口模式">防火墙的接口模式</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#防火墙能防范的威胁">防火墙能防范的威胁</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#防火墙功能">防火墙功能</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#会话管理">会话管理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#tcp-连接管理">TCP 连接管理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#会话建立的处理">会话建立的处理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#会话的生存时间">会话的生存时间</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#会话终止处理">会话终止处理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#udp-数据流的管理">UDP 数据流的管理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#管理-icmp-和-ip-数据流">管理 ICMP 和 IP 数据流</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#会话同步">会话同步</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#会话管理有什么防御功能">会话管理有什么防御功能？</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#安全区域">安全区域</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#默认安全区域">默认安全区域</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#local区域">Local区域</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#安全区域的规划">安全区域的规划</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#安全区域的限制或注意事项">安全区域的限制或注意事项</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#inbound及outbound">Inbound及Outbound</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#安全策略">安全策略</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#什么是安全策略">什么是安全策略</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#防火墙的安全策略">防火墙的安全策略</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#安全策略组成">安全策略组成</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#安全策略匹配过程">安全策略匹配过程</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#会话表">会话表</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#server-map">Server-map</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#防火墙应用场景">防火墙应用场景</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#企业边界防护">企业边界防护</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#内网安全隔离">内网安全隔离</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#数据中心边界防护">数据中心边界防护</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#防火墙和交换机、路由器区别">防火墙和交换机、路由器区别</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#防护墙和路由器的转发流程对比">防护墙和路由器的转发流程对比</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#防火墙配置">防火墙配置</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#防火墙基础配置">防火墙基础配置</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#防火墙nat配置">防火墙NAT配置</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content" vp-content><h2 id="为什么需要防火墙" tabindex="-1"><a class="header-anchor" href="#为什么需要防火墙"><span>为什么需要防火墙</span></a></h2><p>内部网络和外部网络互访时，内部网络可能存在一些安全隐患，可能被攻击。</p><figure><img src="/wsq-blog/assets/1-Dc9Nrb4m.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>这个时候就需要在内部网络和外部网络之间有一个设备能够保护内网。那么这个设备就是防火墙。防火墙是一种安全设备，保护一个网络区域免受另一个网络区域的攻击和入侵，通常被部署在网络边界，例如：企业互联网出口。</p><p>简单讲，防火墙的主要作用是划分网络安全边界，实现关键系统与外部环境的安全隔离，保护内部网络免受外部攻击。与路由器相比防火墙提供了更丰富的安全防御策略，提高了安全策略下数据报转发速率。由于防火墙用于安全边界，因此往往兼备NAT、VPN等功能，并且在这方面的相比路由器更加强劲。</p><p>防火墙能够实现如下业务述求：</p><ul><li>外部网络安全隔离</li><li>内部网络安全管控</li><li>内容安全过滤</li><li>入侵防御</li><li>防病毒等</li></ul><h2 id="防火墙分类" tabindex="-1"><a class="header-anchor" href="#防火墙分类"><span>防火墙分类</span></a></h2><p>按照硬件形态，防火墙可以分为盒式防火墙、框式防护墙。</p><figure><img src="/wsq-blog/assets/2-BvNZsYhZ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>按照软硬件区分：防火墙可以分为软件防火墙和硬件防火墙。软件防火墙又可分为个人防火墙和网关防火墙。</p><p>按照防火墙技术原理：防火墙可以分为包过滤防火墙、状态检测防火墙，AI 防火墙等。</p><h3 id="软件防火墙" tabindex="-1"><a class="header-anchor" href="#软件防火墙"><span>软件防火墙</span></a></h3><h4 id="个人防火墙" tabindex="-1"><a class="header-anchor" href="#个人防火墙"><span>个人防火墙</span></a></h4><p>个人防火墙运行在 PC 上，用于监控 PC 和外网的通信信息。</p><figure><img src="/wsq-blog/assets/2-1-lLHIuOg-.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>杀毒软件产品厂家的个人防火墙一般包含在安全软件套件里。</p><table><thead><tr><th style="text-align:center;">个人防火墙产品的功能</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:center;">确认连接请求</td><td style="text-align:left;">向用户确认是否阻止特定的连接请求</td></tr><tr><td style="text-align:center;">安全日志</td><td style="text-align:left;">根据需要生成安全日志，记录 PC 正常连接与错误连接的信息。在做故障分析时，日志起到了很大的作用</td></tr><tr><td style="text-align:center;">反病毒功能</td><td style="text-align:left;">阻止 PC 接收病毒和蠕虫信息</td></tr><tr><td style="text-align:center;">反间谍功能</td><td style="text-align:left;">阻止 PC 接收间谍软件或程序的通信</td></tr><tr><td style="text-align:center;">个人信息保护功能</td><td style="text-align:left;">设置保护策略，防止个人信息被窃取、浏览恶意网站以及钓鱼诈骗等</td></tr></tbody></table><h4 id="网关防火墙" tabindex="-1"><a class="header-anchor" href="#网关防火墙"><span>网关防火墙</span></a></h4><p>在网络中的网关上配置防火墙的功能，能对网络中的流量进行策略控制，这就是网关防火墙。</p><p>网关防火墙分为两种，一种是在 Windows、Linux 等操作系统上安装并运行防火墙软件的软件网关防火墙，另一种是使用专用设备的硬件网关防火墙。</p><p>个人防火墙主要监控 PC 的通信流量，网关防火墙是监控网络中所有终端的通信流量，在网关处进行策略控制。</p><table><thead><tr><th style="text-align:center;">区别</th><th style="text-align:center;">个人防火墙</th><th style="text-align:center;">网关防火墙</th></tr></thead><tbody><tr><td style="text-align:center;">安装位置</td><td style="text-align:center;">用户的 PC 上</td><td style="text-align:center;">Windows或Linux等服务器上</td></tr><tr><td style="text-align:center;">网络中的位置</td><td style="text-align:center;">终端</td><td style="text-align:center;">网关</td></tr><tr><td style="text-align:center;">安装监控对象</td><td style="text-align:center;">流入终端的流量</td><td style="text-align:center;">经过网关的流量</td></tr><tr><td style="text-align:center;">加密通信</td><td style="text-align:center;">在终端上解密后检查</td><td style="text-align:center;">不能检查</td></tr><tr><td style="text-align:center;">压缩文件检查</td><td style="text-align:center;">解压后检查</td><td style="text-align:center;">对解压方式、解压基本有限制</td></tr><tr><td style="text-align:center;">口令文件检查</td><td style="text-align:center;">输入口令后解压检查</td><td style="text-align:center;">不能检查</td></tr></tbody></table><h3 id="硬件防火墙" tabindex="-1"><a class="header-anchor" href="#硬件防火墙"><span>硬件防火墙</span></a></h3><p>通过硬件设备实现的防火墙叫做硬件防火墙，外形跟路由器相似，接口类型通常有千兆网口、万兆光口。</p><figure><img src="/wsq-blog/assets/2-2-MDjT2xLx.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="防火墙技术类型" tabindex="-1"><a class="header-anchor" href="#防火墙技术类型"><span>防火墙技术类型</span></a></h2><p>防火墙在网络边界判断允许进行的通信和不允许的通信作为其判断依据的技术类型的演进：</p><ul><li>分组过滤型：没有防火墙设备时，可以由路由器实现。根据网络中的传输的 IP 分组头部和 TCP/IP 分组头部，获得源 IP 地址和端口号、目的 IP 地址和端口号，以这些信息作为过滤条件，决定是否转发这个分组。分组过滤会用到访问控制列表。</li><li>应用网关型：不以分组为单位进行通信过滤，而是特定的应用程序会话。</li><li>电路层网关型：在传输层进行连接中继，也就是第四层代理，通过 SOCKS 协议实现。内网终端连接外部网络时，终端与网关建立 TCP 连接，网关和外部服务器建立新的 TCP 连接。使用电路层网关，不用设置安全认证端口和 NAT，就可以让私有地址的内网终端访问外部网络。</li><li>状态检测型：动态分组过滤的一种，通过检测 TCP 的连接状态阻挡来路不明的分组，简称 SPI。可以抵抗下面类型的攻击：伪装 IP 地址或端口，发送附带 TCP 的 RST 或 FIN 标志位的分组，随意终止正常通信的攻击；在允许通信的范围内发送附带 TCP 的 ACK 标志位的分组，从而入侵内部网络；在 FTP 通信时，无论是否建立控制连接，都会创建数据连接进而入侵内部网络</li><li>新一代防火墙：根据上面的所有信息执行安全策略来进行防御，不仅根据端口号或协议号识别应用程序，还根据 IP 地址识别用户信息</li></ul><h3 id="代理服务器" tabindex="-1"><a class="header-anchor" href="#代理服务器"><span>代理服务器</span></a></h3><p>代理服务器是应用网关防火墙的一种。假设客户端和 HTTP 服务器通信时，客户端发送请求报文时，代理服务器会替代客户端向 HTTP 服务器发送请求；HTTP 服务器回复响应报文时，代理服务器会代替 HTTP 服务器向客户端回复。对于客户端来说，代理服务器就是 HTTP 服务器。客户端和代理服务器、代理服务器和 HTTP 服务器分别建立两个会话。</p><p>从客户端收到的请求报文、从服务器收到响应报文，代理服务器都会在应用层进行检查，如果有异常就放弃通信或发送出错信息。</p><p>由于代理服务器是会话的起点，对互联网的服务器来说，是看不到客户端的 IP 地址。</p><figure><img src="/wsq-blog/assets/2-3-DrVzrQ7x.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>报文过滤防火墙是以 IP 或 TCP/UDP 为对象，判断是否允许通信。而应用网关防火墙是以应用程序为对象，也就是将 FTP、HTTP、Telnet、DNS 等为对象进行判断。</p><h2 id="防火墙的接口模式" tabindex="-1"><a class="header-anchor" href="#防火墙的接口模式"><span>防火墙的接口模式</span></a></h2><p>防火墙有四种接口模式，分别是 L3 模式、L2 模式、L1 模式和 TAP 模式。</p><table><thead><tr><th style="text-align:center;">接口模式</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:center;">L3 模式</td><td style="text-align:left;">也叫做 NAT 模式，和路由器接口一样，是拥有 IP 地址的接口。使用路由选择、NAT 以及连接 IPSec VPN 或 SSL VPN 时，必须使用 L3 模式接口。接口可配置静态 IP 地址，也可通过 PPPoE、DHCP动态获取 IP 地址</td></tr><tr><td style="text-align:center;">L2 模式</td><td style="text-align:left;">也叫做透传模式或透明模式，和交换机一样，是进行交接的接口。进行 IP 地址分配时，需要使用 VLAN</td></tr><tr><td style="text-align:center;">L1 模式</td><td style="text-align:left;">也叫做虚拟线缆模式。把两个接口组成一组，流量在一个接口输入，在另一个接口输出。这种模式下无法进行路由和桥接</td></tr><tr><td style="text-align:center;">TAP 模式</td><td style="text-align:left;">与交换机镜像端口连接的模式。对交换机的数据帧进行检测。由于不是串联，无法阻止非法通信</td></tr></tbody></table><p>L1~L3 模式是将防火墙进行串连，TAP 模式是防火墙进行旁挂。</p><figure><img src="/wsq-blog/assets/2-4-DwUgqAh-.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="防火墙能防范的威胁" tabindex="-1"><a class="header-anchor" href="#防火墙能防范的威胁"><span>防火墙能防范的威胁</span></a></h2><ul><li>窃听：通过窃听网络数据获取银行卡号、密码等重要信息<br><img src="/wsq-blog/assets/2-5-DQtuk8hl.png" alt="" loading="lazy"></li><li>篡改：将网站主页、邮件等通信内容恶意修改<br><img src="/wsq-blog/assets/2-6-CY9miIf4.png" alt="" loading="lazy"></li><li>破坏：通过电脑病毒或DoS攻击等破坏系统的正常工作<br><img src="/wsq-blog/assets/2-7-BoNndD5m.png" alt="" loading="lazy"></li><li>冒充：冒充他人发送邮件，对接收方进行钓鱼、诈骗等行为<br><img src="/wsq-blog/assets/2-8-BQqDc_qg.png" alt="" loading="lazy"></li><li>信息泄露：电脑或服务器上的重要信息或文档泄露<br><img src="/wsq-blog/assets/2-9-EYFkbKWv.png" alt="" loading="lazy"></li><li>攻击跳板：作为病毒部署或DoS攻击的跳板<br><img src="/wsq-blog/assets/2-10-DEJzYnZg.png" alt="" loading="lazy"></li><li>垃圾邮件：以营利为目的发送大量邮件</li></ul><h2 id="防火墙功能" tabindex="-1"><a class="header-anchor" href="#防火墙功能"><span>防火墙功能</span></a></h2><p>防火墙常见的功能有：会话管理、报文结构解析、安全区域、安全策略、NAT、VPN、DoS 防御、报文攻击防御、内容扫描、监控和报告、报文抓包。</p><h3 id="会话管理" tabindex="-1"><a class="header-anchor" href="#会话管理"><span>会话管理</span></a></h3><p>会话是两个终端系统之间的逻辑连接，从开始到结束的通信过程。</p><p>在 TCP 中，客户端和服务器通信，使用 3 次握手建立 1 个 TCP 连接，客户端发送请求（ request ），服务器进行回应（ response ），直至结束的过程就是进行了 1 个会话通信。</p><p>在 UDP 中，客户端和服务器的源端口和目的端口一致，之后的一系列通信都叫做会话。</p><p>在 ICMP 中，Echo request 和对应的 Echo reply 组成 1 个会话。</p><p>数据流是一组有序，有起点和终点的数据序列。一个会话有两个数据流（ flow ）：一个是 “ 客户端到服务器 ”（ client to server ），另一个是 “ 服务器到客户端 ”（ server to client ）。</p><figure><img src="/wsq-blog/assets/2-11-Bi7GeH-u.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="tcp-连接管理" tabindex="-1"><a class="header-anchor" href="#tcp-连接管理"><span>TCP 连接管理</span></a></h3><p>在数据通信前，客户端发送一个 SYN 包作为建立连接的请求。如果服务器发来回应，则认为可以开始数据通信。如果未收到服务器的回应，就不会进行数据通信。在通信结束时，会使用 FIN 包进行断开连接的处理。</p><p>SYN 包和 FIN 包是通过 TCP 头部的控制字段来管理 TCP 连接。一个连接的建立与断开，正常过程至少需要来回发送 7 个包才能完成。建立一个 TCP 连接需要发送 3 个包，这个过程叫作三次握手。断开一个 TCP 连接需要发送 4 个包，这个过程也称作四次挥手。创建一个 TCP 连接，会产生一个 32 位随机序列号，因为每一个新的连接使用一个新的随机序列号。</p><figure><img src="/wsq-blog/assets/2-12-Ceh9omfP.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>SYN 检查<br> TCP 会话开始时，客户端会发送一个 SYN 消息。如果没有会话信息，或尚未建立会话，即非 SYN 消息的 TCP 数据段到达防火墙，防火墙会当做非法消息而丢弃。</li><li>ACK 检查<br> 通过对 SYN-ACK 的 ACK 消息检查，确认进行中的 3 次握手是否是非法尝试，防范 SYN Flood 攻击。</li><li>重复数据段检查<br> 防火墙收到重复数据段，也就是序列号相同的 TCP 数据段，可以选择接收或者丢弃。</li><li>窗口检查<br> 防火墙可以检测 TCP 头部的序列号和滑动窗口大小，拦截超过滑动窗口容量数据的序列号。</li><li>数据段重组<br> 防火墙可以验证 TCP 数据段序列号是否完整。</li></ul><h3 id="会话建立的处理" tabindex="-1"><a class="header-anchor" href="#会话建立的处理"><span>会话建立的处理</span></a></h3><ol><li>防火墙收到报文后，首先检查会话表，确认是否有相同的会话。如果有相同会话，那么会禁止会话建立，确保会话都是唯一的。</li><li>如果是不同会话，那么检查报文，通常是查看路由表或 MAC 地址表来确定转发路径。如果可以转发，就确定对应的转发出接口和目的网段。如果不能转发，就丢弃这个数据。</li><li>报文检查目的地址是否需要进行 NAT。如果需要，就先完成 NAT，然后转发到相应出接口和目的网段。</li><li>对报文和目的信息进行安全策略检查，源信息是源接口、源区域和源地址，目的信息是目的接口、目的区域和目的地址。如果有匹配的安全策略，就根据策略进行处理，允许通信就进行转发，拒绝通信就进行丢弃。如果没有匹配的安全策略，就根据默认拒绝的策略丢弃数据。</li><li>当报文被允许通信时，防火墙的会话表中就会生成相应的会话信息。</li></ol><h3 id="会话的生存时间" tabindex="-1"><a class="header-anchor" href="#会话的生存时间"><span>会话的生存时间</span></a></h3><p>自动生成的会话表信息，是有一定的生存时间。会话建立后，一段时间内一直没有进行通信，防火墙会删除生存时间到期的会话表项。如果长期保留会话表项，这些会话信息可能会被恶意攻击。同时，会话表是会占用防火墙资源，防火墙的会话表项的数量也是有限的，长期保留闲置的会话，会影响新会话的生成。</p><p>会话时间可以根据协议的不同，分别进行设置。</p><p>TCP 的话，会话的超时时间通常是 30 分钟到 1 小时，UDP 是 30 秒。比如，Telnet 连接在防火墙上建立会话后，如果在 1 个小时内没有任何数据通信，防火墙会自动删除这个会话表项。客户端无法再次使用这个 Telnet 会话了。</p><figure><img src="/wsq-blog/assets/2-13-D2_-ZURB.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="会话终止处理" tabindex="-1"><a class="header-anchor" href="#会话终止处理"><span>会话终止处理</span></a></h3><p>客户端完成数据传输后，发送 FIN 消息，即使用 FIN 标志位的 TCP 数据段。</p><p>服务器收到 FIN 消息后，在回复消息中，使用 FIN 和 ACK 标志位，并将 ACK 编号设置为“接收的 Seq 编号 + 1 ” 。</p><p>客户端相同处理方式，在回复消息中，使用 ACK 标志位，并将 ACK 编号设置为“接收的 Seq 编号 + 1 ” 。</p><p>如果客户端或服务器在连接过程发生故障，只有一方是侦听状态，这叫做半侦听或半关闭。如果通信恢复，接收到故障前的数据段，那么会回复 RST 消息，强制终止 TCP 连接。</p><p>当防火墙收到 FIN 或 RST 消息时，会启动一个 30 秒的定时器。即使 FIN → FIN-ACK → ACK 的终止过程没完成，防火墙也会强制删除会话表项。</p><figure><img src="/wsq-blog/assets/2-14-DAmqtQGN.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="udp-数据流的管理" tabindex="-1"><a class="header-anchor" href="#udp-数据流的管理"><span>UDP 数据流的管理</span></a></h3><p>UDP 不需要像 TCP 一样 3 次握手，客户端和服务器直接使用应用程序的 UDP 数据进行交互。</p><p>UDP 数据流是指源 IP 地址、源端口号、目的 IP 地址和目的端口号这 4 个参数都相同的一系列 UDP 数据。</p><figure><img src="/wsq-blog/assets/2-15-B0COp0hE.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>DNS 和 SNMP 这类应用程序，只需要 1 个 UDP 数据，就能构成 1 个数据流。</p><p>音频和视频使用的 RTP，就需要多个 UDP 数据，来构成 1 个数据流。</p><h3 id="管理-icmp-和-ip-数据流" tabindex="-1"><a class="header-anchor" href="#管理-icmp-和-ip-数据流"><span>管理 ICMP 和 IP 数据流</span></a></h3><p>像 ICMP 这类没有端口号的协议，是直接根据 IP 头部的协议号来生成会话。</p><p>防火墙通过识别 ICMP 不同的请求消息和对应的响应消息，来判断这些消息序列是否属于同一个会话。</p><figure><img src="/wsq-blog/assets/2-16-DJbjIvxR.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="会话同步" tabindex="-1"><a class="header-anchor" href="#会话同步"><span>会话同步</span></a></h3><p>通常两台防火墙会使用主备方式的冗余结构，对主防火墙和备防火墙的会话信息进行同步。主防火墙负责建立用户通信的会话，并把会话信息记录到会话表中，同时将信息转发到备防火墙。</p><h3 id="会话管理有什么防御功能" tabindex="-1"><a class="header-anchor" href="#会话管理有什么防御功能"><span>会话管理有什么防御功能？</span></a></h3><p>防火墙可以通过限制会话数量，能够防范 DoS 攻击，还能控制防火墙的负载，提高防火墙的性能。</p><p>防火墙可以以 TCP SYN 、UDP 、ICMP 等协议为单位，通过指定源与目的的组合方式，来限制这类会话的数目。</p><h4 id="分组结构解析" tabindex="-1"><a class="header-anchor" href="#分组结构解析"><span>分组结构解析</span></a></h4><p>为了防止非法报文的流入和流出，防火墙会对报文的头部和数据进行解析。常见的有：IP 头部解析、TCP 头部解析、UDP 头部解析。</p><h5 id="ip-头部解析" tabindex="-1"><a class="header-anchor" href="#ip-头部解析"><span>IP 头部解析</span></a></h5><figure><img src="/wsq-blog/assets/2-17-CdffaefG.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>数据帧和 IPv4 头部的解析内容如下：</p><ul><li>以太网类型与 IP 版本：以太网数据帧头部的类型字段为 0x0800 时表示 IPv4，同时 IPv4 头部的版本也是 4。类型字段为 0x86DD 时表示 IPv6，IP 头部的版本也是 6。</li><li>IP 头部：确认数据是否完整，并检查报文长度与实际长度是否一致。</li><li>IP 协议号、TTL ：检查字段值，如果值为 0 就丢弃报文。</li><li>源地址、目的地址：确认是否存在<code>LAND attack</code>。</li><li>数据总长度：确认是否存在<code>ping of death</code>攻击。</li><li>标志位、分片偏移：丢弃无法进行分片的报文。</li><li>可选项：丢弃无用可选项的报文。</li></ul><h5 id="tcp-头部解析" tabindex="-1"><a class="header-anchor" href="#tcp-头部解析"><span>TCP 头部解析</span></a></h5><figure><img src="/wsq-blog/assets/2-18-BPtFZ5Tb.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>TCP 头部的解析内容如下：</p><ul><li>TCP 头部：确认各个字段是否完整、是否有被中途截断。</li><li>数据偏移：确认数据偏移字段的值是否是 5 以下，TCP 头部长度最小是 5 字符 = 20 字节。</li><li>校验和：确认校验和是否错误。</li><li>端口号：确认源端口号和目的端口号是否为 0。</li><li>控制位：检查 SYN 、ACK 等字段是否存在组合不正确的情况。</li></ul><h5 id="udp-头部解析" tabindex="-1"><a class="header-anchor" href="#udp-头部解析"><span>UDP 头部解析</span></a></h5><figure><img src="/wsq-blog/assets/2-19-DkEeDBHZ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>UDP 头部的解析内容如下：</p><ul><li>UDP 头部：确认各个字段是否完整、是否有被中途截断。</li><li>校验和：确认校验和是否错误。</li></ul><h2 id="安全区域" tabindex="-1"><a class="header-anchor" href="#安全区域"><span>安全区域</span></a></h2><p>安全区域（<code>Security Zone</code>），简称区域（<code>Zone</code>），是一个安全概念，许多安全策略都基于安全区域实施。</p><p>我们在防火墙上创建安全区域，并且定义该安全区域的安全级别（也被称为优先级，通过 1～100 的数字表示，数字越大安全级别越高），然后将防火墙的接口关联到一个安全区域，那么该接口所连接的网络就属于这个安全区域。属于同一个安全区域的用户具有相同的安全属性。</p><p>在同一个区域内，可以自由进行通信，但是跨区域通信，必须符合安全策略才行。当然，防火墙也可以设置安全策略，根据源或目的地址等条件，判断在同一区域内能否允许通信。</p><figure><img src="/wsq-blog/assets/6-FzeiuIJT.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="默认安全区域" tabindex="-1"><a class="header-anchor" href="#默认安全区域"><span>默认安全区域</span></a></h3><p>防火墙划分了 4 个默认的安全区域：</p><table><thead><tr><th style="text-align:center;">安全区域</th><th style="text-align:left;">说明</th><th style="text-align:center;">优先级</th></tr></thead><tbody><tr><td style="text-align:center;">受信区域（<code>trust</code>）</td><td style="text-align:left;">通常将内网用户所在区域划分为<code>trust</code>区域</td><td style="text-align:center;">85</td></tr><tr><td style="text-align:center;">非受信区域（<code>untrust</code>）</td><td style="text-align:left;">通常将<code>Internet</code>等不安全的网络划分为<code>untrust</code>区域</td><td style="text-align:center;">5</td></tr><tr><td style="text-align:center;">非军事化区域（<code>dmz</code>）</td><td style="text-align:left;">通常将内网服务器所在区域划分为<code>DMZ</code>区域，因为这些服务器虽然部署在内网，但是经常需要被外网访问，存在一定的安全隐患，同时一般又不允许其主动访问外网，所以将其部署一个安全级别比Trust低，但比Untrust高的安全区域中。</td><td style="text-align:center;">50</td></tr><tr><td style="text-align:center;">本地区域（<code>local</code>）</td><td style="text-align:left;">设备本身，包括设备的各接口本身，凡是由防火墙自身构造并主动发出的报文均可认为是从Local区域中发出，凡是目的地为防火墙的报文均可认为是由Local区域接收。用户不能改变Local区域本身的任何配置，包括向其中添加接口</td><td style="text-align:center;">100</td></tr></tbody></table><p>默认的安全区域不能够删除，每个安全区域都设置了固定的优先级。优先级值越大，优先级越高。</p><p>除了这四个域之外，用户也可以根据自己的需求创建自定义域。自定义的域的优先级是可以自己调节的。</p><h3 id="local区域" tabindex="-1"><a class="header-anchor" href="#local区域"><span>Local区域</span></a></h3><figure><img src="/wsq-blog/assets/area-3-qj8XAa4L.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>在上图中，防火墙的<code>GE0/0/1</code>接口被添加到<code>Trust</code>安全区域，<code>GE0/0/3</code>接口被添加到<code>Untust</code>区域。PC1 发往<code>192.168.1.254</code>的流量，被认为是从<code>Trust</code>区域到<code>Local</code>区域的流量（该流量的目的地就防火墙自身）；PC1 访问 PC2 的流量，被认为是从<code>Trust</code>区域到<code>Untrust</code>区域的流量；从防火墙直接访问（例如<code>ping</code>）PC1 的流量，则被认为是从<code>Local</code>区域到<code>Trust</code>区域的流量。</p><h3 id="安全区域的规划" tabindex="-1"><a class="header-anchor" href="#安全区域的规划"><span>安全区域的规划</span></a></h3><ul><li>用户可自定义安全区域，也可使用系统自带的安全区域，防火墙的一个接口只能属于一个特定区域，而一个区域可以包含多个接口，接口只有划分到区域中才能正常处理报文。</li><li>内部网络应安排在安全级别较高的区域。外部网络应安排在安全级别最低的区域。</li><li>一些可对外部用户提供有条件服务的网络应安排在安全级别中等的 DMZ 区域。</li></ul><h3 id="安全区域的限制或注意事项" tabindex="-1"><a class="header-anchor" href="#安全区域的限制或注意事项"><span>安全区域的限制或注意事项</span></a></h3><ul><li>在一台防火墙上不允许创建两个相同安全级别的安全区域；</li><li>防火墙的接口必须加入一个安全区域，否则不能正常转发流量。</li><li>防火墙的一个接口只能属于一个安全区域；</li><li>防火墙的一个安全区域可以拥有多个接口；</li><li>系统自带的缺省安全区域不能删除，用户可以根据实际需求创建自定义的安全区域；</li></ul><h2 id="inbound及outbound" tabindex="-1"><a class="header-anchor" href="#inbound及outbound"><span>Inbound及Outbound</span></a></h2><figure><img src="/wsq-blog/assets/inbound-outbound-jvCQXMTd.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>安全域间的数据流动具有方向性，包括入方向和出方向：</p><ul><li>入方向（<code>inbound</code>）：数据由低级别安全区域向高级别安全区域传输的方向；</li><li>出方向（<code>outbound</code>）：数据由高级别安全区域向低级别安全区域传输的方向。</li></ul><h2 id="安全策略" tabindex="-1"><a class="header-anchor" href="#安全策略"><span>安全策略</span></a></h2><p>防火墙的主要功能是访问控制，也就是判断特定源和特定目的之间是否允许进行特定的通信。访问控制是通过规则来实现，每一条规则都指定了源、目的和通信内容等信息。这些访问控制规则的集合，在路由器中，叫做访问控制列表，而在防火墙中，叫做安全策略或安全规则。</p><h3 id="什么是安全策略" tabindex="-1"><a class="header-anchor" href="#什么是安全策略"><span>什么是安全策略</span></a></h3><p>安全策略是防火墙中对流量转发、以及对流量中的内容进行安全一体化检测的策略。</p><p>当防火墙收到流量后，会对流量的属性（包括五元组、用户、时间段等）进行识别，从而和安全策略进行匹配，如果能够匹配上，则执行相应的动作。</p><figure><img src="/wsq-blog/assets/8-Dt7qm9eP.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>如上图所示：PC 访问<code>internet</code>，匹配到防火墙安全策略，动作为<code>permit</code>，因此流量可以通过防火墙。如果动作为<code>deny</code>，则流量不能够通过防火墙。</p><h3 id="防火墙的安全策略" tabindex="-1"><a class="header-anchor" href="#防火墙的安全策略"><span>防火墙的安全策略</span></a></h3><p>防火墙的安全策略以区域作为对象，还可以以应用程序名称和用户名称等信息作为对象。</p><figure><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgkAAAChCAMAAAB6bNxgAAABAlBMVEX////6+vr7+vb29vb19fXy8vL/8szt7e3v7ebv7Obs7Oz26cXn5+fm5ubk5OTj4+Ps4L3f39/a2trY2Njj17bW1tbi1rXf07PQ0NDPz8/Yza3JycnFxcXExMTPxKa/v7+9vb28vLzEup23t7e1tbW/tZm6sZWwsLCqqqqpqamwp42kpKSenp6lnYSknIOZmZmYmJieln+Tk5OZkXqOjo6IiIiOh3KDg4OCgoJ9fX2Ce2h3d3d1dXVwcHB1b15ra2tnZ2djY2NnYlJdXV1cXFxYWFhXV1dVVVVUVFRYVEZLS0tHR0dGRkZERERHQzlDQ0NGQjgzMzMvLy8tLS0vLSYAAABlV+ZMAAAOGElEQVR42u2cDXfbthWGuZGTXKia1LLaVFVoIrZdNFOlt5lLIMqxIbpqmshmY5n4/39l5wKgSMeUS5Cs7bPe95zogxJfXQAPLi7QU1s/NNDff2hXz93vucfcKBbrhw4K1ekgCSgkAYUkoJAEFJKAQhJQSAIKSUAhCSgkAYUkoJAEFJKAehwSerHw5AtPaHmVPb10Euibokkq9gbDJIKPg+Q47lW0irKbIwgpGaqHTkPX0kg7Edw/TALplk7UxzW69EDMhv4HXHpx1MkeK7YxHsZ6AL2454nAgIReLPIwPIWAZ0DC34L0PBmqaCdp/sv7MfsxrWoWyT5Ud8qHSdqCa2mkMFJR/FULJJTHbOh/yCVIJ17yVRx56WSYZMOkvnuIKC9/HR0ex3ISCsTVIEHNUIgwnUzSIJJUe7JBWYaJzXtV3hrIqRI0dC2N9PcgoRhzfRKKLpEQ6alQEQ8TlQV1zim3Kf5ELz4+NSUh2LNWY3UI4l6QHKeTzuTjZJKeemnci0Tcy/AMHiD4gRzpwUJwngaQEBq6lkaajdR5mk7gZ4+ToPHqUIzZ0P+QS0FVSOh0Ju89tZbG/96n+rLfPZQTvLjXCUTUqaNJHJ8WcoJc1dUaCbM3OU69JKgzv7xh8j6edCap19C1NNKsYIj/kU5gzg6TwJNzuVFOyGM29D/gEkVeohfvoBIJw0T+hLZTOSIwISGCFBwVSwaj3FvICQHwLX8axiz+9v1xelp5rt3LkV6UkdDAtTTSffb28pFqZ3VQMRv6H3Dx4tO4J+2q5YRJqljb231MAzMSOoGacVlBZtYXUVTMCYGIE/jt/Zh9jOpm2tNYeJ7wGrqWRtoeCeUxm5JwoOUfP0aRQU6IXidFEjzx+lwEUdn3y0gYJq+TfRj7DVv1OqEXR7Bjku2cpEGgXLwsj3tp9Q7+NEcGwyQ5liQ0cS2NNBspOQNaywl5zIb+h1x6cRBF0Wl8nFRdHQokDJNk2Iu+rUyCyj0BTGjvky1EtdU3fZ1EE8jXcQ9eQyiT80mWXoZJEMR1e7UTBDInNHItjbQTifgc5mwvhoQjXrdGgorZ0P+QyzBJ4rokDBM1ilHZyUsZCWrnEaSTAjuBQad46ak4Tt7/mL6GKj8oHlPoQu80qpNpdX3lqTWngWtppLAR0Yc/USTaWh3ymA39D7okwzwnVDhPUCT0Ykh9uj6Vb6rlhHO5N9t/PdBHXdUnhRcdx6ciGQbFM8ZIWyVeKrz6mfbOklXPtTTS/EBVTYTaZxQHYjb0f8AFjlI6EVysmBM8tbgfJ546ni0FEP+7AwpJQCEJKCQBhSSgkAQUkoBCElBIAgpJQCEJKCQBhSSgkATU70PC0WdHR0fqofCsXn5WfF+iPx9V0WdHVfU0fs3UesxNxqPBvUfWCwuFsqwXSAIKSUAhCSgkAYUkoJAEFJKAQhJQSAIKSUAhCSgkAYUkoJAE1BOQwPyaxjv5/4Tfu5tsXFMn98otBlLmUMnVZ/AgBLMsKoSgmf2GWBbZip0rr7NPW+7u5DXKbC4Et+VHzCB8m7MWxqmui7qP8i6nzUhgwq8dvK+67bmQ4EsEdq7NfcKJRbdED/SWWDb3Lcpt9wo+vdtysqXyGqO+b6lPqTAZFco5aU5CXRd1X2MSbM5YQxLYz8Jn0IXUYkLAvNrVJcHmmcOY/yxecioBqOrK+AlTeYFKQslWdg3dvdoQyz2T0AIdar7nLYeU4XPbPnOzNhFuND8ZBSe62YidCz/tntXpzLou+j5JgrsTWwJ9Bu3hj7Y6ZCRw21IkUNmdDXKCzblNd+AAKc9WJBi4+hkJMhsoVz3U9IzD6pDN/2LLodvplmhWgBPmm6wOhMt7qaA2Z3IY6vRoXZfsPiCBbH0YDkatkBPy+CTIrtMkNFsdYJDIRpHgF0gwqRPozrUYkJCPuCRBUDXdt/vyIWu5r0hQPQ8QuWe2CQmUWZBP4E6fWYzq5GKa5Gu6ZPcBCdBQ98r1mX1yQil7dBL8jAQo1vxmJNA9CTQjwcBVVoywmHC7WIBJEiDfXrn56nAvJzBqKY6gY01IYKpwBhufWZTp5GK6ONR02d/X5RRaRzaue/Z1SP37OeWRSFCrss1pDRLkLTYvIUExUtXVZ/tnSJRFEvR0Yfu1I2+5qhP+CnWXDx+5clPEjDB2N0SPIeFhnQ6t65Lfl+cEm73yXXY/pzwKCdymgvoyUdUgQc5fWfTfJYFZ/s41cNXV4p1iQA+1LGi5LXNCtuNhxb0DLTJikhNkJ5At1WNosZ1btytruOT35XWCFV5Rm93PKY9BAtmKM05hOw7LhPHewYI7IS8rEmy+G8OWyN2JEN5Vds1WB1/Pa51JsvMEGGdfwJNqs85m6jwBkqnMtJITAxIUc4y/1GNIeZ3Foa5Lft9+76B3SD6eMT6xGsys1l2QhKcTbISfiwuSgEISUEgCCklAIQkoJAGFJKCQBBSSgEISUEgCCklAIQmo35uEzxvoL5+3q+fu99xjbhSL9Z2DQjnOd0gCCklAIQkoJAGFJKCQBBSSgEISUEgCCklAIQkoJAGFJKCQBNRjk9Bd3dysuvWMb+XfY1x8ennwbmzqNP4VblkuHnCo5LpYwoMQS8eZCSFmmf27geMMrsXtWF5fyotkLcSaqM9v5bXZMr+2XBqE312FrYxUd3XzYeQ4/UuDIelf3tzc3EybkzCfO93VvG7oC92Vz4SEhUTgdkzWi8F64MyuB3qgrwcOWS+c2ZqMf4VP5ZcXjn41uJ7JV8vZ/tpMmJAwXa36bZAQhs70sg/jEYbVSZg6zujDtDEJkoZVIxKWv4jFErpw5iyFgHl1W5cEss4cvln/Ir5fzyQAVV2X6/8sVV6YSUIH1zIpzG7/+W7gjN9KaIGOfL4rkiFlLNaEvB1n1wbrtQkJ4TScO8704uLmw2i66jqjNzVTwtwZ/TTqX4wACBMSnPmq60whu3dX4c1N6EA887kxCWHYjIQ1cRQJM9mdDXICWa/J7BYcyHop2Rq8Gxu4LjISZDZQrnqoZ2/XsDpk81+zI8cbuJldDzQrcG25MFkd+qv+6A2MxLS7CmEc5zWT7HzVnV72Rxd9AMKIhNFFf/TTqLsKu6tVdyp57L4ZmZJQnb8DJMiu0yQ0Wx1gkAbvFAmLAgkmdcLsduwsgYR8xCUJYqam+/W+fMiWj4UiYbHIro3fEhMSpqED3Q79OA+dcFoyBlVRgAIBfGqQINPCqr+aO/2LkYbTjITph7pxZyQsMhKgWFs0I2G2J2GWkWDgKitGWEzWxCF5gpckrAn8THF1AGYKOWE509dgmTAhIYSabe7AujAPnWlYMgYmq0OdnDC97M8hissvVlMgwQmnJYnpYRLmlw2KnSIJalUm61kNEuQtZF1CgmKkqutiuX8eXOebGiBB/vt1vFzmqUAXlLpO+HI90NfGclNUGQU5aqOLviahv/pXzcUBjLqrec06YR4qmhQJ0zclielBEqZNQCiQsCYzMVssnXp1gpy/sui/S8LSWdyODVx1tXi3GFBDLQvaNZE5QS432c4i2zvMlsVrBjkB0jIMiCbBCesmWZkTPkxr7h2Ao3DV1yT0L0s2og+SIDPbqjEJg2vxdj2D7TgsE8Z7B7m5h7ysSCDr22/WMzk5/wvvKrtmq8NCz2udSbLzBBjnhYCn5QK+BocHEL08T4AyQV8zI0FtwsPVC03CtO75jDwbmNc+T5je3MAWVJEgdw94xvi0CufPIAhJA5LwlIJt3NNHMfowd5AEVO0zRhSSgEISUEgCCklAIQnYCSgkAYUkoJAEFJKAQhJQSAKqMgndBvpTt109d7/nHnOjWPBvtKLwr/WikAQUkoBCElBIAgpJQCEJKCQBhSSgkAQUkoBCElBIAgpJQD0RCUwI39jSvXLh1uxGsnHvfaXs2m+IbOHPF1DLooLJt1tC5Z98ZK30g81Zm93qbogMmdv6gr+3L3tVLUKxc++aVm4X5V1Om5BAmUW29LmQQC3L3VGLXkEvq0erTnzlTeWctAjCbkssm/sW04Pt74Ete1VJjFl0S4qm1dvVmASrOKLGJNicCcEA5TH/WbzkVAKQXatFguVzm/IzalnsRJIAHdOKGIWG0s1G7FzKbcs9a4LV7tWGyNbSreSL8RM9emWvKk5uH3q2YGrSLkmCuxNbAgY+t21uSkKDnGBzbtMdxA4pylYkUG7bZ27dnABZl0IPEk4lCb5JpnzInRP3zLaooDZnsrOaEQarg/x35ba1OsAk2JI7ptXbBSSQrW8xbjNqhZwQUxJ8Yd7VOQk+jL0kwS+Q0GB1UCR8vSGUyZXYZHY8PIuZZZ+p2eYzi1F405QEMGuRBDUWd0yrtwtI0BD5zD45oZQZrw4+r08C3ZNAMxIsH4rQ2iTQLaGcnLnMd3X+bWlxgNrTt4BTn1mUwUR6XjlBrw6GOWHfri6nABHZuO7Z1yH17+e83ySBbo3HDMbH5iUkqCbYnNYmQdYJth9uoEtaKxJUYDLfSBIIDxs6u3frhBZIgBBt7pvVCXm78pxgs1e+y+7nvAdJgFCZ8e5Kblzozv2UBGb5O9eX6arR3oHbVHDb3RC/tY2fLDfIlmoSLLZzm5Nwp8xvJyfsqNneIW9XXidY4RW12f2c95vnCTVKMpsL2PpqEmy+G3M5iiKEd5CtbF5j75CdJ3Ab2uRuvpRXBG+BBJVcGH+pSaBNC9HCeYKrSltmlb4y6wDf8Dwhb9d+76CKq5IdIZ4xtrN1/n8/Y/xjCra/SALqjyokAYUkoJAEFJKAQhJQSAIKSUAhCSgkAYUkoJAEFJKAapGEBvriRbt67n7PPeZGsfwPD4rjhCIJSRwAAAAASUVORK5CYII=" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>举个栗子：在上图的安全策略中，<code>192.168.2.1</code>从信任区域向不信任区域的 80 端口通信时，防火墙首先执行第 1 条安全策略，发现源地址不匹配，不执行<code>Allow</code>。接着执行第 2 条安全策略，发现地址和端口匹配，执行<code>Deny</code>，也就是拒绝通信。防火墙的安全策略从上往下依次执行的行为，也叫做安全策略查找（<code>policy lookup</code>）。</p><p><code>Any</code>表示任何值都与策略匹配。如果是安全策略中，出现未定义的通信，比如从信任区到 DMZ 区域的通信，防火墙默认执行拒绝，这个策略叫做 “默认拒绝”（<code>implicit deny</code>）。</p><p>如果需要在防火墙没有匹配的情况下，执行<code>Allow</code>，可以在安全策略的最后一行设置对象为<code>Any</code>，行为为<code>Allow</code>的策略。</p><figure><img src="/wsq-blog/assets/22-DasjuXCe.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="安全策略组成" tabindex="-1"><a class="header-anchor" href="#安全策略组成"><span>安全策略组成</span></a></h3><p>安全策略由匹配条件、动作、安全配置文件组成。</p><figure><img src="/wsq-blog/assets/9-B_I4DT7g.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol><li>匹配条件：<br> 匹配条件包括五元组（源地址、目的地址、源端口、目的端口、协议）、VLAN、源安全区域、目的安全区域、用户、时间段等。</li><li>动作：动作包括允许和禁止。<br><img src="/wsq-blog/assets/10-mrmv-BNR.png" alt="" loading="lazy"><br> 如果动作为“允许”：</li></ol><ul><li>如果没有配置内容安全检测，则允许流量通过。</li><li>如果配置内容安全检测，最终根据内容安全检测的结论来判断是否对流量进行放行。<br> 禁止：表示拒绝符合条件的流量通过。</li><li>如果动作为“禁止”，防火墙不仅可以将报文丢弃；</li><li>还可以针对不同的报文类型选择发送对应的反馈报文。发起连接请求的客户端/服务器收到防火墙发送的阻断报文后，可以快速结束会话并让用户感知到请求被阻断。</li></ul><ol start="3"><li>安全配置文件：内容安全检测包括反病毒、入侵防御等，它是通过在安全策略中引用安全配置文件实现的。</li></ol><ul><li>如果其中一个安全配置文件阻断该流量，则防火墙阻断该流量。</li><li>如果所有的安全配置文件都允许该流量转发，则防火墙允许该流量转发。</li></ul><h3 id="安全策略匹配过程" tabindex="-1"><a class="header-anchor" href="#安全策略匹配过程"><span>安全策略匹配过程</span></a></h3><p>防火墙的安全策略一般配置很多条，如果都可以匹配应该优先匹配哪一条呢?</p><p>安全策略的匹配按照策略列表顺序执行，从上往下逐条匹配，如果匹配了某条策略，将不再往下匹配。</p><figure><img src="/wsq-blog/assets/11-LKUVpIdP.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>因此，配置安全策略的顺序很重要，需要优先配置精确的安全策略，然后再配置粗略的安全策略。</p><figure><img src="/wsq-blog/assets/12-BZbRJyOh.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>系统默认存在一条缺省安全策略<code>default</code>。</p><p>缺省安全策略位于策略列表的最底部，优先级最低，所有匹配条件均为<code>any</code>，动作默认为禁止。如果所有配置的策略都未匹配，则将匹配缺省安全策略<code>default</code>。</p><h3 id="会话表" tabindex="-1"><a class="header-anchor" href="#会话表"><span>会话表</span></a></h3><p>会话表用来记录 TCP、UDP、ICMP 等协议连接状态的表项，是防火墙转发报文的重要依据；</p><p>那么什么是基于连接状态转发报文呢？防火墙基于“状态”转发报文：</p><ol><li>只对首包或者少量报文进行检测然后确认一个连接状态；（会话表）</li><li>后续大量的报文根据连接状态进行控制；</li></ol><p>会话表就记录了大量的连接状态；这种机制大大的提升了防火墙的检测和转发效率。</p><figure><img src="/wsq-blog/assets/13-8P0K6GjR.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>如上图所示：客户端 PC1 访问服务器 PC2，PC1 向 PC2 发起 HTTP 连接；</p><ol><li>PC1发送报文；</li><li>首包达到防火墙，创建会话表项（如下）；防火墙会话表中标示出<code>http</code>协议和连接信息，并识别出此流量在公共路由表中被转发；</li></ol><div class="language-" data-highlighter="shiki" data-ext="" data-title="" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span>http VPN: public-&gt;public 192.168.1.254:10000-&gt;10.10.1.254:80</span></span></code></pre></div><ol start="3"><li>防火墙放行报文；</li><li>PC2 回复报文；</li><li>回复报文匹配防火墙会话；</li><li>防火墙转发报文；</li></ol><h4 id="会话表的创建" tabindex="-1"><a class="header-anchor" href="#会话表的创建"><span>会话表的创建</span></a></h4><p>防火墙在开启状态检测情况下，只有首包会创建会话表项，后续报文匹配会话表即可转发。</p><figure><img src="/wsq-blog/assets/14-BaTmGRMU.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="会话表老化时间" tabindex="-1"><a class="header-anchor" href="#会话表老化时间"><span>会话表老化时间</span></a></h4><p>当流量的第一个报文被防火墙转发时，防火墙会会话表老化时间决定一条会话在没有相应的报文匹配的情况下，何时被系统删除。当缺省的会话表老化时间不能满足现有网络的需求时，才需要重新设置。</p><p>对于一个已经建立的会话表表项，只有当它不断被报文匹配才有存在的必要。如果长时间没有报文匹配，则说明可能通信双方已经断开了连接，不再需要该条会话表项了。此时，为了节约系统资源，系统会在一条表项连续未被匹配一段时间后，将其删除，即会话表项已经老化。</p><p>如果在会话表项老化之后，又有和这条表项相同的五元组的报文通过，则系统会重新根据安全策略决定是否为其建立会话表项。如果不能建立会话表项，则这个报文是不能被转发的。</p><p>通常情况下，可以直接使用系统缺省的会话表老化时间。如果需要修改，需要首先对实际网络中流量的类型和连接数作出估计和判断。对于某些需要进行长时间连接的特殊业务，建议配置长连接功能，而不是通过以下命令将一种协议类型的流量的老化时间全部延长。</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">[FW] firewall session aging-time service-set session-type aging-time</span></span></code></pre></div><p>使用上述命令修改某个特定服务的会话超时时间。例如命令：<code>firewall session aging-time service-set ftp 1200</code>，这条命令会针对所有 FTP 流量生效，将表项的老化时间修改为 1200s。该命令需谨慎配置。</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">[FW] display firewall session aging-time</span></span></code></pre></div><p>使用上述命令查看当前系统中各类会话表项的老化时间。</p><h4 id="长连接" tabindex="-1"><a class="header-anchor" href="#长连接"><span>长连接</span></a></h4><p>防火墙采用会话表来管理数据流，通过首包创建会话表项后，后续报文如果命中会话表项，则根据该表项进行转发。如果某个报文既不是首包，又没有命中会话就会被丢弃。而为了保证网络安全以及会话资源的合理利用，设备上的各种会话缺省老化时间都相对较短，一般只有几分钟。当一个TCP会话的两个连续报文到达设备的时间间隔大于该会话的老化时间时，设备将从会话表中删除相应会话信息。后续报文到达设备后，设备根据自身的转发机制，将丢弃该报文，导致连接中断。</p><p>在某些实际应用中，一个 TCP 会话的两个连续报文可能间隔时间很长。例如：</p><ul><li>用户通过 FTP 下载大文件，需要间隔很长时间才会在控制通道继续发送控制报文。</li><li>用户需要查询数据库服务器上的数据，这些查询操作的时间间隔远大于 TCP 的会话老化时间。</li></ul><p>为了解决这个问题，在安全域间配置长连接功能，可以对特定的数据流设置超长老化时间，保证这些应用的会话表表项不被删除，这样当这些会话的报文长时间没有到达设备后再次到达时，仍然能够通过设备。从而使这些应用不被中断。</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">[FW]security-policy</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security]rule name a1</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-a1] </span><span style="color:#BDC4CC;"># 此处省略用户定义的条件</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-a1]long-link enable</span></span></code></pre></div><h3 id="server-map" tabindex="-1"><a class="header-anchor" href="#server-map"><span>Server-map</span></a></h3><h4 id="为什么会出现server-map表" tabindex="-1"><a class="header-anchor" href="#为什么会出现server-map表"><span>为什么会出现server-map表？</span></a></h4><p>由于会话表对哪些报文属于同一条流量的标准过于严格，会导致一些特殊协议不能正确匹配会话表。</p><p><code>Server-map</code>表可以解决这一问题。</p><figure><img src="/wsq-blog/assets/15-CS-1aYu_.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>例如使用 FTP 协议的<code>port</code>方式传输文件时：</p><ul><li>既需要客户端主动向服务器端发起控制连接；</li><li>又需要服务器端主动向客户端发起服务器数据连接；</li></ul><p>如果设备上配置的安全策略为允许单方向上报文主动通过，则 FTP 文件传输不能成功。</p><h4 id="server-map表原理" tabindex="-1"><a class="header-anchor" href="#server-map表原理"><span>server-map表原理</span></a></h4><p>通常情况下，如果在设备上配置严格的安全策略，那么设备将只允许内网用户单方向主动访问外网。</p><p>为了解决这一类问题，防火墙引入了<code>Server-map</code>表，<code>Server-map</code>用于存放一种映射关系。</p><ul><li>这种映射关系可以是控制数据协商出来的数据连接关系；</li><li>也可以是配置 NAT 中的地址映射关系；</li></ul><p>使得外部网络能透过设备主动访问内部网络。</p><p>生成<code>Server-map</code>表之后，如果一个数据连接匹配了<code>Server-map</code>表项，那么就能够被设备正常转发，并在匹配<code>Server-map</code>表后创建会话，保证后续报文能够按照会话表转发。</p><h4 id="server-map表报文转发过程" tabindex="-1"><a class="header-anchor" href="#server-map表报文转发过程"><span>server-map表报文转发过程</span></a></h4><p>防火墙收到报文后，如果没有命中会话表，防火墙则进入首包处理流程，查询是否命中<code>server-map</code>表。</p><ul><li>如果命中，则生成会话表，转发报文；</li><li>如果没有命中，则执行其他包处理流程。</li></ul><figure><img src="/wsq-blog/assets/16-BxUomR_C.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="防火墙应用场景" tabindex="-1"><a class="header-anchor" href="#防火墙应用场景"><span>防火墙应用场景</span></a></h2><h3 id="企业边界防护" tabindex="-1"><a class="header-anchor" href="#企业边界防护"><span>企业边界防护</span></a></h3><p>如下图所示，企业内网业务部署在<code>trust</code>区，服务器部署在 DMZ。</p><ul><li>企业内网访问<code>internet</code>时经过防火墙，防火墙控制内外网流量，进行安全控制；</li><li>外网用户访问服务器时经过防火墙，对内网服务器进行保护；</li></ul><figure><img src="/wsq-blog/assets/3-BDAaDzFa.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="内网安全隔离" tabindex="-1"><a class="header-anchor" href="#内网安全隔离"><span>内网安全隔离</span></a></h3><p>如下图所示：公司分为市场部、生产部，财经部，研发部，不同部分之间互访经过防火墙。通过防火墙进行安全控制。</p><figure><img src="/wsq-blog/assets/4-Drm8NCz2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="数据中心边界防护" tabindex="-1"><a class="header-anchor" href="#数据中心边界防护"><span>数据中心边界防护</span></a></h3><p>数据中心网络访问<code>internet</code>时，需要经过防火墙进行安全控制，对内网业务进行安全保护。</p><figure><img src="/wsq-blog/assets/5-DOXkM8DL.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="防火墙和交换机、路由器区别" tabindex="-1"><a class="header-anchor" href="#防火墙和交换机、路由器区别"><span>防火墙和交换机、路由器区别</span></a></h2><figure><img src="/wsq-blog/assets/23-BbTDwVC8.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>交换机的作用是接入终端和汇聚内部路由，负责二三层报文的转，发构建一个内部的园区网络</li><li>路由器的作用是路由寻址和转发，构建外部连接网络</li><li>防火墙的作用是流量控制和安全防护，区分和隔离不同安全区域</li></ul><h3 id="防护墙和路由器的转发流程对比" tabindex="-1"><a class="header-anchor" href="#防护墙和路由器的转发流程对比"><span>防护墙和路由器的转发流程对比</span></a></h3><figure><img src="/wsq-blog/assets/24-Dl4z-qFB.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="/wsq-blog/assets/25-DxokIvtY.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>以框式设备为例，硬件上除了接口、LPU、交换网板的等外，还有防火墙特有的 SPU，用于实现防火墙的安全功能。</p><div class="markmap-wrapper"><svg class="markmap-svg" id="markmap-1244"></svg><div class="loading-icon-wrapper markmap-loading" style="display:flex;align-items:center;justify-content:center;height:360px;"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><h2 id="防火墙配置" tabindex="-1"><a class="header-anchor" href="#防火墙配置"><span>防火墙配置</span></a></h2><h3 id="防火墙基础配置" tabindex="-1"><a class="header-anchor" href="#防火墙基础配置"><span>防火墙基础配置</span></a></h3><h4 id="网络拓扑" tabindex="-1"><a class="header-anchor" href="#网络拓扑"><span>网络拓扑</span></a></h4><figure><img src="/wsq-blog/assets/firewall-1-H7mVpeda.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="实验步骤" tabindex="-1"><a class="header-anchor" href="#实验步骤"><span>实验步骤</span></a></h4><ol><li>完成接口配置，并将防火墙的接口添加到相应的安全区域。</li></ol><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">[FW]interface GigabitEthernet 1/0/1</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-GigabitEthernet1/0/1]ip address 192.168.1.254 24</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-GigabitEthernet1/0/1]quit</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW]interface GigabitEthernet 1/0/2</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-GigabitEthernet1/0/2]ip address 172.16.1.254 24</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-GigabitEthernet1/0/2]quit</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW]interface GigabitEthernet 1/0/3</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-GigabitEthernet1/0/3]ip address 10.1.1.254 24</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-GigabitEthernet1/0/3]quit</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW]firewall zone </span><span style="color:#FF9492;">?</span></span>
<span class="line"><span style="color:#FFB757;">  dmz</span><span style="color:#ADDCFF;">      Specify</span><span style="color:#ADDCFF;"> dmz</span><span style="color:#ADDCFF;"> security</span><span style="color:#ADDCFF;"> zone</span></span>
<span class="line"><span style="color:#FF9492;">  local</span><span style="color:#F0F3F6;">    Specify local security zone</span></span>
<span class="line"><span style="color:#FFB757;">  name</span><span style="color:#ADDCFF;">     Indicate</span><span style="color:#ADDCFF;"> a</span><span style="color:#ADDCFF;"> security</span><span style="color:#ADDCFF;"> zone</span><span style="color:#ADDCFF;"> name</span><span style="color:#ADDCFF;"> to</span><span style="color:#ADDCFF;"> be</span><span style="color:#ADDCFF;"> created</span><span style="color:#ADDCFF;"> or</span><span style="color:#ADDCFF;"> deleted</span></span>
<span class="line"><span style="color:#FFB757;">  trust</span><span style="color:#ADDCFF;">    Specify</span><span style="color:#ADDCFF;"> trust</span><span style="color:#ADDCFF;"> security</span><span style="color:#ADDCFF;"> zone</span></span>
<span class="line"><span style="color:#FFB757;">  untrust</span><span style="color:#ADDCFF;">  Specify</span><span style="color:#ADDCFF;"> untrust</span><span style="color:#ADDCFF;"> security</span><span style="color:#ADDCFF;"> zone</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F0F3F6;">[FW]firewall zone trust</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-zone-trust]add </span><span style="color:#FF9492;">?</span></span>
<span class="line"><span style="color:#FFB757;">  interface</span><span style="color:#ADDCFF;">  Enter</span><span style="color:#ADDCFF;"> interface</span><span style="color:#ADDCFF;"> command</span><span style="color:#ADDCFF;"> view</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F0F3F6;">[FW-zone-trust]add interface </span><span style="color:#FF9492;">?</span></span>
<span class="line"><span style="color:#FFB757;">  GigabitEthernet</span><span style="color:#ADDCFF;">  GigabitEthernet</span><span style="color:#ADDCFF;"> interface</span></span>
<span class="line"><span style="color:#FFB757;">  Virtual-if</span><span style="color:#ADDCFF;">       Virtual</span><span style="color:#ADDCFF;"> interface</span></span>
<span class="line"><span style="color:#BDC4CC;"># 向安全区域添加接口</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-zone-trust]add interface GigabitEthernet 1/0/1</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-zone-trust]firewall zone untrust</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-zone-untrust]add interface GigabitEthernet 1/0/3</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-zone-untrust]firewall zone dmz</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-zone-dmz]add interface GigabitEthernet 1/0/2</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-zone-dmz]quit</span></span></code></pre></div><ol start="2"><li>完成防火墙的安全策略配置，使 PC1 能访问 PC2，但 PC2 无法访问 PC1。</li></ol><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">[FW]security-policy</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security]rule name r1</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-r1]source-zone trust</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-r1]destination-zone untrust </span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-r1]source-address 192.168.1.0 24</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-r1]destination-address 10.1.1.0 </span><span style="color:#FF9492;">?</span></span>
<span class="line"><span style="color:#FFB757;">  INTEGER</span><span style="color:#F0F3F6;">&lt;1-32&gt;  </span><span style="color:#ADDCFF;">Specify</span><span style="color:#ADDCFF;"> netmask</span><span style="color:#ADDCFF;"> length</span><span style="color:#ADDCFF;"> of</span><span style="color:#ADDCFF;"> IPv4</span><span style="color:#ADDCFF;"> address</span></span>
<span class="line"><span style="color:#FFB757;">  X.X.X.X</span><span style="color:#ADDCFF;">        Specify</span><span style="color:#ADDCFF;"> the</span><span style="color:#ADDCFF;"> wildcard</span><span style="color:#ADDCFF;"> of</span><span style="color:#ADDCFF;"> IP</span><span style="color:#ADDCFF;"> address</span><span style="color:#F0F3F6;">(</span><span style="color:#FFB757;">example:</span><span style="color:#91CBFF;"> 0.0.0.255</span></span>
<span class="line"><span style="color:#FFB757;">                 represents</span><span style="color:#ADDCFF;"> 24-bit</span><span style="color:#ADDCFF;"> mask</span><span style="color:#F0F3F6;">)</span></span>
<span class="line"><span style="color:#FFB757;">  mask</span><span style="color:#ADDCFF;">           Specify</span><span style="color:#ADDCFF;">  the</span><span style="color:#ADDCFF;"> mask</span><span style="color:#ADDCFF;"> of</span><span style="color:#ADDCFF;"> IP</span><span style="color:#ADDCFF;"> address</span><span style="color:#F0F3F6;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-r1]destination-address 10.1.1.0 24</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-r1]action </span><span style="color:#FF9492;">?</span></span>
<span class="line"><span style="color:#FFB757;">  deny</span><span style="color:#ADDCFF;">    Indicate</span><span style="color:#ADDCFF;"> the</span><span style="color:#ADDCFF;"> rule</span><span style="color:#ADDCFF;"> action</span><span style="color:#ADDCFF;"> deny</span></span>
<span class="line"><span style="color:#FFB757;">  permit</span><span style="color:#ADDCFF;">  Indicate</span><span style="color:#ADDCFF;"> the</span><span style="color:#ADDCFF;"> rule</span><span style="color:#ADDCFF;"> action</span><span style="color:#ADDCFF;"> permit</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-r1]action permit</span></span></code></pre></div><ol start="3"><li>完成防火墙的安全策略配置，使 PC2 能<code>ping</code>通 Web Server。</li></ol><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-r1]rule name r2</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-r2]source-zone untrust </span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-r2]destination-zone dmz </span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-r2]source-address 10.1.1.0 24</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-r2]destination-address 172.16.1.1 32</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-r2]service icmp</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-r2]action permit</span></span></code></pre></div><p>完成上述配置后，PC1 能<code>ping</code>通 PC2，但 PC2 无法<code>ping</code>通 PC1，同时 PC2 能<code>ping</code>通 Web Server。</p><h3 id="防火墙nat配置" tabindex="-1"><a class="header-anchor" href="#防火墙nat配置"><span>防火墙NAT配置</span></a></h3><h4 id="基于地址池的源地址napt" tabindex="-1"><a class="header-anchor" href="#基于地址池的源地址napt"><span>基于地址池的源地址NAPT</span></a></h4><p><img src="/wsq-blog/assets/firewall-nat-1-svjsXDUf.png" alt="" loading="lazy"><br><code>Server</code>通过交换机连接到防火墙，<code>Server</code>的缺省网关设置为 FW 的<code>GE1/0/1</code>接口。出于安全的考虑，要求<code>Server</code>访问外部网络时，源 IP 地址需被转换，转换成<code>10.1.1.5</code>至<code>10.1.1.10</code>这个范围内的 IP 地址。</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#BDC4CC;"># 此处省略防火墙接口IP地址、接口加入安全区域等基础配置。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BDC4CC;"># 创建名称为Pool1的源地址池，源NAT模式为PAT（PAT也即NAPT，表示地址转换的同时进行端口的转换，允许端口转换才</span></span>
<span class="line"><span style="color:#BDC4CC;"># 可以使多个内网主机同时使用同一个公网IP地址访问外部网络）</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW] nat address-group Pool1</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-nat-address-group-Pool1] section 10.1.1.5 10.1.1.10 </span><span style="color:#BDC4CC;">#地址池内的地址范围</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-nat-address-group-Pool1] nat-mode pat</span></span>
<span class="line"><span style="color:#BDC4CC;"># 创建源NAT策略（使得Server访问外部网络时，进行源地址转换）：</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW] nat-policy</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-nat] rule name nat1</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-nat-rule-nat1] source-zone trust </span><span style="color:#BDC4CC;">#此处假设Server处于Trust安全区域</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-nat-rule-nat1] destination-zone untrust </span><span style="color:#BDC4CC;">#此处假设External Network处于Untrust安全区域</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-nat-rule-nat1] source-address 192.168.10.0 24 </span><span style="color:#BDC4CC;">#指定允许执行NAT的报文的源IP地址段</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-nat-rule-nat1] action nat address-group Pool1 </span><span style="color:#BDC4CC;">#指定执行的动作为nat，且引用地址池Pool1</span></span>
<span class="line"><span style="color:#BDC4CC;"># 配置安全策略，创建安全规则test1，允许Trust区域的192.168.10.0/24网段访问Untrust区域：</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW] security-policy</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security] rule name test1</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-test1] source-zone trust</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-test1] destination-zone untrust</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-test1] source-address 192.168.10.0 24</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-test1] action permit</span></span></code></pre></div><p>完成上述配置后，当<code>Server</code>（例如<code>192.168.10.5</code>）访问外部网络（例如<code>ping 10.1.1.2</code>）时，可以看到类似如下会话表项：</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#FF9492;">&lt;</span><span style="color:#F0F3F6;">FW</span><span style="color:#FF9492;">&gt;</span><span style="color:#F0F3F6;"> display firewall session table</span></span>
<span class="line"><span style="color:#FFB757;">Current</span><span style="color:#ADDCFF;"> Total</span><span style="color:#ADDCFF;"> Sessions</span><span style="color:#ADDCFF;"> :</span><span style="color:#91CBFF;"> 5</span></span>
<span class="line"><span style="color:#FFB757;">icmp</span><span style="color:#ADDCFF;"> VPN:</span><span style="color:#ADDCFF;"> public</span><span style="color:#91CBFF;"> --</span><span style="color:#FF9492;">&gt;</span><span style="color:#ADDCFF;"> public</span><span style="color:#ADDCFF;"> 192.168.10.5:22360[10.1.1.9:2050]</span><span style="color:#91CBFF;"> --</span><span style="color:#FF9492;">&gt;</span><span style="color:#ADDCFF;"> 10.1.1.2:2048</span></span>
<span class="line"><span style="color:#FFB757;">……</span></span></code></pre></div><p>中括号内的 IP 地址，就是将源 IP 地址<code>192.168.10.5</code>被转换后所使用的 IP 地址。</p><h4 id="nat-server" tabindex="-1"><a class="header-anchor" href="#nat-server"><span>NAT Server</span></a></h4><figure><img src="/wsq-blog/assets/firewall-nat-1-svjsXDUf.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><code>Server</code>通过交换机连接到防火墙，<code>Server</code>的缺省网关设置为 FW 的<code>GE1/0/1</code>接口。出于安全的考 虑，我们并不希望服务器单板的真实 IP 地址暴露在外部网络，但是又希望某些服务器能够被外部网络访问。</p><p>可在 FW 上部署 NAT Server，以<code>192.168.10.5</code>这台内部服务器为例，将其映射到外部网络 IP 地址<code>10.1.1.11</code>，使得外部网络用户能够通过访问该 IP 地址，从而访问<code>192.168.10.5</code>。</p><p>此处假设<code>Server</code>处于<code>Trust</code>安全区域，<code>External Network</code>处于<code>Untrust</code>区域。</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#BDC4CC;"># 此处省略防火墙接口IP地址、接口加入安全区域等基础配置。</span></span>
<span class="line"><span style="color:#BDC4CC;"># 配置NAT Server：</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW] nat server s1 zone untrust global 10.1.1.11 inside 192.168.10.5</span></span>
<span class="line"><span style="color:#BDC4CC;"># 配置安全策略，并创建安全规则，使得Untrust区域的用户能够访问Trust区域的192.168.10.5：</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW] security-policy</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security] rule name External_to_Server</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-External_to_Server] source-zone untrust</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-External_to_Server] destination-zone trust</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-External_to_Server] destination-address 192.168.10.5 32</span></span>
<span class="line"><span style="color:#F0F3F6;">[FW-policy-security-rule-External_to_Server] action permit</span></span></code></pre></div><p>完成上述配置后，当外部网络用户（例如<code>10.1.1.2</code>）访问<code>10.1.1.11</code>（例如<code>ping 10.1.1.11</code>）时，可以在 FW 上看到如下会话表项：</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" data-title="shell" style="background-color:#0a0c10;color:#f0f3f6;"><pre class="shiki github-dark-high-contrast vp-code"><code><span class="line"><span style="color:#FF9492;">&lt;</span><span style="color:#F0F3F6;">FW</span><span style="color:#FF9492;">&gt;</span><span style="color:#F0F3F6;"> display firewall session table</span></span>
<span class="line"><span style="color:#FFB757;">Current</span><span style="color:#ADDCFF;"> Total</span><span style="color:#ADDCFF;"> Sessions</span><span style="color:#ADDCFF;"> :</span><span style="color:#91CBFF;"> 1</span></span>
<span class="line"><span style="color:#FFB757;">icmp</span><span style="color:#ADDCFF;"> VPN:</span><span style="color:#ADDCFF;"> public</span><span style="color:#91CBFF;"> --</span><span style="color:#FF9492;">&gt;</span><span style="color:#ADDCFF;"> public</span><span style="color:#ADDCFF;"> 10.1.1.2:52651</span><span style="color:#91CBFF;"> --</span><span style="color:#FF9492;">&gt;</span><span style="color:#ADDCFF;"> 10.1.1.11:2048[192.168.10.5:2048]</span></span></code></pre></div><p>中括号中的地址，就是被 NAT 转换后的目的 IP 地址。</p></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><span class="vp-meta-info" data-allow-mismatch="text">2025/5/14 10:35:45</span></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 592786982@qq.com">WSQ</span>,<!--]--><!--[--><span class="vp-meta-info" title="email: 592786982@qq.com">WSQ-LK</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/wsq-blog/network/%E8%B7%AF%E7%94%B1%E5%99%A8.html" aria-label="路由器"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->路由器</div></a><a class="route-link auto-link next" href="/wsq-blog/network/ACL%E8%AF%A6%E8%A7%A3.html" aria-label="ACL详解"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">ACL详解<!----></div></a></nav><div id="comment" class="giscus-wrapper input-top vp-comment" vp-comment style="display:none;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><!----></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/wsq-blog/assets/app-BAoNGAQX.js" defer></script>
  </body>
</html>
